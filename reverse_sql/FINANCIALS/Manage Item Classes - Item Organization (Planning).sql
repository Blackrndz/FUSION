/* ****************************************************************************
 * $Revision: 60928 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2017-02-06 17:14:01 +0700 (Mon, 06 Feb 2017) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/reverse_sql/FINANCIALS/Complete%20Primary%20to%20Secondary%20Ledger%20Mapping%20-%20Journal%20Conversion%20Rules.sql $:
 * $Id: Complete Primary to Secondary Ledger Mapping - Journal Conversion Rules.sql 60928 2017-02-06 10:14:01Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
--RSC_PREREQUISITE_OBJECTS=EGP_SYSTEM_ITEMS_B
 
SELECT 
(SELECT ITEM_CLASS_NAME
	FROM EGP_ITEM_CLASSES_VL
	WHERE ITEM_CLASS_ID = ItemClassPEO.PARENT_ITEM_CLASS_ID
	) RES_PARENT_ITEM_CLASS 
,ItemClassPEO.ITEM_CLASS_NAME RES_ITEM_CLASS
,ItemVersionEO.TEMPLATE_NAME RES_NAME
,(SELECT ORGANIZATION_CODE
	FROM INV_ORG_PARAMETERS
	WHERE ORGANIZATION_ID = ItemVersionEO.ORGANIZATION_ID
	) RES_ORGANIZATION
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'INV_MATERIAL_PLANNING'
	AND LOOKUP_CODE = ItemVersionEO.INVENTORY_PLANNING_CODE
	) RES_INVENTORY_PLANNING_METHOD
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_PLANNING_MAKE_BUY'
	AND LOOKUP_CODE = ItemVersionEO.PLANNING_MAKE_BUY_CODE
	) RES_MAKE_OR_BUY
,ItemVersionEO.PLANNER_CODE RES_PLANNER
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_SUBCONT_COMPONENT'
	AND LOOKUP_CODE = ItemVersionEO.SUBCONTRACTING_COMPONENT
	) RES_SUBCONTRACTING_COMPONENT
,ItemVersionEO.MIN_MINMAX_QUANTITY RES_MIN_MAX_QUANTITY_MINIMUM
,ItemVersionEO.MAX_MINMAX_QUANTITY RES_MIN_MAX_QUANTITY_MAXIMUM
,ItemVersionEO.MINIMUM_ORDER_QUANTITY RES_ORDER_QUANTITY_MINIMUM
,ItemVersionEO.MAXIMUM_ORDER_QUANTITY RES_ORDER_QUANTITY_MAXIMUM
,ItemVersionEO.ORDER_COST RES_COST_ORDER
,ItemVersionEO.CARRYING_COST RES_COST_CARRYING_PERCENTAGE
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'INV_SOURCE_TYPES'
	AND LOOKUP_CODE = ItemVersionEO.SOURCE_TYPE
	) RES_SOURCE_REPLENISHMENT_TYPE
,(SELECT NAME
	FROM HR_ALL_ORGANIZATION_UNITS_F_VL
	WHERE ORGANIZATION_ID = ItemVersionEO.SOURCE_ORGANIZATION_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
	) RES_SOURCE_ORGANIZATION
,ItemVersionEO.SOURCE_SUBINVENTORY RES_SOURCE_SUBINVENTORY
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_EGP_SAFETY_STK_PLN_METHOD'
	AND LOOKUP_CODE = ItemVersionEO.SAFETY_STOCK_PLANNING_METHOD
	) RES_SAFETY_STOCK_PLANNING_METH
,ItemVersionEO.DEMAND_PERIOD RES_DEMAND_PERIOD
,ItemVersionEO.DAYS_OF_COVER RES_DAYS_OF_COVER
,ItemVersionEO.FIXED_ORDER_QUANTITY RES_FIXED_ORDER_QUANTITY
,ItemVersionEO.FIXED_DAYS_SUPPLY RES_FIXED_DAYS_SUPPLY
,ItemVersionEO.FIXED_LOT_MULTIPLIER RES_FIXED_LOT_SIZE_MULTIPLIER
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_MSI_GP_RELEASE_AUTH'
	AND LOOKUP_CODE = ItemVersionEO.SO_AUTHORIZATION_FLAG
	) RES_RELEASE_AUTHORIZATION_REQU
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_COMMON_YES_NO_NUM'
	AND LOOKUP_CODE = ItemVersionEO.ASN_AUTOEXPIRE_FLAG
	) RES_AUTOMATICALLY_EXPIRE_ASN
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_COMMON_YES_NO_NUM'
	AND LOOKUP_CODE = ItemVersionEO.CONSIGNED_FLAG
	) RES_CONSIGNED
,ItemVersionEO.VMI_MINIMUM_UNITS RES_MINIMUM_ORDER
,ItemVersionEO.VMI_MINIMUM_DAYS RES_MINIMUM_DAYS_OF_SUPPLY
,ItemVersionEO.VMI_MAXIMUM_UNITS RES_MAXIMUM_ORDER
,ItemVersionEO.VMI_MAXIMUM_DAYS RES_MAXIMUM_DAYS_OF_SUPPLY
,ItemVersionEO.VMI_FIXED_ORDER_QUANTITY RES_FIXED_QUANTITY
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_MSI_GP_FORECAST_TYPE'
	AND LOOKUP_CODE = ItemVersionEO.VMI_FORECAST_TYPE
	) RES_FORECAST_TYPE
,ItemVersionEO.FORECAST_HORIZON RES_WINDOW_DAYS
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_PLANNING_CODE'
	AND LOOKUP_CODE = ItemVersionEO.MRP_PLANNING_CODE
	) RES_PLANNING_METHOD
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_COMMON_YES_NO_NUM'
	AND LOOKUP_CODE = ItemVersionEO.ROUNDING_CONTROL_TYPE
	) RES_ROUND_ORDER_QUANTITIES
,DECODE(ItemVersionEO.CREATE_SUPPLY_FLAG,'Y','Yes','N','No') RES_CREATE_SUPPLY
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_TIME_FENCE'
	AND LOOKUP_CODE = ItemVersionEO.PLANNING_TIME_FENCE_CODE
	) RES_PLANNING_TIME_FENCE
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_TIME_FENCE'
	AND LOOKUP_CODE = ItemVersionEO.DEMAND_TIME_FENCE_CODE
	) RES_DEMAND_TIME_FENCE
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_RELEASE_TIME_FENCE'
	AND LOOKUP_CODE = ItemVersionEO.RELEASE_TIME_FENCE_CODE
	) RES_RELEASE_TIME_FENCE
,ItemVersionEO.SHRINKAGE_RATE RES_SHRINKAGE_RATE
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EGP_ATO_FORECAST_CONTROL'
	AND LOOKUP_CODE = ItemVersionEO.ATO_FORECAST_CONTROL
	) RES_FORECAST_CONTROL
,ItemVersionEO.ACCEPTABLE_EARLY_DAYS RES_ACCEPTABLE_EARLY_DAYS
,ItemVersionEO.PLANNING_TIME_FENCE_DAYS RES_PLANNING_TIME_DAYS
,ItemVersionEO.DEMAND_TIME_FENCE_DAYS RES_DEMAND_TIME_DAYS
,ItemVersionEO.RELEASE_TIME_FENCE_DAYS RES_RELEASE_TIME_DAYS
,DECODE(ItemVersionEO.MRP_CALCULATE_ATP_FLAG,'Y','Yes','N','No') RES_CALCULATE_ATP
,ItemVersionEO.REPAIR_LEADTIME RES_REPAIR_LEAD_TIME
,ItemVersionEO.REPAIR_YIELD RES_REPAIR_YIELD
,ItemVersionEO.PREPROCESSING_LEAD_TIME RES_PREPROCESSING_DAYS
,ItemVersionEO.POSTPROCESSING_LEAD_TIME RES_POSTPROCESSING_DAYS
,ItemVersionEO.FULL_LEAD_TIME RES_PROCESSING_DAYS
,ItemVersionEO.VARIABLE_LEAD_TIME RES_VARIABLE
,DECODE(ItemVersionEO.FORCE_PURCHASE_LEAD_TIME_FLAG,'Y','Yes','No')  RES_ENFORCE_PURCHASING_LEAD_TI
,ItemVersionEO.CUMULATIVE_TOTAL_LEAD_TIME RES_CUMULATIVE_TOTAL
,ItemVersionEO.FIXED_LEAD_TIME RES_FIXED
,ItemVersionEO.CUM_MANUFACTURING_LEAD_TIME RES_CUMULATIVE_MANUFACTURING
,ItemVersionEO.LEAD_TIME_LOT_SIZE RES_LEAD_TIME_LOT_SIZE
,ItemVersionEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,ItemVersionEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,ItemVersionEO.CREATED_BY RSC_CREATED_BY
,ItemVersionEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,(SELECT BUSINESS_UNIT_ID
	FROM INV_ORG_PARAMETERS
	WHERE ORGANIZATION_ID = ItemVersionEO.ORGANIZATION_ID
	) RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,(CASE
	WHEN EXISTS
		(SELECT DISTINCT MASTER_ORGANIZATION_ID
			FROM INV_ORG_PARAMETERS
			WHERE MASTER_ORGANIZATION_ID = ItemVersionEO.ORGANIZATION_ID)
	THEN NULL
	ELSE ItemVersionEO.ORGANIZATION_ID
	END) RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM EGP_ITEM_CLASSES_VL ItemClassPEO
,(SELECT TL.TEMPLATE_NAME 
	,B.* 
	FROM EGP_SYSTEM_ITEMS_TL TL
	,EGP_SYSTEM_ITEMS_B B
	WHERE TL.INVENTORY_ITEM_ID = B.INVENTORY_ITEM_ID
	AND TL.ORGANIZATION_ID = B.ORGANIZATION_ID
	AND LANGUAGE = USERENV('LANG')
	AND TEMPLATE_NAME IS NOT NULL
	) ItemVersionEO
WHERE ItemClassPEO.ITEM_CLASS_ID = ItemVersionEO.ITEM_CATALOG_GROUP_ID
CONNECT BY ItemClassPEO.PARENT_ITEM_CLASS_ID = ItemClassPEO.ITEM_CLASS_ID
ORDER SIBLINGS BY RES_PARENT_ITEM_CLASS,RES_ITEM_CLASS,RES_NAME