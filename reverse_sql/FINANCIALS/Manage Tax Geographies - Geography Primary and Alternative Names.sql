/* $Revision: 59117 $:
* $Author: nasrullah.dusenmahamad $:
* $Date: 2016-10-21 11:10:58 +0700 (Fri, 21 Oct 2016) $:
* $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/reverse_sql/FINANCIALS/Manage%20Key%20Flexfields%20-%20Segment%20Labels.sql $:
* $Id: Manage Key Flexfields - Segment Labels.sql 59117 2016-10-21 04:10:58Z nasrullah.dusenmahamad $:
* ****************************************************************************
* Description:
* ************************************************************************** */


SELECT geographiesE0.GEOGRAPHY_ELEMENT1 RES_COUNTRY_NAME
,(CASE
	WHEN geographiesE0.GEOGRAPHY_ELEMENT10 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT9
	WHEN geographiesE0.GEOGRAPHY_ELEMENT9 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT8
	WHEN geographiesE0.GEOGRAPHY_ELEMENT8 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT7
	WHEN geographiesE0.GEOGRAPHY_ELEMENT7 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT6
	WHEN geographiesE0.GEOGRAPHY_ELEMENT6 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT5
	WHEN geographiesE0.GEOGRAPHY_ELEMENT5 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT4
	WHEN geographiesE0.GEOGRAPHY_ELEMENT4 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT3
	WHEN geographiesE0.GEOGRAPHY_ELEMENT3 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT2
	WHEN geographiesE0.GEOGRAPHY_ELEMENT2 IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT1
	END) RES_PARENT_GEOGRAPHY_NAME
,(CASE
	WHEN geographiesE0.GEOGRAPHY_ELEMENT5_CODE IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT4_CODE
	WHEN geographiesE0.GEOGRAPHY_ELEMENT4_CODE IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT3_CODE
	WHEN geographiesE0.GEOGRAPHY_ELEMENT3_CODE IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT2_CODE
	WHEN geographiesE0.GEOGRAPHY_ELEMENT2_CODE IS NOT NULL THEN 
		geographiesE0.GEOGRAPHY_ELEMENT1_CODE
	END) RES_PARENT_GEOGRAPHY_CODE
,(CASE
	WHEN geographiesE0.GEOGRAPHY_ELEMENT10_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT9_ID)
	WHEN geographiesE0.GEOGRAPHY_ELEMENT9_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT8_ID)
	WHEN geographiesE0.GEOGRAPHY_ELEMENT8_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT7_ID)
	WHEN geographiesE0.GEOGRAPHY_ELEMENT7_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT6_ID)
	WHEN geographiesE0.GEOGRAPHY_ELEMENT6_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT5_ID)
	WHEN geographiesE0.GEOGRAPHY_ELEMENT5_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT4_ID)
	WHEN geographiesE0.GEOGRAPHY_ELEMENT4_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT3_ID)
	WHEN geographiesE0.GEOGRAPHY_ELEMENT3_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT2_ID)
	WHEN geographiesE0.GEOGRAPHY_ELEMENT2_ID IS NOT NULL THEN 
		(SELECT geoType.GEOGRAPHY_TYPE_NAME
			FROM HZ_GEOGRAPHIES geo
			,HZ_GEOGRAPHY_TYPES_TL geoType
			WHERE geoType.LANGUAGE = USERENV('LANG')
			AND geoType.GEOGRAPHY_TYPE = geo.GEOGRAPHY_TYPE
			AND geo.GEOGRAPHY_ID = geographiesE0.GEOGRAPHY_ELEMENT1_ID)
	END) RES_PARENT_GEOGRAPHY_TYPE
,geographiesE0.GEOGRAPHY_NAME RES_GEOGRAPHY_NAME
,(SELECT GEOGRAPHY_TYPE_NAME
	FROM HZ_GEOGRAPHY_TYPES_TL
	WHERE LANGUAGE = USERENV('LANG')
	AND GEOGRAPHY_TYPE = geographiesE0.GEOGRAPHY_TYPE 
	) RES_GEOGRAPHY_TYPE
,geographiesE0.GEOGRAPHY_CODE RES_GEOGRAPHY_CODE
,DECODE(identifiersE0.PRIMARY_FLAG,'Y','Yes','No') RES_PRIMARY
,identifiersE0.IDENTIFIER_VALUE RES_NAME
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES
	WHERE LANGUAGE = USERENV('LANG')
	AND LOOKUP_TYPE = 'HZ_GEO_DATA_PROVIDER'
	AND LOOKUP_CODE = identifiersE0.GEO_DATA_PROVIDER
	) RES_DATA_PROVIDER
,(SELECT DESCRIPTION
	FROM FND_LANGUAGES_TL
	WHERE LANGUAGE = USERENV('LANG')
	AND LANGUAGE_CODE = identifiersE0.LANGUAGE_CODE
	) RES_LANGUAGE
,identifiersE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,identifiersE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,identifiersE0.CREATED_BY RSC_CREATED_BY
,identifiersE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID
FROM HZ_GEOGRAPHIES geographiesE0
,HZ_GEOGRAPHY_IDENTIFIERS identifiersE0
WHERE geographiesE0.GEOGRAPHY_USE = 'MASTER_REF'
AND geographiesE0.GEOGRAPHY_ID = identifiersE0.GEOGRAPHY_ID
AND identifiersE0.IDENTIFIER_TYPE = 'NAME'
ORDER BY geographiesE0.GEOGRAPHY_ELEMENT1
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT2,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT2)
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT3,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT3)
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT4,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT4)
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT5,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT5)
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT6,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT6)
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT7,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT7)
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT8,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT8)
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT9,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT9)
,DECODE(geographiesE0.GEOGRAPHY_ELEMENT10,NULL,'1',geographiesE0.GEOGRAPHY_ELEMENT10)