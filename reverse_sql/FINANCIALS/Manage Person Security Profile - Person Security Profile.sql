/* ****************************************************************************
* $Revision: 73528 $:
* $Author: tanawat.wongjan $:
* $Date: 2020-02-14 15:51:08 +0700 (Fri, 14 Feb 2020) $:
* $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13.19/trunk/core/reverse_sql/FINANCIALS/Manage%20Person%20Security%20Profile%20-%20Person%20Security%20Profile.sql $:
* $Id: Manage Person Security Profile - Person Security Profile.sql 73528 2020-02-14 08:51:08Z tanawat.wongjan $:
* ****************************************************************************
* Description:
* ************************************************************************** */

-- RSC_PREREQUISITE_OBJECTS=PER_PRSN_SEC_PROF_AOR_SCOPES


SELECT perSecPflsE0.NAME RES_NAME
,perSecPflsE0.DESCRIPTION RES_DESCRIPTION
,DECODE(perSecPflsE0.ENABLED_FLAG,'Y','Yes','No') RES_ENABLED
,DECODE(perSecPflsE0.ACCESS_TO_OWN_RECORD,'Y','Yes','No') RES_ACCESS_TO_OWN_RECORD
,DECODE(perSecPflsE0.INCLUDE_FUTURE_PERSONS,'Y','Yes','No') RES_INCLUDE_FUTURE_PEOPLE
,DECODE(perSecPflsE0.INCLUDE_SHARED_PEOPLE_INFO,'Y','Yes','No') RES_INCLUDE_SHARED_PEOPLE_INFO
,DECODE(perSecPflsE0.ACCESS_TO_CAND_WITH_OFFER,'Y','Yes','No') RES_ACCESS_TO_CANDIDATES_WITH_
,DECODE(perSecPflsE0.VIEW_ALL,'Y','Yes','No') RES_VIEW_ALL


--Area of Responsibility
,DECODE(perSecPflsE0.SECURE_BY_AOR,'Y','Yes','No') RES_SECURE_BY_AREA_OF_RESPONSI
,(CASE
    WHEN perSecPflsE0.SECURE_BY_AOR = 'Y' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'PER_RESPONSIBILITY_TYPES'
             AND LOOKUP_CODE = aorsE0.RESPONSIBILITY_TYPE)
    END) RES_RESPONSIBILITY_TYPE
,(CASE
    WHEN perSecPflsE0.SECURE_BY_AOR = 'Y' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'ORA_PER_PRSN_SEC_AOR_SCOPES'
             AND LOOKUP_CODE = aorsE0.SCOPE_OF_RESPONSIBILITY)
    END) RES_SCOPE_OF_RESPONSIBILITY
,(CASE
    WHEN perSecPflsE0.SECURE_BY_AOR = 'Y' THEN
        DECODE(aorsE0.ALL_EMPLOYEE_ACCESS,'Y','Yes','No')
    END) RES_EMPLOYEE
,(CASE
    WHEN perSecPflsE0.SECURE_BY_AOR = 'Y' THEN
        DECODE(aorsE0.ALL_CONT_WORKER_ACCESS,'Y','Yes','No')
    END) RES_CONTINGENT_WORKER
,(CASE
    WHEN perSecPflsE0.SECURE_BY_AOR = 'Y' THEN
        DECODE(aorsE0.ALL_PENDING_WORKER_ACCESS,'Y','Yes','No')
    END) RES_PENDING_WORKER
,(CASE
    WHEN perSecPflsE0.SECURE_BY_AOR = 'Y' THEN
        DECODE(aorsE0.ALL_NON_WORKER_ACCESS,'Y','Yes','No')
    END) RES_NONWORKER
,(CASE
    WHEN perSecPflsE0.SECURE_BY_AOR = 'Y' THEN
        DECODE(aorsE0.ALL_CAND_WITH_OFFER_ACCESS,'Y','Yes','No')
    END) RES_CANDIDATE_WITH_OFFER


--Manager Hierarchy
,DECODE(perSecPflsE0.SECURE_BY_MGR_HIERARCHY,'Y','Yes','No') RES_SECURE_BY_MANAGER_HIERARCH
,(CASE
    WHEN perSecPflsE0.SECURE_BY_MGR_HIERARCHY = 'Y' THEN
        DECODE(perSecPflsE0.PERSON_OR_ASSIGNMENT_LEVEL,'P','Person','A','Assignment')
    END) RES_PERSON_OR_ASSIGNMENT_LEVEL
,(CASE
    WHEN perSecPflsE0.SECURE_BY_MGR_HIERARCHY = 'Y' THEN
        perSecPflsE0.MAX_LEVELS_IN_HIERARCHY
    END) RES_MAXIMUM_LEVELS_IN_HIERARCH
,(CASE
    WHEN perSecPflsE0.SECURE_BY_MGR_HIERARCHY = 'Y' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'PER_PRSN_SEC_PROF_MGR_TYPES'
             AND LOOKUP_CODE = perSecPflsE0.MANAGER_TYPES)
    END) RES_MANAGER_TYPE
,(CASE
    WHEN perSecPflsE0.SECURE_BY_MGR_HIERARCHY = 'Y' AND perSecPflsE0.MANAGER_TYPES = 'SELECTIVE_MGR' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'PER_SUPERVISOR_TYPE'
             AND LOOKUP_CODE = mgrTypesE0.MANAGER_TYPE_VALUE)
    END) RES_SELECTED_TYPE
,(CASE
    WHEN perSecPflsE0.SECURE_BY_MGR_HIERARCHY = 'Y' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'PER_PRSN_SEC_PROF_MGR_HIER_FOR'
             AND LOOKUP_CODE = perSecPflsE0.EVAL_MGR_HIERARCHY_FOR)
    END) RES_HIERARCHY_CONTENT
	
--Workforce Structures
,DECODE(perSecPflsE0.SECURE_BY_DEPARTMENT,'Y','Yes','No') RES_SECURE_BY_DEPARTMENT
,(CASE
    WHEN perSecPflsE0.SECURE_BY_DEPARTMENT = 'Y' THEN
        (SELECT NAME
            FROM PER_ORG_SECURITY_PROFILES
            WHERE ORG_SECURITY_PROFILE_ID = perSecPflsE0.DEPT_ORG_SECURITY_PROFILE_ID)
    END) RES_SECURE_BY_DEPARTMENT_NAME
,DECODE(perSecPflsE0.SECURE_BY_BUSINESS_UNIT,'Y','Yes','No') RES_SECURE_BY_BUSINESS_UNIT
,(CASE
    WHEN perSecPflsE0.SECURE_BY_BUSINESS_UNIT = 'Y' THEN
        (SELECT NAME
            FROM PER_ORG_SECURITY_PROFILES
            WHERE ORG_SECURITY_PROFILE_ID = perSecPflsE0.BU_ORG_SECURITY_PROFILE_ID)
    END) RES_SECURE_BY_BUSINESS_UNIT_NA
,DECODE(perSecPflsE0.SECURE_BY_LEGAL_EMPLOYER,'Y','Yes','No') RES_SECURE_BY_LEGAL_EMPLOYER
,(CASE
    WHEN perSecPflsE0.SECURE_BY_LEGAL_EMPLOYER = 'Y' THEN
        (SELECT NAME
            FROM PER_ORG_SECURITY_PROFILES
            WHERE ORG_SECURITY_PROFILE_ID = perSecPflsE0.LEG_EMP_ORG_SEC_PROFILE_ID)
    END) RES_SECURE_BY_LEGAL_EMPLOYER_N
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'ORA_PER_PRSN_ASGS_TO_EVALUATE'
    AND LOOKUP_CODE = perSecPflsE0.ASGS_TO_EVALUATE
    ) RES_ASSIGNMENTS_TO_EVALUATE
,DECODE(perSecPflsE0.SECURE_BY_POSITION,'Y','Yes','No') RES_SECURE_BY_POSITION
,(CASE
    WHEN perSecPflsE0.SECURE_BY_POSITION = 'Y' THEN
        (SELECT NAME
            FROM PER_POSITION_SECURITY_PROFILES
            WHERE POSITION_SECURITY_PROFILE_ID = perSecPflsE0.POSITION_SECURITY_PROFILE_ID)
    END) RES_SECURE_BY_POSITION_NAME
,DECODE(perSecPflsE0.SECURE_BY_LDG,'Y','Yes','No') RES_SECURE_BY_LEGISLATIVE_DATA
,(CASE
    WHEN perSecPflsE0.SECURE_BY_LDG = 'Y' THEN
        (SELECT NAME
            FROM PER_LDG_SECURITY_PROFILES
            WHERE LDG_SECURITY_PROFILE_ID = perSecPflsE0.LDG_SECURITY_PROFILE_ID)
    END) RES_SECURE_BY_LEGISLATIVE_DA_0
,DECODE(perSecPflsE0.SECURE_BY_PAYROLL,'Y','Yes','No') RES_SECURE_BY_PAYROLL
,(CASE
    WHEN perSecPflsE0.SECURE_BY_PAYROLL = 'Y' THEN
        (SELECT NAME
            FROM PAY_PAY_SECURITY_PROFILES
            WHERE PAY_SECURITY_PROFILE_ID = perSecPflsE0.PAY_SECURITY_PROFILE_ID)
    END) RES_SECURE_BY_PAYROLL_NAME

--Global Name Range
,DECODE(perSecPflsE0.SECURE_BY_GLOBAL_NAME_RANGE,'Y','Yes','No') RES_SECURE_BY_GLOBAL_NAME_RANG
,(CASE
    WHEN perSecPflsE0.SECURE_BY_GLOBAL_NAME_RANGE = 'Y' THEN
        perSecPflsE0.GLOBAL_NAME_RANGE_START
    END) RES_FROM_PERSON_NAME
,(CASE
    WHEN perSecPflsE0.SECURE_BY_GLOBAL_NAME_RANGE = 'Y' THEN
        perSecPflsE0.GLOBAL_NAME_RANGE_END
    END) RES_TO_PERSON_NAME

 --Exclusion Rules
,DECODE(perSecPflsE0.ENABLE_EXCLUSION,'Y','Yes','No') RES_APPLY_EXCLUSION_RULES

--Custom Criteria
,DECODE(perSecPflsE0.SECURE_BY_CUSTOM_RESTRICTION,'Y','Yes','No') RES_SECURE_BY_CUSTOM_CRITERIA

--Person Types
,DECODE(perSecPflsE0.SECURE_BY_PERSON_TYPE,'Y','Yes','No') RES_SECURE_BY_PERSON_TYPE


,(CASE
    WHEN perSecPflsE0.SECURE_BY_CUSTOM_RESTRICTION = 'Y' THEN
        perSecPflsE0.CUSTOM_RESTRICTION_TEXT
    END) RES_CUSTOM_CRITERIA

,perSecPflsE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,perSecPflsE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,perSecPflsE0.CREATED_BY  RSC_CREATED_BY
,perSecPflsE0.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID



FROM PER_PERSON_SECURITY_PROFILES perSecPflsE0
,PER_PRSN_SEC_PROF_AOR_SCOPES aorsE0
,PER_PERSON_SEC_PROF_MGR_TYPES mgrTypesE0
WHERE perSecPflsE0.PERSON_SECURITY_PROFILE_ID = aorsE0.PERSON_SECURITY_PROFILE_ID(+)
AND perSecPflsE0.PERSON_SECURITY_PROFILE_ID = mgrTypesE0.PERSON_SECURITY_PROFILE_ID(+)

ORDER BY perSecPflsE0.NAME
