/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Approved%20Supplier%20List%20Entries%20-%20Supplier%20List%20Entry%20-%20DFF.sql $:
 * $Id: Manage Approved Supplier List Entries - Supplier List Entry - DFF.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- syntax: APPLICATION_ID##RES##DFF_CODE (Descriptive Flexfield name)
-- DFF_LOGIC_TO_APPLY=201##RES##PO_ASL_ATTRIBUTES
-- DFF_ATTRIBUTES=ATTRIBUTE,ATTRIBUTE_NUMBER,ATTRIBUTE_DATE

-- IMPORTANT:
-- - the alias names for the Foreign keys must be the same as in the inventory.
-- - the alias name for context code must be RES_CONTEXT_CODE
-- - NO ALIASES for atributes fields. 
 
SELECT  BusinessUnitUsagePEO.BU_NAME RES_PROCUREMENT_BU
,(CASE WHEN poAPPROVEDSUPPEO.USING_ORGANIZATION_ID = '-1'
	THEN 'Global'
	ELSE 'Ship-to Organization' END ) RES_SCOPE
,(CASE WHEN poAPPROVEDSUPPEO.USING_ORGANIZATION_ID != '-1'
	THEN (SELECT NAME FROM HR_ORGANIZATION_V WHERE  ORGANIZATION_ID = poAPPROVEDSUPPEO.USING_ORGANIZATION_ID
			AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY'))) END) RES_SHIP_TO_ORGANIZATION
,(CASE WHEN poAPPROVEDSUPPEO.ITEM_ID IS NOT NULL
	THEN (SELECT ITEM_NUMBER FROM EGP_SYSTEM_ITEMS_VL WHERE poAPPROVEDSUPPEO.ITEM_ID = INVENTORY_ITEM_ID
				AND poAPPROVEDSUPPEO.OWNING_ORGANIZATION_ID = ORGANIZATION_ID)
	ELSE (SELECT CATEGORY_NAME FROM EGP_CATEGORIES_VL WHERE poAPPROVEDSUPPEO.CATEGORY_ID = CATEGORY_ID) END) RES_ITEM
,(CASE WHEN poAPPROVEDSUPPEO.CATEGORY_ID IS NOT NULL
	THEN (SELECT CATEGORY_NAME FROM EGP_CATEGORIES_VL WHERE poAPPROVEDSUPPEO.CATEGORY_ID = CATEGORY_ID)
	ELSE NULL END) RES_CATEGORY_NAME
,(SELECT PARTY_NAME FROM HZ_PARTIES WHERE PARTY_ID = pozSUPEO.PARTY_ID) RES_SUPPLIER
,(SELECT VENDOR_SITE_CODE FROM POZ_SUPPLIER_SITES_ALL_M  WHERE VENDOR_SITE_ID = poAPPROVEDSUPPEO.VENDOR_SITE_ID ) RES_SUPPLIER_SITE
,poAPPROVEDSUPPEO.ATTRIBUTE_CATEGORY RES_CONTEXT_CODE
,poAPPROVEDSUPPEO.ATTRIBUTE1
,poAPPROVEDSUPPEO.ATTRIBUTE2
,poAPPROVEDSUPPEO.ATTRIBUTE3
,poAPPROVEDSUPPEO.ATTRIBUTE4
,poAPPROVEDSUPPEO.ATTRIBUTE5
,poAPPROVEDSUPPEO.ATTRIBUTE6
,poAPPROVEDSUPPEO.ATTRIBUTE7
,poAPPROVEDSUPPEO.ATTRIBUTE8
,poAPPROVEDSUPPEO.ATTRIBUTE9
,poAPPROVEDSUPPEO.ATTRIBUTE10
,poAPPROVEDSUPPEO.ATTRIBUTE11
,poAPPROVEDSUPPEO.ATTRIBUTE12
,poAPPROVEDSUPPEO.ATTRIBUTE13
,poAPPROVEDSUPPEO.ATTRIBUTE14
,poAPPROVEDSUPPEO.ATTRIBUTE15
,poAPPROVEDSUPPEO.ATTRIBUTE16
,poAPPROVEDSUPPEO.ATTRIBUTE17
,poAPPROVEDSUPPEO.ATTRIBUTE18
,poAPPROVEDSUPPEO.ATTRIBUTE19
,poAPPROVEDSUPPEO.ATTRIBUTE20
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER1
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER2
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER3
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER4
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER5
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER6
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER7
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER8
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER9
,poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER10
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE1,'DD-Mon-YYYY') ATTRIBUTE_DATE1
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE2,'DD-Mon-YYYY') ATTRIBUTE_DATE2
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE3,'DD-Mon-YYYY') ATTRIBUTE_DATE3
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE4,'DD-Mon-YYYY') ATTRIBUTE_DATE4
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE5,'DD-Mon-YYYY') ATTRIBUTE_DATE5
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE6,'DD-Mon-YYYY') ATTRIBUTE_DATE6
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE7,'DD-Mon-YYYY') ATTRIBUTE_DATE7
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE8,'DD-Mon-YYYY') ATTRIBUTE_DATE8
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE9,'DD-Mon-YYYY') ATTRIBUTE_DATE9
,TO_CHAR(poAPPROVEDSUPPEO.ATTRIBUTE_DATE10,'DD-Mon-YYYY') ATTRIBUTE_DATE10

,poAPPROVEDSUPPEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,poAPPROVEDSUPPEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,poAPPROVEDSUPPEO.CREATED_BY RSC_CREATED_BY
,poAPPROVEDSUPPEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,poAPPROVEDSUPPEO.PRC_BU_ID RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM PO_APPROVED_SUPPLIER_LIST poAPPROVEDSUPPEO
,FUN_BU_USAGES_V BusinessUnitUsagePEO
,POZ_SUPPLIERS pozSUPEO
WHERE poAPPROVEDSUPPEO.PRC_BU_ID               = BusinessUnitUsagePEO.BUSINESS_UNIT_ID
AND BusinessUnitUsagePEO.MODULE_ID             = 110
AND BusinessUnitUsagePEO.MODULE_KEY            = 'PROCUREMENT_BF'
AND poAPPROVEDSUPPEO.VENDOR_ID = pozSUPEO.VENDOR_ID(+)
AND (poAPPROVEDSUPPEO.ATTRIBUTE_CATEGORY IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE1 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE2 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE3 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE4 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE5 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE6 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE7 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE8 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE9 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE10 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE11 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE12 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE13 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE14 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE15 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE16 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE17 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE18 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE19 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE20 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER1 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER2 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER3 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER4 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER5 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER6 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER7 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER8 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER9 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_NUMBER10 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE1 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE2 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE3 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE4 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE5 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE6 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE7 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE8 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE9 IS NOT NULL
	OR poAPPROVEDSUPPEO.ATTRIBUTE_DATE10 IS NOT NULL
)
ORDER BY 1,2,3