/* ****************************************************************************
* $Revision:  $:
* $Author: Nasrullah Dusenmahamad $:
* $Date: 2017-03-17  $:
* $HeadURL: $:
* $Id: Manage Category Descriptive Flexfields - Context Segments $:
* ****************************************************************************
* Description:
* ************************************************************************** */


WITH RULE_LOGIC AS (SELECT 1 SEQ
	,LER1_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 2 SEQ
	,LER2_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 3 SEQ
	,LER3_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 4 SEQ
	,LER4_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 5 SEQ
	,LER5_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 6 SEQ
	,LER6_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 7 SEQ
	,LER7_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 8 SEQ
	,LER8_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 9 SEQ
	,LER9_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	
	UNION
	
	SELECT 10 SEQ
	,LER10_ID LER_ID
	,CLPSE_LF_EVT_ID
	FROM BEN_CLPSE_LF_EVT 
	)

SELECT collapsE0.NAME RES_RULE_NAME
,(SELECT NAME
	FROM BEN_LER_F
	WHERE LER_ID = ruleLogicsE0.LER_ID
	) RES_SELECTED
,collapsE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,collapsE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,collapsE0.CREATED_BY RSC_CREATED_BY
,collapsE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,collapsE0.BUSINESS_GROUP_ID RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM BEN_CLPSE_LF_EVT collapsE0
,RULE_LOGIC ruleLogicsE0
WHERE collapsE0.CLPSE_LF_EVT_ID = ruleLogicsE0.CLPSE_LF_EVT_ID
AND ruleLogicsE0.LER_ID IS NOT NULL
ORDER BY collapsE0.SEQ
,ruleLogicsE0.SEQ