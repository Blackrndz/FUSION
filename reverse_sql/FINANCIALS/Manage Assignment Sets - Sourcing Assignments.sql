/* ****************************************************************************
 * $Revision:  $:
 * $Author: Nasrullah Dusenmahamad $:
 * $Date: 2017-07-20  $:
 * $HeadURL:  $:
 * $Id: Manage Assignment Sets - Sourcing Assignments $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 

SELECT MscAssignmentSets.ASSIGNMENT_SET_NAME RES_NAME
,(SELECT meaning
	FROM FND_LOOKUP_VALUES
	WHERE view_application_id = 0
	AND LANGUAGE = USERENV('LANG')
	AND LOOKUP_TYPE = 'MSC_SR_ASSIGNMENT_TYPE' 
	AND LOOKUP_CODE = MscSrAssignments.ASSIGNMENT_TYPE 
	) RES_ASSIGNMENT_LEVEL
,ParametersEO.ORGANIZATION_CODE RES_ORGANIZATION
,(SELECT distinct PARTY_NAME
	FROM HZ_PARTIES
	where PARTY_ID = MscSrAssignments.PARTNER_ID
	) RES_CUSTOMER
,(SELECT distinct PARTY_SITE_NUMBER 
	FROM HZ_PARTY_SITES
	WHERE PARTY_SITE_ID = MscSrAssignments.SHIP_TO_SITE_ID
	) RES_CUSTOMER_SITE
,(SELECT MEANING
    FROM MSC_SR_LOOKUP_VALUES_VL
    WHERE LOOKUP_TYPE = 'DEMAND_CLASS'
    AND LOOKUP_CODE = MscSrAssignments.DEMAND_CLASS_ID  
	) RES_DEMAND_CLASS
,MscSrAssignments.CATEGORY_NAME RES_CATEGORY 
,ItemE0.ITEM_NAME RES_ITEM
,ItemE0.DESCRIPTION RES_DESCRIPTION
,(SELECT  meaning 
	FROM FND_LOOKUP_VALUES 
	WHERE view_application_id = 0 
	AND LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'MSC_SOURCING_RULE_TYPE'
    AND LOOKUP_CODE = MscSrAssignments.SOURCING_RULE_TYPE
	) RES_SOURCING_TYPE
, (SELECT SOURCING_RULE_NAME
	FROM MSC_SOURCING_RULES
	WHERE SOURCING_RULE_ID = MscSrAssignments.SOURCING_RULE_ID
	) RES_SOURCING_RULE_OR_BILL_OF_D
,NULL RES_ZONE
,(SELECT distinct GEOGRAPHY_NAME  
	FROM HZ_GEOGRAPHIES
	WHERE GEOGRAPHY_ID = MscSrAssignments.REGION_ID
	) RES_REGION
,MscSrAssignments.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,MscSrAssignments.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,MscSrAssignments.CREATED_BY RSC_CREATED_BY
,MscSrAssignments.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,(SELECT INV_ORG.ORGANIZATION_ID 
	FROM INV_ORG_PARAMETERS INV_ORG
	,MSC_PARAMETERS MSC_ORG
	WHERE INV_ORG.ORGANIZATION_CODE = MSC_ORG.ORGANIZATION_CODE
	AND MSC_ORG.ORGANIZATION_ID = ParametersEO.ORGANIZATION_ID
	) RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM MSC_ASSIGNMENT_SETS MscAssignmentSets
,MSC_SR_ASSIGNMENTS MscSrAssignments
,MSC_SOURCING_RULES Rul
,MSC_PARAMETERS ParametersEO
,(SELECT ITEM_NAME
	,DESCRIPTION
	,INVENTORY_ITEM_ID
	,ORGANIZATION_ID
	FROM MSC_SYSTEM_ITEMS_V
	WHERE PLAN_ID = -1) ItemE0
WHERE MscAssignmentSets.ASSIGNMENT_SET_ID = MscSrAssignments.ASSIGNMENT_SET_ID
AND MscSrAssignments.SOURCING_RULE_ID  = rul.SOURCING_RULE_ID(+)
AND MscSrAssignments.ORGANIZATION_ID = ParametersEO.ORGANIZATION_ID(+)
AND MscSrAssignments.INVENTORY_ITEM_ID = ItemE0.INVENTORY_ITEM_ID(+)
AND MscSrAssignments.ORGANIZATION_ID = ItemE0.ORGANIZATION_ID(+)
ORDER BY MscAssignmentSets.ASSIGNMENT_SET_NAME 
,MscSrAssignments.ASSIGNMENT_TYPE
,ParametersEO.ORGANIZATION_CODE