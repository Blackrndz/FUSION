/* ****************************************************************************
 * $Revision: 58428 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2016-09-23 18:27:01 +0700 (Fri, 23 Sep 2016) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/customized/In%20Develop/reverse_sql/Manage%20Units%20of%20Measure%20Profiles%20-%20Profile%20Values.sql $:
 * $Id: Manage Units of Measure Profiles - Profile Values.sql 58428 2016-09-23 11:27:01Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- RSC_PREREQUISITE_OBJECTS=EGP_SYSTEM_ITEMS_B
-- STRICTLY_BATCH_SEQ = RES_ITEM_NUMBER,RES_ORGANIZATION_CODE

SELECT /*+ PARALLEL(8) */ 'CREATE' RES_TRANSACTION_TYPE
,'' RES_BATCH_ID
,'' RES_BATCH_NUMBER
,ItemRelatedE0.ITEM_RELATIONSHIP_TYPE RES_ITEM_RELATIONSHIP_TYPE
,ItemsE0.ITEM_NUMBER RES_ITEM_NUMBER
,(SELECT ORGANIZATION_CODE
	FROM INV_ORG_PARAMETERS
	WHERE ORGANIZATION_ID = ItemsE0.ORGANIZATION_ID
	) RES_ORGANIZATION_CODE
,(SELECT (SELECT ORGANIZATION_CODE
		FROM INV_ORG_PARAMETERS
		WHERE ORGANIZATION_ID = MLT.MASTER_ORGANIZATION_ID)
	FROM INV_ORG_PARAMETERS MLT
	WHERE MLT.ORGANIZATION_ID = ItemsE0.ORGANIZATION_ID 
	) RES_MASTER_ORGANIZATION_CODE
,'' RES_SOURCE_SYSTEM_CODE
,'' RES_SOURCE_SYSTEM_REFERENCE
,'' RES_RELATED_SOURCE_SYSTEM_REFE --> NEW Related Source System Reference
,(SELECT TP_ITEM_NUMBER
	FROM EGP_TRADING_PARTNER_ITEMS
	WHERE TP_ITEM_ID = ItemRelatedE0.TP_ITEM_ID
	) RES_TRADING_PARTNER_ITEM_NUMBE
,(SELECT DESCRIPTION
	FROM EGP_ITEM_RELATIONSHIPS_TL
	WHERE LANGUAGE = USERENV('LANG')
	AND ITEM_RELATIONSHIP_ID = ItemRelatedE0.ITEM_RELATIONSHIP_ID
	) RES_DESCRIPTION
,(SELECT ITEM_NUMBER
	FROM EGP_SYSTEM_ITEMS_B
	WHERE INVENTORY_ITEM_ID = ItemRelatedE0.RELATED_ITEM_ID
	AND ORGANIZATION_ID = ItemRelatedE0.ORGANIZATION_ID
	) RES_RELATED_ITEM_NUMBER
,ItemRelatedE0.RELATEDITEM_RANK RES_RELATED_ITEM_RANK
,(SELECT REVISION
	FROM EGP_ITEM_REVISIONS_B
	WHERE REVISION_ID = ItemRelatedE0.REVISION_ID
	) RES_REVISION_CODE
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'EGP_RELATIONSHIP_TYPES'
    AND LOOKUP_CODE =  ItemRelatedE0.SUB_TYPE 
	) RES_SUB_TYPE
,ItemRelatedE0.CROSS_REFERENCE RES_CROSS_REFERENCE
,ItemRelatedE0.ORG_INDEPENDENT_FLAG RES_ORG_INDEPENDENT_FLAG
,ItemRelatedE0.EPC_GTIN_SERIAL RES_EPC_GTIN_SERIAL
,TO_CHAR(ItemRelatedE0.START_DATE_ACTIVE,'YYYY/MM/DD HH24:MI:SS') RES_START_DATE_ACTIVE
,TO_CHAR(ItemRelatedE0.END_DATE_ACTIVE,'YYYY/MM/DD HH24:MI:SS') RES_END_DATE_ACTIVE
,ItemRelatedE0.PREFERENCE_NUMBER RES_PREFERENCE_NUMBER
,ItemRelatedE0.MRP_PLANNING_CODE RES_MRP_PLANNING_CODE
,ItemRelatedE0.RECIPROCAL_FLAG RES_RECIPROCAL_FLAG
,ItemRelatedE0.PLANNING_ENABLED_FLAG RES_PLANNING_ENABLED_FLAG
,(SELECT PARTY_NUMBER
	FROM HZ_PARTIES
	WHERE PARTY_ID = ItemRelatedE0.TRADING_PARTNER_ID
	) RES_TRADING_PARTNER_NUMBER
,(SELECT UNIT_OF_MEASURE
	FROM INV_UNITS_OF_MEASURE_VL
	WHERE UOM_CODE = ItemRelatedE0.UOM_CODE
	) RES_UNIT_OF_MEASURE
,ItemRelatedE0.ATTRIBUTE_CATEGORY RES_ATTRIBUTE_CATEGORY
,ItemRelatedE0.ATTRIBUTE1 RES_ATTRIBUTE1
,ItemRelatedE0.ATTRIBUTE2 RES_ATTRIBUTE2
,ItemRelatedE0.ATTRIBUTE3 RES_ATTRIBUTE3
,ItemRelatedE0.ATTRIBUTE4 RES_ATTRIBUTE4
,ItemRelatedE0.ATTRIBUTE5 RES_ATTRIBUTE5
,ItemRelatedE0.ATTRIBUTE6 RES_ATTRIBUTE6
,ItemRelatedE0.ATTRIBUTE7 RES_ATTRIBUTE7
,ItemRelatedE0.ATTRIBUTE8 RES_ATTRIBUTE8
,ItemRelatedE0.ATTRIBUTE9 RES_ATTRIBUTE9
,ItemRelatedE0.ATTRIBUTE10 RES_ATTRIBUTE10
,ItemRelatedE0.ATTRIBUTE11 RES_ATTRIBUTE11
,ItemRelatedE0.ATTRIBUTE12 RES_ATTRIBUTE12
,ItemRelatedE0.ATTRIBUTE13 RES_ATTRIBUTE13
,ItemRelatedE0.ATTRIBUTE14 RES_ATTRIBUTE14
,ItemRelatedE0.ATTRIBUTE15 RES_ATTRIBUTE15
,ItemRelatedE0.ATTRIBUTE16 RES_ATTRIBUTE16
,ItemRelatedE0.ATTRIBUTE17 RES_ATTRIBUTE17
,ItemRelatedE0.ATTRIBUTE18 RES_ATTRIBUTE18
,ItemRelatedE0.ATTRIBUTE19 RES_ATTRIBUTE19
,ItemRelatedE0.ATTRIBUTE20 RES_ATTRIBUTE20
,ItemRelatedE0.ATTRIBUTE21 RES_ATTRIBUTE21
,ItemRelatedE0.ATTRIBUTE22 RES_ATTRIBUTE22
,ItemRelatedE0.ATTRIBUTE23 RES_ATTRIBUTE23
,ItemRelatedE0.ATTRIBUTE24 RES_ATTRIBUTE24
,ItemRelatedE0.ATTRIBUTE25 RES_ATTRIBUTE25
,ItemRelatedE0.ATTRIBUTE26 RES_ATTRIBUTE26
,ItemRelatedE0.ATTRIBUTE27 RES_ATTRIBUTE27
,ItemRelatedE0.ATTRIBUTE28 RES_ATTRIBUTE28
,ItemRelatedE0.ATTRIBUTE29 RES_ATTRIBUTE29
,ItemRelatedE0.ATTRIBUTE30 RES_ATTRIBUTE30
,ItemRelatedE0.ATTRIBUTE_NUMBER1 RES_ATTRIBUTE_NUMBER1
,ItemRelatedE0.ATTRIBUTE_NUMBER2 RES_ATTRIBUTE_NUMBER2
,ItemRelatedE0.ATTRIBUTE_NUMBER3 RES_ATTRIBUTE_NUMBER3
,ItemRelatedE0.ATTRIBUTE_NUMBER4 RES_ATTRIBUTE_NUMBER4
,ItemRelatedE0.ATTRIBUTE_NUMBER5 RES_ATTRIBUTE_NUMBER5
,ItemRelatedE0.ATTRIBUTE_NUMBER6 RES_ATTRIBUTE_NUMBER6
,ItemRelatedE0.ATTRIBUTE_NUMBER7 RES_ATTRIBUTE_NUMBER7
,ItemRelatedE0.ATTRIBUTE_NUMBER8 RES_ATTRIBUTE_NUMBER8
,ItemRelatedE0.ATTRIBUTE_NUMBER9 RES_ATTRIBUTE_NUMBER9
,ItemRelatedE0.ATTRIBUTE_NUMBER10 RES_ATTRIBUTE_NUMBER10
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE1,'YYYY/MM/DD') RES_ATTRIBUTE_DATE1
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE2,'YYYY/MM/DD') RES_ATTRIBUTE_DATE2
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE3,'YYYY/MM/DD') RES_ATTRIBUTE_DATE3
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE4,'YYYY/MM/DD') RES_ATTRIBUTE_DATE4
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE5,'YYYY/MM/DD') RES_ATTRIBUTE_DATE5
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP1 RES_ATTRIBUTE_TIMESTAMP1
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP2 RES_ATTRIBUTE_TIMESTAMP2
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP3 RES_ATTRIBUTE_TIMESTAMP3
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP4 RES_ATTRIBUTE_TIMESTAMP4
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP5 RES_ATTRIBUTE_TIMESTAMP5
,(SELECT PART_STATUS_CODE
	FROM EGP_TRADING_PARTNER_ITEMS
	WHERE TP_ITEM_ID = ItemRelatedE0.TP_ITEM_ID
	) RES_TRADING_PARTNER_ITEM_RELAT
,ItemRelatedE0.RELATIONSHIP_RANK RES_RANK
,ItemRelatedE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,ItemRelatedE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,ItemRelatedE0.CREATED_BY  RSC_CREATED_BY
,ItemRelatedE0.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,ItemsE0.ORGANIZATION_ID RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM EGP_SYSTEM_ITEMS_B ItemsE0
,EGP_ITEM_RELATIONSHIPS_B ItemRelatedE0
WHERE ItemsE0.INVENTORY_ITEM_ID = ItemRelatedE0.INVENTORY_ITEM_ID
AND ItemsE0.ORGANIZATION_ID = ItemRelatedE0.ORGANIZATION_ID
AND ItemsE0.TEMPLATE_ITEM_FLAG = 'N'
AND ItemsE0.ACD_TYPE = 'PROD'
UNION

SELECT /*+ PARALLEL(8) */ 'CREATE' RES_TRANSACTION_TYPE
,'' RES_BATCH_ID
,'' RES_BATCH_NUMBER
,ItemRelatedE0.ITEM_RELATIONSHIP_TYPE RES_ITEM_RELATIONSHIP_TYPE
,(SELECT ITEM_NUMBER
	FROM EGP_SYSTEM_ITEMS_B
	WHERE INVENTORY_ITEM_ID = ItemRelatedE0.INVENTORY_ITEM_ID 
	AND ROWNUM = 1
	) RES_ITEM_NUMBER
,(SELECT ORGANIZATION_CODE
	FROM INV_ORG_PARAMETERS
	WHERE ORGANIZATION_ID = ItemRelatedE0.ORGANIZATION_ID
	) RES_ORGANIZATION_CODE
,NULL RES_MASTER_ORGANIZATION_CODE
,'' RES_SOURCE_SYSTEM_CODE
,'' RES_SOURCE_SYSTEM_REFERENCE
,'' RES_RELATED_SOURCE_SYSTEM_REFE --> NEW Related Source System Reference
,(SELECT TP_ITEM_NUMBER
	FROM EGP_TRADING_PARTNER_ITEMS
	WHERE TP_ITEM_ID = ItemRelatedE0.TP_ITEM_ID
	) RES_TRADING_PARTNER_ITEM_NUMBE
,(SELECT DESCRIPTION
	FROM EGP_ITEM_RELATIONSHIPS_TL
	WHERE LANGUAGE = USERENV('LANG')
	AND ITEM_RELATIONSHIP_ID = ItemRelatedE0.ITEM_RELATIONSHIP_ID
	) RES_DESCRIPTION
,(SELECT ITEM_NUMBER
	FROM EGP_SYSTEM_ITEMS_B
	WHERE INVENTORY_ITEM_ID = ItemRelatedE0.RELATED_ITEM_ID
	AND ORGANIZATION_ID = ItemRelatedE0.ORGANIZATION_ID
	) RES_RELATED_ITEM_NUMBER
,ItemRelatedE0.RELATEDITEM_RANK RES_RELATED_ITEM_RANK
,(SELECT REVISION
	FROM EGP_ITEM_REVISIONS_B
	WHERE REVISION_ID = ItemRelatedE0.REVISION_ID
	) RES_REVISION_CODE
,(CASE
	WHEN ItemRelatedE0.ITEM_RELATIONSHIP_TYPE = 'COMPETITOR_ITEM_XREF' THEN 
		(SELECT MEANING
			FROM FND_LOOKUP_VALUES
			WHERE LANGUAGE = USERENV('LANG')
			AND LOOKUP_TYPE = 'EGP_COMPETITOR_ITEM_XREF'
			AND LOOKUP_CODE =  ItemRelatedE0.SUB_TYPE)
	WHEN ItemRelatedE0.ITEM_RELATIONSHIP_TYPE = 'GTIN_XREF' THEN 
		(SELECT MEANING
			FROM FND_LOOKUP_VALUES
			WHERE LANGUAGE = USERENV('LANG')
			AND LOOKUP_TYPE = 'EGP_GTIN_PARTY_TYPES'
			AND LOOKUP_CODE =  ItemRelatedE0.SUB_TYPE)
	WHEN ItemRelatedE0.ITEM_RELATIONSHIP_TYPE = 'ITEM_XREF' THEN 
		(SELECT MEANING
			FROM FND_LOOKUP_VALUES
			WHERE LANGUAGE = USERENV('LANG')
			AND LOOKUP_TYPE = 'EGP_ITEM_XREF_TYPES'
			AND LOOKUP_CODE =  ItemRelatedE0.SUB_TYPE)
	ELSE
		ItemRelatedE0.SUB_TYPE
	END) RES_SUB_TYPE
,ItemRelatedE0.CROSS_REFERENCE RES_CROSS_REFERENCE
,ItemRelatedE0.ORG_INDEPENDENT_FLAG RES_ORG_INDEPENDENT_FLAG
,ItemRelatedE0.EPC_GTIN_SERIAL RES_EPC_GTIN_SERIAL
,TO_CHAR(ItemRelatedE0.START_DATE_ACTIVE,'YYYY/MM/DD HH24:MI:SS') RES_START_DATE_ACTIVE
,TO_CHAR(ItemRelatedE0.END_DATE_ACTIVE,'YYYY/MM/DD HH24:MI:SS') RES_END_DATE_ACTIVE
,ItemRelatedE0.PREFERENCE_NUMBER RES_PREFERENCE_NUMBER
,ItemRelatedE0.MRP_PLANNING_CODE RES_MRP_PLANNING_CODE
,ItemRelatedE0.RECIPROCAL_FLAG RES_RECIPROCAL_FLAG
,ItemRelatedE0.PLANNING_ENABLED_FLAG RES_PLANNING_ENABLED_FLAG
,(SELECT PARTY_NUMBER
	FROM HZ_PARTIES
	WHERE PARTY_ID = ItemRelatedE0.TRADING_PARTNER_ID
	) RES_TRADING_PARTNER_NUMBER
,(SELECT UNIT_OF_MEASURE
	FROM INV_UNITS_OF_MEASURE_VL
	WHERE UOM_CODE = ItemRelatedE0.UOM_CODE
	) RES_UNIT_OF_MEASURE
,ItemRelatedE0.ATTRIBUTE_CATEGORY RES_ATTRIBUTE_CATEGORY
,ItemRelatedE0.ATTRIBUTE1 RES_ATTRIBUTE1
,ItemRelatedE0.ATTRIBUTE2 RES_ATTRIBUTE2
,ItemRelatedE0.ATTRIBUTE3 RES_ATTRIBUTE3
,ItemRelatedE0.ATTRIBUTE4 RES_ATTRIBUTE4
,ItemRelatedE0.ATTRIBUTE5 RES_ATTRIBUTE5
,ItemRelatedE0.ATTRIBUTE6 RES_ATTRIBUTE6
,ItemRelatedE0.ATTRIBUTE7 RES_ATTRIBUTE7
,ItemRelatedE0.ATTRIBUTE8 RES_ATTRIBUTE8
,ItemRelatedE0.ATTRIBUTE9 RES_ATTRIBUTE9
,ItemRelatedE0.ATTRIBUTE10 RES_ATTRIBUTE10
,ItemRelatedE0.ATTRIBUTE11 RES_ATTRIBUTE11
,ItemRelatedE0.ATTRIBUTE12 RES_ATTRIBUTE12
,ItemRelatedE0.ATTRIBUTE13 RES_ATTRIBUTE13
,ItemRelatedE0.ATTRIBUTE14 RES_ATTRIBUTE14
,ItemRelatedE0.ATTRIBUTE15 RES_ATTRIBUTE15
,ItemRelatedE0.ATTRIBUTE16 RES_ATTRIBUTE16
,ItemRelatedE0.ATTRIBUTE17 RES_ATTRIBUTE17
,ItemRelatedE0.ATTRIBUTE18 RES_ATTRIBUTE18
,ItemRelatedE0.ATTRIBUTE19 RES_ATTRIBUTE19
,ItemRelatedE0.ATTRIBUTE20 RES_ATTRIBUTE20
,ItemRelatedE0.ATTRIBUTE21 RES_ATTRIBUTE21
,ItemRelatedE0.ATTRIBUTE22 RES_ATTRIBUTE22
,ItemRelatedE0.ATTRIBUTE23 RES_ATTRIBUTE23
,ItemRelatedE0.ATTRIBUTE24 RES_ATTRIBUTE24
,ItemRelatedE0.ATTRIBUTE25 RES_ATTRIBUTE25
,ItemRelatedE0.ATTRIBUTE26 RES_ATTRIBUTE26
,ItemRelatedE0.ATTRIBUTE27 RES_ATTRIBUTE27
,ItemRelatedE0.ATTRIBUTE28 RES_ATTRIBUTE28
,ItemRelatedE0.ATTRIBUTE29 RES_ATTRIBUTE29
,ItemRelatedE0.ATTRIBUTE30 RES_ATTRIBUTE30
,ItemRelatedE0.ATTRIBUTE_NUMBER1 RES_ATTRIBUTE_NUMBER1
,ItemRelatedE0.ATTRIBUTE_NUMBER2 RES_ATTRIBUTE_NUMBER2
,ItemRelatedE0.ATTRIBUTE_NUMBER3 RES_ATTRIBUTE_NUMBER3
,ItemRelatedE0.ATTRIBUTE_NUMBER4 RES_ATTRIBUTE_NUMBER4
,ItemRelatedE0.ATTRIBUTE_NUMBER5 RES_ATTRIBUTE_NUMBER5
,ItemRelatedE0.ATTRIBUTE_NUMBER6 RES_ATTRIBUTE_NUMBER6
,ItemRelatedE0.ATTRIBUTE_NUMBER7 RES_ATTRIBUTE_NUMBER7
,ItemRelatedE0.ATTRIBUTE_NUMBER8 RES_ATTRIBUTE_NUMBER8
,ItemRelatedE0.ATTRIBUTE_NUMBER9 RES_ATTRIBUTE_NUMBER9
,ItemRelatedE0.ATTRIBUTE_NUMBER10 RES_ATTRIBUTE_NUMBER10
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE1,'YYYY/MM/DD') RES_ATTRIBUTE_DATE1
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE2,'YYYY/MM/DD') RES_ATTRIBUTE_DATE2
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE3,'YYYY/MM/DD') RES_ATTRIBUTE_DATE3
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE4,'YYYY/MM/DD') RES_ATTRIBUTE_DATE4
,TO_CHAR(ItemRelatedE0.ATTRIBUTE_DATE5,'YYYY/MM/DD') RES_ATTRIBUTE_DATE5
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP1 RES_ATTRIBUTE_TIMESTAMP1
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP2 RES_ATTRIBUTE_TIMESTAMP2
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP3 RES_ATTRIBUTE_TIMESTAMP3
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP4 RES_ATTRIBUTE_TIMESTAMP4
,ItemRelatedE0.ATTRIBUTE_TIMESTAMP5 RES_ATTRIBUTE_TIMESTAMP5
,(SELECT PART_STATUS_CODE
	FROM EGP_TRADING_PARTNER_ITEMS
	WHERE TP_ITEM_ID = ItemRelatedE0.TP_ITEM_ID
	) RES_TRADING_PARTNER_ITEM_RELAT
,ItemRelatedE0.RELATIONSHIP_RANK RES_RANK
,ItemRelatedE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,ItemRelatedE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,ItemRelatedE0.CREATED_BY  RSC_CREATED_BY
,ItemRelatedE0.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM EGP_ITEM_RELATIONSHIPS_B ItemRelatedE0
WHERE ItemRelatedE0.ITEM_RELATIONSHIP_TYPE != 'RELATED_ITEM'
