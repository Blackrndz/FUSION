/* ****************************************************************************
 * $Revision: 54470 $:
 * $Author: wuttipong.thongvises $:
 * $Date: 2016-04-19 10:52:05 +0700 (Tue, 19 Apr 2016) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/reverse_sql/FINANCIALS/Manage%20Contact%20Point%20Lookups%20-%20Lookup%20Codes.sql $:
 * $Id: Manage Contact Point Lookups - Lookup Codes.sql 54470 2016-04-19 03:52:05Z wuttipong.thongvises $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- RSC_PREREQUISITE_OBJECTS=CST_SCENARIOS
 
SELECT CostScenariosE0.SCENARIO_NUMBER RES_SCENARIO
,(SELECT COST_ORG_NAME
	FROM CST_COST_ORGS_V
	WHERE COST_ORG_ID = CostScenariosE0.COST_ORG_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
	) RES_COST_ORGANIZATION
,(SELECT COST_BOOK_CODE
	FROM CST_COST_BOOKS_B
	WHERE COST_BOOK_ID = CostScenariosE0.COST_BOOK_ID
	) RES_COST_BOOK
,TO_CHAR(CostScenariosE0.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_AS_OF_DATE
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_CST_SCENARIO_TYPES'
	AND LOOKUP_CODE = CostScenariosE0.SCENARIO_TYPE 
	) RES_SCENARIO_TYPE
,DECODE(CostScenariosE0.PLANNING_MODE,'ADJUSTMENT','Yes','No') RES_RETROACTIVE
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_CST_SCENARIO_STATE'
	AND LOOKUP_CODE = CostScenariosE0.STATE_CODE
	) RES_STATE
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_CST_SCENARIO_STATUS_SMPL'
	AND LOOKUP_CODE = CostScenariosE0.STATUS_CODE
	) RES_STATUS
,CostScenariosE0.COMMENTS RES_COMMENTS
,DECODE(WdCriteriaE0.REFRESH_WD_FLAG,'Y','Yes','No') RES_USE_LATEST_WORK_DEFINITION
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_CST_SELECTION_CRITERIA'
	AND LOOKUP_CODE = SUBSTR(WdCriteriaE0.EXPLOSION_SEQUENCE,1,1)
	) RES_WORK_DEFINITION_PRIORITY_V
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_CST_SELECTION_CRITERIA'
	AND LOOKUP_CODE = SUBSTR(WdCriteriaE0.EXPLOSION_SEQUENCE,2,1)
	) RES_WORK_DEFINITION_PRIORITY_0
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_CST_SELECTION_CRITERIA'
	AND LOOKUP_CODE = SUBSTR(WdCriteriaE0.EXPLOSION_SEQUENCE,3,1)
	) RES_WORK_DEFINITION_PRIORITY_1
,(SELECT WORK_DEF_NAME
	FROM WIS_WORK_DEFINITION_NAMES_TL
	WHERE WORK_DEFINITION_NAME_ID = WdCriteriaE0.WORK_DEFINITION_NAME_ID
	AND LANGUAGE = USERENV('LANG')
	) RES_WORK_DEFINITION
,CostScenariosE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,CostScenariosE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,CostScenariosE0.CREATED_BY RSC_CREATED_BY
,CostScenariosE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,CostScenariosE0.COST_ORG_ID RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM CST_SCENARIOS CostScenariosE0
,CST_WD_CRITERIA WdCriteriaE0
WHERE CostScenariosE0.SCENARIO_ID = WdCriteriaE0.SCENARIO_ID 
ORDER BY 1