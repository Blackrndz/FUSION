/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/CustomerAccountSiteUses.sql $:
 * $Id: CustomerAccountSiteUses.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- STRICTLY_BATCH_SEQ = RES_ACCOUNT_SITE_PURPOSE_SOU_1

SELECT '' RES_BATCH_IDENTIFIER
,HzCustAccountsE0.ACCOUNT_NUMBER RES_ACCOUNT_NUMBER
,HzPartySitesE0.PARTY_SITE_NUMBER RES_PARTY_SITE_NUMBER
,'CUSTOMER' RES_ACCOUNT_SITE_SOURCE_SYSTEM
,HzPartySitesE0.PARTY_SITE_NUMBER RES_ACCOUNT_SITE_SOURCE_SYST_0
,'CUSTOMER' RES_ACCOUNT_SITE_PURPOSE_SOURC
,HzCustSiteUsesAllE0.SITE_USE_ID RES_ACCOUNT_SITE_PURPOSE_SOU_1
,HzCustSiteUsesAllE0.SITE_USE_CODE RES_PURPOSE
,HzCustSiteUsesAllE0.PRIMARY_FLAG RES_PRIMARY_INDICATOR
,'I' RES_INSERT_UPDATE_INDICATOR
,HzCustSiteUsesAllE0.LOCATION RES_SITE
,(SELECT SET_CODE
	FROM FND_SETID_SETS
	WHERE SET_ID = HzCustSiteUsesAllE0.SET_ID
	AND LANGUAGE = USERENV('LANG')
	) RES_ACCOUNT_ADDRESS_PURPOSE_SE
,TO_CHAR(HzCustSiteUsesAllE0.START_DATE,'YYYY/MM/DD') RES_PURPOSE_FROM_DATE
,DECODE(TO_CHAR(HzCustSiteUsesAllE0.END_DATE,'YYYY/MM/DD'),'4712/12/31',NULL,TO_CHAR(HzCustSiteUsesAllE0.END_DATE,'YYYY/MM/DD')) RES_PURPOSE_TO_DATE
,HzCustSiteUsesAllE0.ATTRIBUTE_CATEGORY RES_USER_DEFINED_CONTEXT_PROMP
,HzCustSiteUsesAllE0.ATTRIBUTE1 RES_DESCRIPTIVE_FLEXFIELD_SEGM
,HzCustSiteUsesAllE0.ATTRIBUTE2 RES_DESCRIPTIVE_FLEXFIELD_SE_2
,HzCustSiteUsesAllE0.ATTRIBUTE3 RES_DESCRIPTIVE_FLEXFIELD_SE_3
,HzCustSiteUsesAllE0.ATTRIBUTE4 RES_DESCRIPTIVE_FLEXFIELD_SE_4
,HzCustSiteUsesAllE0.ATTRIBUTE5 RES_DESCRIPTIVE_FLEXFIELD_SE_5
,HzCustSiteUsesAllE0.ATTRIBUTE6 RES_DESCRIPTIVE_FLEXFIELD_SE_6
,HzCustSiteUsesAllE0.ATTRIBUTE7 RES_DESCRIPTIVE_FLEXFIELD_SE_7
,HzCustSiteUsesAllE0.ATTRIBUTE8 RES_DESCRIPTIVE_FLEXFIELD_SE_8
,HzCustSiteUsesAllE0.ATTRIBUTE9 RES_DESCRIPTIVE_FLEXFIELD_SE_9
,HzCustSiteUsesAllE0.ATTRIBUTE10 RES_DESCRIPTIVE_FLEXFIELD_S_10
,HzCustSiteUsesAllE0.ATTRIBUTE11 RES_DESCRIPTIVE_FLEXFIELD_S_11
,HzCustSiteUsesAllE0.ATTRIBUTE12 RES_DESCRIPTIVE_FLEXFIELD_S_12
,HzCustSiteUsesAllE0.ATTRIBUTE13 RES_DESCRIPTIVE_FLEXFIELD_S_13
,HzCustSiteUsesAllE0.ATTRIBUTE14 RES_DESCRIPTIVE_FLEXFIELD_S_14
,HzCustSiteUsesAllE0.ATTRIBUTE15 RES_DESCRIPTIVE_FLEXFIELD_S_15
,HzCustSiteUsesAllE0.ATTRIBUTE16 RES_DESCRIPTIVE_FLEXFIELD_S_16
,HzCustSiteUsesAllE0.ATTRIBUTE17 RES_DESCRIPTIVE_FLEXFIELD_S_17
,HzCustSiteUsesAllE0.ATTRIBUTE18 RES_DESCRIPTIVE_FLEXFIELD_S_18
,HzCustSiteUsesAllE0.ATTRIBUTE19 RES_DESCRIPTIVE_FLEXFIELD_S_19
,HzCustSiteUsesAllE0.ATTRIBUTE20 RES_DESCRIPTIVE_FLEXFIELD_S_20
,HzCustSiteUsesAllE0.ATTRIBUTE21 RES_DESCRIPTIVE_FLEXFIELD_S_21
,HzCustSiteUsesAllE0.ATTRIBUTE22 RES_DESCRIPTIVE_FLEXFIELD_S_22
,HzCustSiteUsesAllE0.ATTRIBUTE23 RES_DESCRIPTIVE_FLEXFIELD_S_23
,HzCustSiteUsesAllE0.ATTRIBUTE24 RES_DESCRIPTIVE_FLEXFIELD_S_24
,HzCustSiteUsesAllE0.ATTRIBUTE25 RES_DESCRIPTIVE_FLEXFIELD_S_25
,HzCustSiteUsesAllE0.ATTRIBUTE26 RES_DESCRIPTIVE_FLEXFIELD_S_26
,HzCustSiteUsesAllE0.ATTRIBUTE27 RES_DESCRIPTIVE_FLEXFIELD_S_27
,HzCustSiteUsesAllE0.ATTRIBUTE28 RES_DESCRIPTIVE_FLEXFIELD_S_28
,HzCustSiteUsesAllE0.ATTRIBUTE29 RES_DESCRIPTIVE_FLEXFIELD_S_29
,HzCustSiteUsesAllE0.ATTRIBUTE30 RES_DESCRIPTIVE_FLEXFIELD_S_30
,HzCustSiteUsesAllE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,HzCustSiteUsesAllE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,HzCustSiteUsesAllE0.CREATED_BY RSC_CREATED_BY
,HzCustSiteUsesAllE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,buE0.BU_ID RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM HZ_PARTIES HzPartiesE0
,HZ_PARTY_USG_ASSIGNMENTS HzPartyUsgAssignmentsE0
,HZ_PARTY_SITES HzPartySitesE0
,HZ_CUST_ACCOUNTS HzCustAccountsE0
,HZ_CUST_ACCT_SITES_ALL HzCustAcctSitesAllE0
,HZ_CUST_SITE_USES_ALL HzCustSiteUsesAllE0
,FUN_ALL_BUSINESS_UNITS_V buE0
WHERE HzPartiesE0.PARTY_ID = HzPartyUsgAssignmentsE0.PARTY_ID
AND HzPartyUsgAssignmentsE0.PARTY_USAGE_CODE = 'CUSTOMER'
AND HzPartiesE0.PARTY_ID = HzCustAccountsE0.PARTY_ID
AND HzPartiesE0.PARTY_ID = HzPartySitesE0.PARTY_ID
AND HzCustAcctSitesAllE0.CUST_ACCT_SITE_ID = HzCustSiteUsesAllE0.CUST_ACCT_SITE_ID
AND HzPartySitesE0.PARTY_SITE_ID = HzCustAcctSitesAllE0.PARTY_SITE_ID
AND HzCustAccountsE0.CUST_ACCOUNT_ID = HzCustAcctSitesAllE0.CUST_ACCOUNT_ID
AND HzCustAcctSitesAllE0.SET_ID = buE0.DEFAULT_SET_ID(+)