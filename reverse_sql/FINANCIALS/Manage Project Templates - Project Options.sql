/* ****************************************************************************
* $Revision: 78693 $:
* $Author: tanawat.wongjan $:
* $Date: 2022-06-07 17:22:14 +0700 (Tue, 07 Jun 2022) $:
* $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Project%20Templates%20-%20Project%20Options.sql $:
* $Id: Manage Project Templates - Project Options.sql 78693 2022-06-07 10:22:14Z tanawat.wongjan $:
* ****************************************************************************
* Description:
* ************************************************************************** */

-- RSC_PREREQUISITE_OBJECTS=PJF_PROJECTS_ALL_VL

SELECT projTemplatesE0.NAME RES_TEMPLATE_NAME
,projTemplatesE0.SEGMENT1 RES_TEMPLATE_NUMBER
,(SELECT MEANING
    FROM FND_LOOKUPS
    WHERE LOOKUP_TYPE = 'PJF_PROJECT_PRIORITY_CODE'
    AND LOOKUP_CODE = projTemplatesE0.PRIORITY_CODE
    ) RES_PRIORITY
,(SELECT STR_DEFAULT_DISPLAY_LVL
    FROM PJF_PROJ_STRUCTURE_ATTR
    WHERE PROJECT_ID = projTemplatesE0.PROJECT_ID
    AND OBJECT_TYPE = 'PJF_STRUCTURES'
    ) RES_OUTLINE_DISPLAY_LEVEL
	
,'' RES_CASCADE_OPTION

,TO_CHAR(projTemplatesE0.START_DATE,'DD-Mon-YYYY') RES_START_DATE
,TO_CHAR(planDateE0.START_DATE,'DD-Mon-YYYY') RES_PLANNED_START_DATE
,DECODE(projTemplatesE0.PLANNING_PROJECT_FLAG,'Y','Yes','No') RES_PLANNING_PROJECT
,(SELECT NAME
    FROM PJF_WORK_TYPES_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND WORK_TYPE_ID = projTemplatesE0.WORK_TYPE_ID
    ) RES_WORK_TYPE
,(SELECT MEANING
    FROM FND_LOOKUPS
    WHERE LOOKUP_TYPE = 'PJF_SERVICE_TYPE'
    AND LOOKUP_CODE = projTemplatesE0.SERVICE_TYPE_CODE
    ) RES_SERVICE_TYPE
,TO_CHAR(projTemplatesE0.COMPLETION_DATE,'DD-Mon-YYYY') RES_FINISH_DATE
,TO_CHAR(planDateE0.END_DATE,'DD-Mon-YYYY') RES_PLANNED_FINISH_DATE
,(CASE
    WHEN projTemplatesE0.GROUP_SPACE_TEMPLATE_NAME IS NOT NULL THEN
        'Yes'
	ELSE 'No'
    END) RES_ENABLE_PROJECT_SPACE_FOR_D
,DECODE(projTemplatesE0.BUDGETARY_CONTROL_FLAG,'Y','Yes','No') RES_ENABLE_BUDGETARY_CONTROL
,(SELECT NAME
	FROM PJO_PLAN_TYPES_TL
	WHERE LANGUAGE = USERENV('LANG')
	AND PLAN_TYPE_ID = planningOptionsE0.PLAN_TYPE_ID
	) RES_PROJECT_PLAN_TYPE_NAME
,'' RES_ORIGINAL_PROJECT_TEMPLATE
,'' RES_SOURCE_APPLICATION
,'' RES_SOURCE_REFERENCE
,NVL(planningOptionsE0.LAST_UPDATED_BY,projTemplatesE0.LAST_UPDATED_BY)  RSC_LAST_UPDATED_BY
,NVL(planningOptionsE0.LAST_UPDATE_DATE,projTemplatesE0.LAST_UPDATE_DATE)  RSC_LAST_UPDATE_DATE
,NVL(planningOptionsE0.CREATED_BY,projTemplatesE0.CREATED_BY)  RSC_CREATED_BY
,NVL(planningOptionsE0.CREATION_DATE,projTemplatesE0.CREATION_DATE)  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,projTemplatesE0.ORG_ID RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM PJF_PROJECTS_ALL_VL projTemplatesE0
,FUN_ALL_BUSINESS_UNITS_V buE0
,(SELECT PROJECT_ID
	,PLAN_TYPE_ID
	,LAST_UPDATED_BY 
	,LAST_UPDATE_DATE 
	,CREATED_BY 
	,CREATION_DATE 
	FROM PJO_PLANNING_OPTIONS
	WHERE PLAN_TYPE_CODE = 'PROJECT_PLAN'
	) planningOptionsE0
,(SELECT MIN(PLANNING_START_DATE) START_DATE
	,MAX(PLANNING_END_DATE) END_DATE
	,PROJECT_ID
	FROM PJF_PROJ_ELEMENTS_VL
	WHERE OBJECT_TYPE = 'PJF_TASKS'
	GROUP BY PROJECT_ID
	) planDateE0
WHERE projTemplatesE0.TEMPLATE_FLAG = 'Y'
AND projTemplatesE0.ORG_ID = buE0.BU_ID
AND projTemplatesE0.PROJECT_ID = planningOptionsE0.PROJECT_ID(+)
AND projTemplatesE0.PROJECT_ID = planDateE0.PROJECT_ID(+)
ORDER BY projTemplatesE0.NAME