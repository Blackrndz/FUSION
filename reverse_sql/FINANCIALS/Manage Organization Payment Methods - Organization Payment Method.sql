/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Organization%20Payment%20Methods%20-%20Organization%20Payment%20Method.sql $:
 * $Id: Manage Organization Payment Methods - Organization Payment Method.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

 -- RSC_PREREQUISITE_OBJECTS=PAY_ORG_PAY_METHODS_VL 
 
SELECT payORGPAYMETEO.ORG_PAYMENT_METHOD_NAME RES_NAME
,(SELECT PAYMENT_TYPE_NAME FROM PAY_PAYMENT_TYPES_VL WHERE BASE_PAYMENT_TYPE_ID = payORGPAYMETEO.PAYMENT_TYPE_ID
	AND LEGISLATION_CODE IN (SELECT LEGISLATION_CODE FROM PER_LEGISLATIVE_DATA_GROUPS_VL 
	WHERE LEGISLATIVE_DATA_GROUP_ID = payORGPAYMETEO.LEGISLATIVE_DATA_GROUP_ID)) RES_PAYMENT_TYPE
,(SELECT NAME FROM FND_CURRENCIES_VL WHERE CURRENCY_CODE = payORGPAYMETEO.CURRENCY_CODE) RES_CURRENCY
,(SELECT NAME FROM PER_LEGISLATIVE_DATA_GROUPS_VL 
	WHERE LEGISLATIVE_DATA_GROUP_ID = payORGPAYMETEO.LEGISLATIVE_DATA_GROUP_ID) RES_LEGISLATIVE_DATA_GROUP
,TO_CHAR(payORGPAYMETEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,TO_CHAR(payORGPAYMETEO.EFFECTIVE_END_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_END_DATE
,payORGPAYMETEO.EFT_BUREAU_NAME RES_BANK_NAME
,payORGPAYMETEO.EFT_BUREAU_REFERENCE_TYPE RES_BANK_REFERENCE_TYPE
,payORGPAYMETEO.EFT_BUREAU_REFERENCE RES_BANK_REFERENCE
,payORGPAYMETEO.EFT_USER_NAME RES_COMPANY_NAME
,(CASE WHEN (SELECT LEGISLATION_CODE FROM PER_LEGISLATIVE_DATA_GROUPS_VL WHERE LEGISLATIVE_DATA_GROUP_ID = 
	payORGPAYMETEO.LEGISLATIVE_DATA_GROUP_ID) IN ('AE','KWD','QAR') THEN 
	payORGPAYMETEO.EFT_USER_REFERENCE_TYPE 
	ELSE 
		NULL END)RES_EMPLOYER_CODE 
,(CASE WHEN (SELECT LEGISLATION_CODE FROM PER_LEGISLATIVE_DATA_GROUPS_VL WHERE LEGISLATIVE_DATA_GROUP_ID = 
	payORGPAYMETEO.LEGISLATIVE_DATA_GROUP_ID) NOT IN ('AE','KWD','QAR') THEN 
		payORGPAYMETEO.EFT_USER_REFERENCE_TYPE 
	ELSE 
		NULL END)RES_COMPANY_REFERENCE_TYPE 
,payORGPAYMETEO.EFT_USER_REFERENCE RES_COMPANY_REFERENCE
,DECODE(payORGPAYMETEO.EFT_BALANCING_FLAG,'Y','Yes','No') RES_INCLUDE_BALANCING_ENTRIES
,payORGPAYMETEO.EFT_TRANSACTION_LIMIT RES_TRANSACTION_LIMIT
,payORGPAYMETEO.EFT_FILE_LIMIT RES_PAYMENT_LIMIT
,payORGPAYMETEO.EFT_REFERENCE RES_PAYMENT_REFERENCE
,payORGPAYMETEO.EFT_TEXT RES_PAYMENT_FREE_TEXT
,payORGPAYMETEO.EFT_TEXT2 RES_ADDITIONAL_PAYMENT_TEXT
,DECODE(payORGPAYMETEO.PRE_VALIDATION_REQUIRED,'Y','Yes','No') RES_PRENOTIFICATION_REQUIRED
,payORGPAYMETEO.VALIDATION_DAYS RES_PRENOTIFICATION_DAYS
,payORGPAYMETEO.VALIDATION_VALUE RES_PRENOTIFICATION_AMOUNT
,(CASE WHEN payORGPAYMETEO.PAYMENT_TYPE_ID IN (SELECT BASE_PAYMENT_TYPE_ID FROM PAY_PAYMENT_TYPES_VL WHERE PAYMENT_TYPE_NAME IN ('BACS','International Transfer')
	AND LEGISLATION_CODE IN (SELECT LEGISLATION_CODE FROM PER_LEGISLATIVE_DATA_GROUPS_VL WHERE LEGISLATIVE_DATA_GROUP_ID = payORGPAYMETEO.LEGISLATIVE_DATA_GROUP_ID))
	THEN payORGPAYMETEO.EFT_BUREAU_NAME 
	ELSE NULL END) RES_BUREAU_NAME
,(CASE WHEN payORGPAYMETEO.PAYMENT_TYPE_ID IN (SELECT BASE_PAYMENT_TYPE_ID FROM PAY_PAYMENT_TYPES_VL WHERE PAYMENT_TYPE_NAME IN ('BACS','International Transfer')
	AND LEGISLATION_CODE IN (SELECT LEGISLATION_CODE FROM PER_LEGISLATIVE_DATA_GROUPS_VL WHERE LEGISLATIVE_DATA_GROUP_ID = payORGPAYMETEO.LEGISLATIVE_DATA_GROUP_ID))
	THEN payORGPAYMETEO.EFT_BUREAU_REFERENCE 
	ELSE NULL END) RES_BUREAU_REFERENCE
,(CASE WHEN payORGPAYMETEO.PAYMENT_TYPE_ID IN (SELECT BASE_PAYMENT_TYPE_ID FROM PAY_PAYMENT_TYPES_VL WHERE PAYMENT_TYPE_NAME IN ('BACS','International Transfer')
	AND LEGISLATION_CODE IN (SELECT LEGISLATION_CODE FROM PER_LEGISLATIVE_DATA_GROUPS_VL WHERE LEGISLATIVE_DATA_GROUP_ID = payORGPAYMETEO.LEGISLATIVE_DATA_GROUP_ID))
	THEN payORGPAYMETEO.EFT_TRANSACTION_LIMIT 
	ELSE NULL END)  RES_BACS_TRANSACTION_LIMIT
,(CASE WHEN payORGPAYMETEO.PAYMENT_TYPE_ID IN (SELECT BASE_PAYMENT_TYPE_ID FROM PAY_PAYMENT_TYPES_VL WHERE PAYMENT_TYPE_NAME IN ('BACS','International Transfer')
	AND LEGISLATION_CODE IN (SELECT LEGISLATION_CODE FROM PER_LEGISLATIVE_DATA_GROUPS_VL WHERE LEGISLATIVE_DATA_GROUP_ID = payORGPAYMETEO.LEGISLATIVE_DATA_GROUP_ID))
	THEN payORGPAYMETEO.EFT_FILE_LIMIT 
	ELSE NULL END)   RES_BACS_FILE_LIMIT
	
  ,payORGPAYMETEO.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
  ,payORGPAYMETEO.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
  ,payORGPAYMETEO.CREATED_BY  RSC_CREATED_BY
  ,payORGPAYMETEO.CREATION_DATE  RSC_CREATION_DATE
  ,null RSC_LEDGER_ID
  ,null RSC_CHART_OF_ACCOUNTS_ID
  ,null RSC_BUSINESS_UNIT_ID
  ,null RSC_LEGAL_ENTITY_ID
  ,null RSC_ORGANIZATION_ID
  ,null RSC_BUSINESS_GROUP_ID
  ,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID


FROM PAY_ORG_PAY_METHODS_VL payORGPAYMETEO
WHERE payORGPAYMETEO.PARENT_ORG_PAY_METHOD_ID IS NULL
--AND SYSDATE BETWEEN payORGPAYMETEO.EFFECTIVE_START_DATE AND NVL(payORGPAYMETEO.EFFECTIVE_END_DATE,TO_DATE('4712-12-31','YYYY-MM-DD'))
ORDER BY 1