/* ****************************************************************************
 * $Revision: 79100 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2022-08-01 16:28:55 +0700 (Mon, 01 Aug 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Benefit%20Programs%20-%20Enrollment%20Life%20Event.sql $:
 * $Id: Manage Benefit Programs - Enrollment Life Event.sql 79100 2022-08-01 09:28:55Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
SELECT RES_PROGRAM_NAME
,RES_EFFECTIVE_START_DATE
,RES_PROGRAM_HIERARCHY
,RES_PROGRAM_HIERARCHY_DESCRIPT
--,RES_EFFECTIVE_END_DATE
,RES_LIFE_EVENT
,RES_LIFE_EVENT_EFFECTIVE_START
,RES_LIFE_EVENT_EFFECTIVE_END_D
,RES_START_DAYS
,RES_END_DAYS
,RES_ENROLLMENT_PERIOD_START_DA
,RES_ENROLLMENT_PERIOD_END_DATE
,RES_ENROLLMENT_PERIOD_START__0
,RES_ENROLLMENT_PERIOD_END_DA_1
,RES_DAYS_AFTER_ENROLLMENT_CLOS
,RES_ADDITIONAL_DAYS_ALLOWED_FO
,RES_DAYS_AFTER_LIFE_EVENT_OCCU
,RES_CLOSE_ENROLLMENT_PERIOD_DA
,RES_COVERAGE_START_DATE
,RES_COVERAGE_START_FORMULA
,RES_PREVIOUS_COVERAGE_END_DATE
,RES_PREVIOUS_COVERAGE_END_FORM
,RES_RATE_START_DATE
,RES_RATE_START_FORMULA
,RES_PREVIOUS_RATE_END_DATE
,RES_PREVIOUS_RATE_END_FORMULA
,RES_REINSTATEMENT_RULE
,RES_REINSTATEMENT_OVERRIDE_RUL
,RES_PERIOD_DETERMINATION_RULE
,RES_RESTRICTIONS_LIFE_EVENT
,RES_ENROLLMENT_METHOD
,RES_ENROLLMENT_RULE
,RES_AUTOMATIC_FORMULA
,RES_ENROLLMENT_FORMULA
,RES_DEFAULT_ENROLLMENT_RULE
,RES_DEFAULT_ENROLLMENT_FORMULA
,RES_CURRENT_ELIGIBILITY_PREVEN
,RES_CURRENT_ENROLLMENT_PREVENT
,RES_RESTRICTIONS_EFFECTIVE_STA
,RES_RESTRICTIONS_EFFECTIVE_END
,RES_ASSIGN_ON_DEFAULT
,RES_INTERIM_FORMULA
,RES_INTERIM_RULE
,RES_UNSUSPEND_ENROLLMENT_RULE
,RES_UNSUSPEND_ENROLLMENT_FORMU
,RES_UNSUSPEND_RATE_RULE
,RES_UNSUSPEND_RATE_FORMULA
,RES_ENROLLMENT_CHANGE
,RSC_LAST_UPDATED_BY
,RSC_LAST_UPDATE_DATE
,RSC_CREATED_BY
,RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,RSC_COUNTRY_ID
	
 
FROM
(SELECT benPGMEO.NAME RES_PROGRAM_NAME
,(SELECT NAME FROM BEN_LER_F_VL WHERE LER_ID = benLEERSNE0.LER_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_LIFE_EVENT
,TO_CHAR(benPGMEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,TO_CHAR(benLEERSNE0.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_LIFE_EVENT_EFFECTIVE_START
,DECODE(TO_CHAR(benLEERSNE0.EFFECTIVE_END_DATE ,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(benLEERSNE0.EFFECTIVE_END_DATE ,'DD-Mon-YYYY')) RES_LIFE_EVENT_EFFECTIVE_END_D
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_PERD_STRT'
    AND LOOKUP_CODE = benLEERSNE0.ENRT_PERD_STRT_DT_CD
    ) RES_ENROLLMENT_PERIOD_START_DA
,benLEERSNE0.ENRT_PERD_END_DAYS RES_START_DAYS
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_PERD_END'
    AND LOOKUP_CODE = benLEERSNE0.ENRT_PERD_END_DT_CD
    ) RES_ENROLLMENT_PERIOD_END_DATE
,benLEERSNE0.ENRT_PERD_STRT_DAYS RES_END_DAYS
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLEERSNE0.ENRT_PERD_STRT_DT_RL
    ) RES_ENROLLMENT_PERIOD_START__0
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLEERSNE0.ENRT_PERD_END_DT_RL
    ) RES_ENROLLMENT_PERIOD_END_DA_1
,DYS_AFTR_END_TO_DFLT_NUM RES_DAYS_AFTER_ENROLLMENT_CLOS
,ADDL_PROCG_DYS_NUM RES_ADDITIONAL_DAYS_ALLOWED_FO
,DYS_NO_ENRL_NOT_ELIG_NUM RES_DAYS_AFTER_LIFE_EVENT_OCCU
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_CLS_ENRT_DT_TO_USE'
    AND LOOKUP_CODE = benLEERSNE0.CLS_ENRT_DT_TO_USE_CD
    ) RES_CLOSE_ENROLLMENT_PERIOD_DA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_CVG_STRT'
    AND LOOKUP_CODE = benLEERSNE0.ENRT_CVG_STRT_DT_CD
    ) RES_COVERAGE_START_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLEERSNE0.ENRT_CVG_STRT_DT_RL
    ) RES_COVERAGE_START_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_CVG_END'
    AND LOOKUP_CODE = benLEERSNE0.ENRT_CVG_END_DT_CD
    ) RES_PREVIOUS_COVERAGE_END_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLEERSNE0.ENRT_CVG_END_DT_RL
    ) RES_PREVIOUS_COVERAGE_END_FORM
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_STRT'
    AND LOOKUP_CODE = benLEERSNE0.RT_STRT_DT_CD
    ) RES_RATE_START_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLEERSNE0.RT_STRT_DT_RL
    ) RES_RATE_START_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_END'
    AND LOOKUP_CODE = benLEERSNE0.RT_END_DT_CD
    ) RES_PREVIOUS_RATE_END_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLEERSNE0.RT_END_DT_RL
    ) RES_PREVIOUS_RATE_END_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_REINSTATE'
    AND LOOKUP_CODE = benLEERSNE0.REINSTATE_CD
    ) RES_REINSTATEMENT_RULE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_REINSTATE_OVRDN'
    AND LOOKUP_CODE = benLEERSNE0.REINSTATE_OVRDN_CD
    ) RES_REINSTATEMENT_OVERRIDE_RUL
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_PERD_DET_CD'
    AND LOOKUP_CODE = benLEERSNE0.ENRT_PERD_DET_OVRLP_BCKDT_CD
    ) RES_PERIOD_DETERMINATION_RULE
,(SELECT NAME FROM BEN_LER_F_VL WHERE LER_ID = benLERCHGPGMEO.LER_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_RESTRICTIONS_LIFE_EVENT
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_MTHD'
    AND LOOKUP_CODE = benLERCHGPGMEO.ENRT_MTHD_CD
    ) RES_ENROLLMENT_METHOD
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT'
    AND LOOKUP_CODE = benLERCHGPGMEO.ENRT_CD
	) RES_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPGMEO.AUTO_ENRT_MTHD_RL
    ) RES_AUTOMATIC_FORMULA
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPGMEO.ENRT_RL
    ) RES_ENROLLMENT_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_DFLT_ENRT'
    AND LOOKUP_CODE = benLERCHGPGMEO.DFLT_ENRT_CD
    ) RES_DEFAULT_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPGMEO.DFLT_ENRT_RL
    ) RES_DEFAULT_ENROLLMENT_FORMULA
,DECODE(benLERCHGPGMEO.STL_ELIG_CANT_CHG_FLAG,'Y','Yes','No') RES_CURRENT_ELIGIBILITY_PREVEN
,DECODE(benLERCHGPGMEO.CRNT_ENRT_PRCLDS_CHG_FLAG,'Y','Yes','No') RES_CURRENT_ENROLLMENT_PREVENT
,TO_CHAR(benLERCHGPGMEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_RESTRICTIONS_EFFECTIVE_STA
,DECODE(TO_CHAR(benLERCHGPGMEO.EFFECTIVE_END_DATE ,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(benLERCHGPGMEO.EFFECTIVE_END_DATE ,'DD-Mon-YYYY')) RES_RESTRICTIONS_EFFECTIVE_END
,NULL RES_ASSIGN_ON_DEFAULT
,benPGMEO.NAME RES_PROGRAM_HIERARCHY
,'Programs' RES_PROGRAM_HIERARCHY_DESCRIPT
,NULL RES_INTERIM_FORMULA
,NULL RES_INTERIM_RULE
,NULL RES_UNSUSPEND_ENROLLMENT_RULE
,NULL RES_UNSUSPEND_ENROLLMENT_FORMU
,NULL RES_UNSUSPEND_RATE_RULE
,NULL RES_UNSUSPEND_RATE_FORMULA
,NULL RES_ENROLLMENT_CHANGE
,'1' RES_SEQUENCE_0

,benLEERSNE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,benLEERSNE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,benLEERSNE0.CREATED_BY RSC_CREATED_BY
,benLEERSNE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,benPGMEO.LEGISLATION_CODE RSC_COUNTRY_ID
	
	
FROM BEN_PGM_F benPGMEO
,BEN_POPL_ENRT_TYP_CYCL benPOPLENRTE0
,BEN_LEE_RSN_F benLEERSNE0
,(SELECT * FROM BEN_LER_CHG_PGM_ENRT_F 
	WHERE LER_ID NOT IN (SELECT LER_ID FROM BEN_LER_F_VL WHERE TYP_CD IN ('SCHEDDA','SCHEDDO')
				AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))) 
				AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))) benLERCHGPGMEO
WHERE benPGMEO.PGM_ID = benPOPLENRTE0.PGM_ID 
AND benPGMEO.PGM_ID = benLERCHGPGMEO.PGM_ID (+)
AND benPOPLENRTE0.POPL_ENRT_TYP_CYCL_ID = benLEERSNE0.POPL_ENRT_TYP_CYCL_ID
AND SYSDATE BETWEEN benPGMEO.EFFECTIVE_START_DATE AND NVL(benPGMEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benLEERSNE0.EFFECTIVE_START_DATE AND NVL(benLEERSNE0.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))

UNION

SELECT benPGMEO.NAME RES_PROGRAM_NAME
,(SELECT NAME FROM BEN_LER_F_VL WHERE LER_ID = benLERCHGPTIPEO.LER_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_LIFE_EVENT
,TO_CHAR(benPGMEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,TO_CHAR(benLERCHGPTIPEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_LIFE_EVENT_EFFECTIVE_START
,DECODE(TO_CHAR(benLERCHGPTIPEO.EFFECTIVE_END_DATE ,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(benLERCHGPTIPEO.EFFECTIVE_END_DATE ,'DD-Mon-YYYY')) RES_LIFE_EVENT_EFFECTIVE_END_D
,NULL RES_ENROLLMENT_PERIOD_START_DA
,NULL RES_START_DAYS
,NULL RES_ENROLLMENT_PERIOD_END_DATE
,NULL RES_END_DAYS
,NULL RES_ENROLLMENT_PERIOD_START__0
,NULL RES_ENROLLMENT_PERIOD_END_DA_1
,NULL RES_DAYS_AFTER_ENROLLMENT_CLOS
,NULL RES_ADDITIONAL_DAYS_ALLOWED_FO
,NULL RES_DAYS_AFTER_LIFE_EVENT_OCCU
,NULL RES_CLOSE_ENROLLMENT_PERIOD_DA
,NULL RES_COVERAGE_START_DATE
,NULL RES_COVERAGE_START_FORMULA
,NULL RES_PREVIOUS_COVERAGE_END_DATE
,NULL RES_PREVIOUS_COVERAGE_END_FORM
,NULL RES_RATE_START_DATE
,NULL RES_RATE_START_FORMULA
,NULL RES_PREVIOUS_RATE_END_DATE
,NULL RES_PREVIOUS_RATE_END_FORMULA
,NULL RES_REINSTATEMENT_RULE
,NULL RES_REINSTATEMENT_OVERRIDE_RUL
,NULL RES_PERIOD_DETERMINATION_RULE
,(SELECT NAME FROM BEN_LER_F_VL WHERE LER_ID = benLERCHGPTIPEO.LER_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_RESTRICTIONS_LIFE_EVENT
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_MTHD'
    AND LOOKUP_CODE = benLERCHGPTIPEO.ENRT_MTHD_CD
    ) RES_ENROLLMENT_METHOD
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT'
    AND LOOKUP_CODE = benLERCHGPTIPEO.ENRT_CD
	) RES_ENROLLMENT_RULE
,NULL RES_AUTOMATIC_FORMULA
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPTIPEO.ENRT_RL
    ) RES_ENROLLMENT_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_DFLT_ENRT'
    AND LOOKUP_CODE = benLERCHGPTIPEO.DFLT_ENRT_CD
    ) RES_DEFAULT_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPTIPEO.DFLT_ENRT_RL
    ) RES_DEFAULT_ENROLLMENT_FORMULA
,DECODE(benLERCHGPTIPEO.STL_ELIG_CANT_CHG_FLAG,'Y','Yes','No') RES_CURRENT_ELIGIBILITY_PREVEN
,DECODE(benLERCHGPTIPEO.CRNT_ENRT_PRCLDS_CHG_FLAG,'Y','Yes','No') RES_CURRENT_ENROLLMENT_PREVENT
,NULL RES_RESTRICTIONS_EFFECTIVE_STA
,NULL RES_RESTRICTIONS_EFFECTIVE_END
,DECODE(benLERCHGPTIPEO.DFLT_FLAG,'Y','Yes','No') RES_ASSIGN_ON_DEFAULT
,benPLT.NAME RES_PROGRAM_HIERARCHY
,'Plan Type' RES_PROGRAM_HIERARCHY_DESCRIPT
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPTIPEO.DFLT_TO_ASN_PNDG_CTFN_RL) RES_INTERIM_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_DFLT_TO_ASN_PNDG_CTFN'
    AND LOOKUP_CODE = benLERCHGPTIPEO.DFLT_TO_ASN_PNDG_CTFN_CD) RES_INTERIM_RULE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_UNSSPND_ENRT'
    AND LOOKUP_CODE = benLERCHGPTIPEO.UNSSPND_ENRT_CD) RES_UNSUSPEND_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPTIPEO.UNSSPND_ENRT_RL) RES_UNSUSPEND_ENROLLMENT_FORMU
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_UNSSPND_ENRT'
    AND LOOKUP_CODE = benLERCHGPTIPEO.UNSSPND_RT_CD) RES_UNSUSPEND_RATE_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPTIPEO.UNSSPND_RT_RL) RES_UNSUSPEND_RATE_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_TCO_CHG_ENRT'
    AND LOOKUP_CODE = benLERCHGPTIPEO.TCO_CHG_ENRT_CD
    ) RES_ENROLLMENT_CHANGE
,'2' RES_SEQUENCE_0

,benLERCHGPTIPEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,benLERCHGPTIPEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,benLERCHGPTIPEO.CREATED_BY RSC_CREATED_BY
,benLERCHGPTIPEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,benPGMEO.LEGISLATION_CODE RSC_COUNTRY_ID
	
	
FROM BEN_PGM_F benPGMEO
,BEN_PTIP_F benPT
,BEN_PL_TYP_F benPLT
,(SELECT * FROM BEN_LER_CHG_PTIP_ENRT_F 
	WHERE LER_ID NOT IN (SELECT LER_ID FROM BEN_LER_F_VL WHERE TYP_CD IN ('SCHEDDA','SCHEDDO')
				AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))) 
				AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))) benLERCHGPTIPEO

WHERE benPGMEO.PGM_ID = benPT.PGM_ID
AND benPT.PL_TYP_ID = benPLT.PL_TYP_ID
AND benPT.PTIP_ID = benLERCHGPTIPEO.PTIP_ID
AND SYSDATE BETWEEN benPGMEO.EFFECTIVE_START_DATE AND NVL(benPGMEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPT.EFFECTIVE_START_DATE AND NVL(benPT.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPLT.EFFECTIVE_START_DATE AND NVL(benPLT.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))

UNION

SELECT benPGMEO.NAME RES_PROGRAM_NAME
,(SELECT NAME FROM BEN_LER_F_VL WHERE LER_ID = benLERCHGPLIPEO.LER_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_LIFE_EVENT
,TO_CHAR(benPGMEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,TO_CHAR(benLERCHGPLIPEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_LIFE_EVENT_EFFECTIVE_START
,DECODE(TO_CHAR(benLERCHGPLIPEO.EFFECTIVE_END_DATE ,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(benLERCHGPLIPEO.EFFECTIVE_END_DATE ,'DD-Mon-YYYY')) RES_LIFE_EVENT_EFFECTIVE_END_D
,NULL RES_ENROLLMENT_PERIOD_START_DA
,NULL RES_START_DAYS
,NULL RES_ENROLLMENT_PERIOD_END_DATE
,NULL RES_END_DAYS
,NULL RES_ENROLLMENT_PERIOD_START__0
,NULL RES_ENROLLMENT_PERIOD_END_DA_1
,NULL RES_DAYS_AFTER_ENROLLMENT_CLOS
,NULL RES_ADDITIONAL_DAYS_ALLOWED_FO
,NULL RES_DAYS_AFTER_LIFE_EVENT_OCCU
,NULL RES_CLOSE_ENROLLMENT_PERIOD_DA
,NULL RES_COVERAGE_START_DATE
,NULL RES_COVERAGE_START_FORMULA
,NULL RES_PREVIOUS_COVERAGE_END_DATE
,NULL RES_PREVIOUS_COVERAGE_END_FORM
,NULL RES_RATE_START_DATE
,NULL RES_RATE_START_FORMULA
,NULL RES_PREVIOUS_RATE_END_DATE
,NULL RES_PREVIOUS_RATE_END_FORMULA
,NULL RES_REINSTATEMENT_RULE
,NULL RES_REINSTATEMENT_OVERRIDE_RUL
,NULL RES_PERIOD_DETERMINATION_RULE
,(SELECT NAME FROM BEN_LER_F_VL WHERE LER_ID = benLERCHGPLIPEO.LER_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_RESTRICTIONS_LIFE_EVENT
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_MTHD'
    AND LOOKUP_CODE = benLERCHGPLIPEO.ENRT_MTHD_CD
    ) RES_ENROLLMENT_METHOD
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT'
    AND LOOKUP_CODE = benLERCHGPLIPEO.ENRT_CD
	) RES_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPLIPEO.AUTO_ENRT_MTHD_RL
    ) RES_AUTOMATIC_FORMULA
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPLIPEO.ENRT_RL
    ) RES_ENROLLMENT_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_DFLT_ENRT'
    AND LOOKUP_CODE = benLERCHGPLIPEO.DFLT_ENRT_CD
    ) RES_DEFAULT_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benLERCHGPLIPEO.DFLT_ENRT_RL
    ) RES_DEFAULT_ENROLLMENT_FORMULA
,DECODE(benLERCHGPLIPEO.STL_ELIG_CANT_CHG_FLAG,'Y','Yes','No') RES_CURRENT_ELIGIBILITY_PREVEN
,DECODE(benLERCHGPLIPEO.CRNT_ENRT_PRCLDS_CHG_FLAG,'Y','Yes','No') RES_CURRENT_ENROLLMENT_PREVENT
,NULL RES_RESTRICTIONS_EFFECTIVE_STA
,NULL RES_RESTRICTIONS_EFFECTIVE_END
,DECODE(benLERCHGPLIPEO.DFLT_FLAG,'Y','Yes','No') RES_ASSIGN_ON_DEFAULT
,benPL.NAME RES_PROGRAM_HIERARCHY
,'Plan' RES_PROGRAM_HIERARCHY_DESCRIPT
,NULL RES_INTERIM_FORMULA
,NULL RES_INTERIM_RULE
,NULL RES_UNSUSPEND_ENROLLMENT_RULE
,NULL RES_UNSUSPEND_ENROLLMENT_FORMU
,NULL RES_UNSUSPEND_RATE_RULE
,NULL RES_UNSUSPEND_RATE_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_TCO_CHG_ENRT'
    AND LOOKUP_CODE = benLERCHGPLIPEO.TCO_CHG_ENRT_CD
    ) RES_ENROLLMENT_CHANGE
,'3' RES_SEQUENCE_0

,benLERCHGPLIPEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,benLERCHGPLIPEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,benLERCHGPLIPEO.CREATED_BY RSC_CREATED_BY
,benLERCHGPLIPEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,benPGMEO.LEGISLATION_CODE RSC_COUNTRY_ID
	
	
FROM BEN_PGM_F benPGMEO
,BEN_PLIP_F benPLIP
,BEN_PL_F benPL
,(SELECT * FROM BEN_LER_CHG_PLIP_ENRT_F 
	WHERE LER_ID NOT IN (SELECT LER_ID FROM BEN_LER_F_VL WHERE TYP_CD IN ('SCHEDDA','SCHEDDO')
				AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))) 
				AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))) benLERCHGPLIPEO

WHERE benPGMEO.PGM_ID = benPLIP.PGM_ID
AND benPLIP.PL_ID = benPL.PL_ID
AND benPLIP.PLIP_ID = benLERCHGPLIPEO.PLIP_ID
AND SYSDATE BETWEEN benPGMEO.EFFECTIVE_START_DATE AND NVL(benPGMEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPLIP.EFFECTIVE_START_DATE AND NVL(benPLIP.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPL.EFFECTIVE_START_DATE AND NVL(benPL.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))

ORDER BY RES_PROGRAM_NAME,RES_SEQUENCE_0,RES_PROGRAM_HIERARCHY)
