/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Job%20-%20Jobs.sql $:
 * $Id: Manage Job - Jobs.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 

SELECT /*TO_CHAR(QRSLT.EFFECTIVE_START_DATE,'DD-Mon-YYYY')  RES_EFFECTIVE_START_DATE
,QRSLT.SET_NAME RES_JOB_SET
,(SELECT ActionsPEO.action_name  
	FROM PER_ACTION_REASON_USAGES ActionReasonUsagesPEO
	,PER_ACTIONS_VL ActionsPEO
	WHERE ACTIONREASONUSAGESPEO.ACTION_ID = ACTIONSPEO.ACTION_ID
	AND ACTIONREASONUSAGESPEO.ACTION_REASON_ID = QRSLT.ACTION_OCCURRENCE_ID
	) RES_ACTION_REASON*/
QRSLT.name RES_NAME
,QRSLT.JOB_CODE RES_CODE
,QRSLT.LAST_UPDATED_BY as RSC_LAST_UPDATED_BY
,QRSLT.LAST_UPDATE_DATE AS RSC_LAST_UPDATE_DATE
,QRSLT.CREATED_BY  RSC_CREATED_BY
,QRSLT.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID
    
FROM (SELECT DISTINCT JobDEO.JOB_ID
	,JobDEO.EFFECTIVE_START_DATE
	,JobTranslationEO.NAME
	,JobDEO.JOB_CODE
	,SetIdSetPEO.SET_NAME
	,JobDEO.BUSINESS_GROUP_ID
	,JobDEO.ACTION_OCCURRENCE_ID
	,JobDEO.CREATED_BY
	,JobDEO.CREATION_DATE
	,JobDEO.LAST_UPDATED_BY
	,JobDEO.LAST_UPDATE_DATE
	FROM PER_JOBS_F JobDEO
	,FND_SETID_SETS_VL SetIdSetPEO
	,PER_JOBS_F_TL JobTranslationEO
	WHERE(JobDEO.SET_ID             = SetIdSetPEO.SET_ID)
	AND JobDEO.JOB_ID               = JobTranslationEO.JOB_ID
	AND JobTranslationEO.Language   = sys_context('USERENV','LANG')
	AND JobDEO.EFFECTIVE_START_DATE = JobTranslationEO.EFFECTIVE_START_DATE
	AND JobDEO.EFFECTIVE_END_DATE   = JobTranslationEO.EFFECTIVE_END_DATE
	AND SYSDATE BETWEEN JobDEO.EFFECTIVE_START_DATE AND NVL(JobDEO.EFFECTIVE_END_DATE ,TO_DATE('4712-12-31','YYYY-MM-DD'))
) QRSLT 
ORDER BY
(CASE
	WHEN EXISTS (SELECT 1 FROM PER_JOBS_F WHERE PROGRESSION_JOB_ID = QRSLT.JOB_ID) THEN	1
	ELSE 2	
	END)
,QRSLT.name
,QRSLT.JOB_CODE
,QRSLT.EFFECTIVE_START_DATE