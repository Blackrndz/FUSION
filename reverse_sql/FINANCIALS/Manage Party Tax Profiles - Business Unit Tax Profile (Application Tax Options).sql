/* ****************************************************************************
 * $Revision: 59683 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2016-11-22 10:55:17 +0700 (Tue, 22 Nov 2016) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/reverse_sql/FINANCIALS/Manage%20Mapping%20Sets%20-%20Cost%20Management%20(Chart%20of%20Accounts%20Mappings).sql $:
 * $Id: Manage Mapping Sets - Cost Management (Chart of Accounts Mappings).sql 59683 2016-11-22 03:55:17Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 

SELECT FinancialsBusinessUnitPEO.BU_NAME RES_BUSINESS_UNIT
,ApplicationE0.APPLICATION_NAME RES_APPLICATION_NAME
,DECODE(ZxProductOptionsAll.APPLICATION_ID,222,(SELECT Meaning
	FROM Fnd_Lookups
	WHERE Lookup_Type                 = 'ZX_TAX_METHOD_OPTIONS'
	AND Lookup_Code                   = ZxProductOptionsAll.TAX_METHOD_CODE
	AND START_DATE_ACTIVE            <= SYSDATE
	AND NVL(END_DATE_ACTIVE,SYSDATE) >= SYSDATE
	AND ENABLED_FLAG                  = 'Y'
	),NULL) RES_TAX_DETERMINATION_METHOD
,DECODE(ZxProductOptionsAll.USE_TAX_CLASSIFICATION_FLAG,'Y','Yes','No') RES_ENABLE_DEFAULTING_ORDER
,(SELECT meaning
	FROM fnd_lookups
	WHERE lookup_type = DECODE(ZxProductOptionsAll.APPLICATION_ID,200,'ZX_AP_DEFAULT_HIERARCHY',222,
		'ZX_AR_DEFAULT_HIERARCHY',201,'ZX_PO_DEFAULT_HIERARCHY',10016,'ZX_AP_DEFAULT_HIERARCHY',10035,
		'ZX_PA_DEFAULT_HIERARCHY')
	AND LOOKUP_CODE = ZxProductOptionsAll.DEF_OPTION_HIER_1_CODE
	) RES_DEFAULTING_ORDER_1
,(SELECT meaning
	FROM fnd_lookups
	WHERE lookup_type = DECODE(ZxProductOptionsAll.APPLICATION_ID,200,'ZX_AP_DEFAULT_HIERARCHY',222,
		'ZX_AR_DEFAULT_HIERARCHY',201,'ZX_PO_DEFAULT_HIERARCHY',10016,'ZX_AP_DEFAULT_HIERARCHY',10035,
		'ZX_PA_DEFAULT_HIERARCHY')
	AND LOOKUP_CODE = ZxProductOptionsAll.DEF_OPTION_HIER_2_CODE
	) RES_DEFAULTING_ORDER_2
,(SELECT meaning
	FROM fnd_lookups
	WHERE lookup_type = DECODE(ZxProductOptionsAll.APPLICATION_ID,200,'ZX_AP_DEFAULT_HIERARCHY',222,
		'ZX_AR_DEFAULT_HIERARCHY',201,'ZX_PO_DEFAULT_HIERARCHY',10016,'ZX_AP_DEFAULT_HIERARCHY',10035,
		'ZX_PA_DEFAULT_HIERARCHY')
	AND LOOKUP_CODE = ZxProductOptionsAll.DEF_OPTION_HIER_3_CODE
	) RES_DEFAULTING_ORDER_3
,(SELECT meaning
	FROM fnd_lookups
	WHERE lookup_type = DECODE(ZxProductOptionsAll.APPLICATION_ID,200,'ZX_AP_DEFAULT_HIERARCHY',222,
		'ZX_AR_DEFAULT_HIERARCHY',201,'ZX_PO_DEFAULT_HIERARCHY',10016,'ZX_AP_DEFAULT_HIERARCHY',10035,
		'ZX_PA_DEFAULT_HIERARCHY')
	AND LOOKUP_CODE = ZxProductOptionsAll.DEF_OPTION_HIER_4_CODE
	) RES_DEFAULTING_ORDER_4
,(SELECT meaning
	FROM fnd_lookups
	WHERE lookup_type = DECODE(ZxProductOptionsAll.APPLICATION_ID,200,'ZX_AP_DEFAULT_HIERARCHY',222,
		'ZX_AR_DEFAULT_HIERARCHY',201,'ZX_PO_DEFAULT_HIERARCHY',10016,'ZX_AP_DEFAULT_HIERARCHY',10035,
		'ZX_PA_DEFAULT_HIERARCHY')
	AND LOOKUP_CODE = ZxProductOptionsAll.DEF_OPTION_HIER_5_CODE
	) RES_DEFAULTING_ORDER_5
,(SELECT meaning
	FROM fnd_lookups
	WHERE lookup_type = DECODE(ZxProductOptionsAll.APPLICATION_ID,200,'ZX_AP_DEFAULT_HIERARCHY',222,
		'ZX_AR_DEFAULT_HIERARCHY',201,'ZX_PO_DEFAULT_HIERARCHY',10016,'ZX_AP_DEFAULT_HIERARCHY',10035,
		'ZX_PA_DEFAULT_HIERARCHY')
	AND LOOKUP_CODE = ZxProductOptionsAll.DEF_OPTION_HIER_6_CODE
	) RES_DEFAULTING_ORDER_6
,(
	CASE
		WHEN ZxProductOptionsAll.APPLICATION_ID != 222
		THEN ZxProductOptionsAll.TAX_CLASSIFICATION_CODE
	END) RES_FINANCIAL_OPTIONS_TAX_CLAS
,(
	CASE
		WHEN ZxProductOptionsAll.APPLICATION_ID = 222
		THEN ZxProductOptionsAll.TAX_CLASSIFICATION_CODE
	END) RES_SYSTEM_OPTIONS_TAX_CLASSIF
,DECODE(ZxProductOptionsAll.TAX_CURRENCY_CODE,NULL,NULL,CurrencyPEO.CURRENCY_CODE || ' - ' || CurrencyPEO.NAME)
	RES_TAX_CURRENCY
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'ZX_ROUNDING_RULE'
	AND LOOKUP_CODE   = ZxProductOptionsAll.TAX_ROUNDING_RULE
	) RES_ROUNDING_RULE
,ZxProductOptionsAll.TAX_MINIMUM_ACCOUNTABLE_UNIT RES_MINIMUM_ACCOUNTABLE_UNIT
,ZxProductOptionsAll.TAX_PRECISION RES_TAX_PRECISION
,DECODE(ZxProductOptionsAll.ALLOW_TAX_ROUNDING_OVRD_FLAG,'Y','Yes','No') RES_ALLOW_TAX_ROUNDING_OVERRID
,ZxProductOptionsAll.SALES_TAX_GEOCODE RES_OVERRIDE_GEOCODE_FOR_TAXWA
,DECODE(ZxProductOptionsAll.TAX_USE_CUSTOMER_EXEMPT_FLAG,'Y','Yes','No') RES_ALLOW_OVERRIDE_AND_ENTRY_O
,ZxProductOptionsAll.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,ZxProductOptionsAll.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,ZxProductOptionsAll.CREATED_BY RSC_CREATED_BY
,ZxProductOptionsAll.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,FinancialsBusinessUnitPEO.BU_ID RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM ZX_PARTY_TAX_PROFILE BusinessUnitTaxProfileEO
,FUN_ALL_BUSINESS_UNITS_V FinancialsBusinessUnitPEO
,ZX_PRODUCT_OPTIONS_ALL ZxProductOptionsAll
,FND_APPLICATION_VL ApplicationE0
,FND_CURRENCIES_VL CurrencyPEO
WHERE BusinessUnitTaxProfileEO.PARTY_ID   = FinancialsBusinessUnitPEO.BU_ID
AND FinancialsBusinessUnitPEO.BU_ID       = ZxProductOptionsAll.ORG_ID
AND ZxProductOptionsAll.APPLICATION_ID    = ApplicationE0.APPLICATION_ID
AND ZxProductOptionsAll.TAX_CURRENCY_CODE = CurrencyPEO.CURRENCY_CODE(+)
ORDER BY FinancialsBusinessUnitPEO.BU_NAME
,ZxProductOptionsAll.APPLICATION_ID