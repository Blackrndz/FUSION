/* ****************************************************************************
 * $Revision: 72749 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2019-10-23 15:22:46 +0700 (Wed, 23 Oct 2019) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13.19/trunk/core/reverse_sql/FINANCIALS/Manage%20Availability%20Lookups%20-%20Lookup%20Types.sql $:
 * $Id: Manage Availability Lookups - Lookup Types.sql 72749 2019-10-23 08:22:46Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

--RSC_PREREQUISITE_OBJECTS=CMP_PLANS_VL
 
SELECT cmpPLANEO.PLAN_NAME RES_PLAN
--Primary Hierarchy
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.HIERARCHY_TYPE 
	AND LOOKUP_TYPE = 'CMP_HIERARCHY' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_PRIMARY_HIERARCHY_SOURCE
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.PRIMARY_MANAGER_TYPE 
	AND LOOKUP_TYPE = 'PER_SUPERVISOR_TYPE' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_PRIMARY_HIERARCHY_MANAGER_
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = cmpPLANEO.HIERARCHY_RULE_ID 
    ) RES_PRIMARY_HIERARCHY_HIERARCH
,(SELECT TREE_NAME FROM FND_TREE_VL WHERE TREE_CODE = cmpPLANEO.PRIMARY_POSITION_TREE_CODE 
	AND TREE_STRUCTURE_CODE = 'PER_POS_TREE_STRUCTURE') RES_PRIMARY_HIERARCHY_POSITION
,(SELECT TREE_NAME FROM FND_TREE_VL WHERE TREE_CODE = cmpPLANEO.PRIMARY_DEPARTMENT_TREE_CODE 
	AND TREE_STRUCTURE_CODE = 'PER_DEPT_TREE_STRUCTURE') RES_PRIMARY_HIERARCHY_DEPARTME
,(SELECT TREE_NAME FROM FND_TREE_VL WHERE TREE_CODE = cmpPLANEO.PRIMARY_POSITION_TREE_CODE 
	AND TREE_STRUCTURE_CODE = 'PER_POS_TREE_STRUCTURE') RES_POSITION_TREE
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.HIERARCHY_GAP_HANDLING 
	AND LOOKUP_TYPE = 'CMP_GAP_HANDLING' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_PRIMARY_HIERARCHY_MISSING_
,DECODE(cmpPLANEO.LOG_PRIMARY_MISSING_RLTN,'Y','Yes','No') RES_PRIMARY_HIERARCHY_RECORD_M
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.PRIMARY_ACCESS_CODE 
	AND LOOKUP_TYPE = 'CMP_ACCESS' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_PRIMARY_HIERARCHY_DEFAULT_
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = cmpPLANEO.PRIMARY_ACCESS_RULE_ID 
    ) RES_PRIMARY_HIERARCHY_DEFAUL_0
,DECODE(cmpPLANEO.PRIMARY_ACCESS_REFRESH_FLAG,'Y','Yes','No')RES_PRIMARY_HIERARCHY_REFRESH_

--Secondary Hierarchy
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.SECONDARY_HIERARCHY_TYPE 
	AND LOOKUP_TYPE = 'CMP_HIERARCHY' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_SECONDARY_HIERARCHY_SOURCE
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.SECONDARY_MANAGER_TYPE 
	AND LOOKUP_TYPE = 'PER_SUPERVISOR_TYPE' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_SECONDARY_HIERARCHY_MANAGE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = cmpPLANEO.SECONDARY_HIERARCHY_RULE_ID 
    ) RES_SECONDARY_HIERARCHY_HIERAR
,(SELECT TREE_NAME FROM FND_TREE_VL WHERE TREE_CODE = cmpPLANEO.SECONDARY_POSITION_TREE_CODE 
	AND TREE_STRUCTURE_CODE = 'PER_POS_TREE_STRUCTURE') RES_SECONDARY_HIERARCHY_POSITI
,(SELECT TREE_NAME FROM FND_TREE_VL WHERE TREE_CODE = cmpPLANEO.SECONDARY_DEPARTMENT_TREE_CODE 
	AND TREE_STRUCTURE_CODE = 'PER_DEPT_TREE_STRUCTURE') RES_SECONDARY_HIERARCHY_DEPART
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.SECOND_HIERARCHY_GAP_HANDLING 
	AND LOOKUP_TYPE = 'CMP_GAP_HANDLING' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_SECONDARY_HIERARCHY_MISSIN
,DECODE(cmpPLANEO.LOG_SECONDARY_MISSING_RLTN,'Y','Yes','No') RES_SECONDARY_HIERARCHY_RECORD
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.SECONDARY_ACCESS_CODE 
	AND LOOKUP_TYPE = 'CMP_ACCESS' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_SECONDARY_HIERARCHY_DEFAUL
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = cmpPLANEO.SECONDARY_ACCESS_RULE_ID 
    ) RES_SECONDARY_HIERARCHY_DEFA_1
,DECODE(cmpPLANEO.SECONDARY_ACCESS_REFRESH_FLAG,'Y','Yes','No') RES_SECONDARY_HIERARCHY_REFRES

--Reviewers
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.REVIEWER_HIERARCHY_TYPE 
	AND LOOKUP_TYPE = 'CMP_HIERARCHY' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_REVIEWERS_SOURCE
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.REVIEWER_MANAGER_TYPE 
	AND LOOKUP_TYPE = 'PER_SUPERVISOR_TYPE' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_REVIEWERS_MANAGER_TYPE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = cmpPLANEO.REVIEWER_HIERARCHY_RULE_ID 
    ) RES_REVIEWERS_HIERARCHY_DETERM
,(SELECT TREE_NAME FROM FND_TREE_VL WHERE TREE_CODE = cmpPLANEO.REVIEWER_POSITION_TREE_CODE 
	AND TREE_STRUCTURE_CODE = 'PER_POS_TREE_STRUCTURE') RES_REVIEWERS_POSITION_TREE
,(SELECT TREE_NAME FROM FND_TREE_VL WHERE TREE_CODE = cmpPLANEO.REVIEWER_DEPARTMENT_TREE_CODE 
	AND TREE_STRUCTURE_CODE = 'PER_DEPT_TREE_STRUCTURE') RES_REVIEWERS_DEPARTMENT_TREE
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.REVIEW_HIERARCHY_GAP_HANDLING 
	AND LOOKUP_TYPE = 'CMP_GAP_HANDLING' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_REVIEWERS_MISSING_MANAGER_
,DECODE(cmpPLANEO.LOG_REVIEWER_MISSING_RLTN,'Y','Yes','No') RES_REVIEWERS_RECORD_MISSING_R
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = cmpPLANEO.REVIEWER_ACCESS_CODE 
	AND LOOKUP_TYPE = 'CMP_ACCESS' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_REVIEWERS_DEFAULT_ACCESS_L
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = cmpPLANEO.REVIEWER_ACCESS_RULE_ID 
    )  RES_REVIEWERS_DEFAULT_ACCESS_2
,DECODE(cmpPLANEO.REVIEWER_ACCESS_REFRESH_FLAG,'Y','Yes','No') RES_REVIEWERS_REFRESH_DEFAULT_


,cmpPLANEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,cmpPLANEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,cmpPLANEO.CREATED_BY RSC_CREATED_BY
,cmpPLANEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM CMP_PLANS_VL cmpPLANEO
WHERE cmpPLANEO.COMP_TYPE = 'CWB'
--AND SYSDATE BETWEEN START_DATE AND NVL(END_DATE,TO_DATE('4712-12-31','YYYY-MM-DD'))
ORDER BY cmpPLANEO.PLAN_NAME