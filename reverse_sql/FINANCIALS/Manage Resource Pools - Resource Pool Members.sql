/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Resource%20Pools%20-%20Resource%20Pool%20Members.sql $:
 * $Id: Manage Resource Pools - Resource Pool Members.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */


SELECT pjrREPOOLSEO.NAME RES_RESOURCE_POOL
,pjtPRJENREEO.DISPLAY_NAME RES_RESOURCE_POOL_MEMBERS
,null RES_TARGET_RESOURCE_POOL
,pjrREPOOLASSEO.FROM_DATE RES_FROM_DATE
,pjrREPOOLASSEO.TO_DATE RES_TO_DATE
,(SELECT NAME FROM  PJT_PROJECT_ROLES_VL WHERE PROJECT_ROLE_ID = pjtPRJENREEO.PROJECT_ROLE_ID)RES_PRIMARY_PROJECT_ROLE
,(SELECT LOCATION_NAME FROM HR_LOCATIONS_ALL_F_VL WHERE LOCATION_ID = perALLASSEO.LOCATION_ID 
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
 )RES_LOCATION
,(SELECT DISPLAY_NAME FROM PJT_PRJ_ENTERPRISE_RESOURCE_VL 
	WHERE RESOURCE_ID  = pjtPRJENREEO.RESOURCE_MANAGER_ID AND LANGUAGE = USERENV('LANG')) RES_MANAGER
,(SELECT NAME FROM PER_JOBS_F_VL WHERE JOB_ID = perALLASSEO.JOB_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
 )RES_JOB
,(SELECT NAME FROM HR_ORGANIZATION_V WHERE ORGANIZATION_ID = perALLASSEO.ORGANIZATION_ID
	AND CLASSIFICATION_CODE = 'DEPARTMENT' AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
 )RES_ORGANIZATION
,(SELECT MEANING FROM FND_LOOKUPS WHERE LOOKUP_CODE = perPERSONEO.SYSTEM_PERSON_TYPE AND LOOKUP_TYPE = 'PJR_PERSON_TYPE') RES_PERSON_TYPE

,pjrREPOOLASSEO.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,pjrREPOOLASSEO.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,pjrREPOOLASSEO.CREATED_BY  RSC_CREATED_BY
,pjrREPOOLASSEO.CREATION_DATE  RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM PJR_RESOURCE_POOLS_VL pjrREPOOLSEO
,PJR_RESOURCE_POOL_ASSIGNMENTS pjrREPOOLASSEO
,PJT_PRJ_ENTERPRISE_RESOURCE_VL pjtPRJENREEO
,PER_ALL_ASSIGNMENTS_M perALLASSEO
,PER_PERSON_TYPES perPERSONEO
WHERE pjrREPOOLSEO.POOL_ID = pjrREPOOLASSEO.POOL_ID
AND pjrREPOOLASSEO.RESOURCE_ID = pjtPRJENREEO.RESOURCE_ID
AND pjtPRJENREEO.PERSON_ID = perALLASSEO.PERSON_ID
AND perPERSONEO.PERSON_TYPE_ID = perALLASSEO.PERSON_TYPE_ID
AND perALLASSEO.PRIMARY_FLAG = 'Y'
AND pjtPRJENREEO.LANGUAGE = USERENV('LANG')
AND SYSDATE BETWEEN perALLASSEO.EFFECTIVE_START_DATE AND NVL(perALLASSEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN pjrREPOOLASSEO.FROM_DATE AND NVL(pjrREPOOLASSEO.TO_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN pjrREPOOLSEO.FROM_DATE AND NVL(pjrREPOOLSEO.TO_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))

ORDER BY 1 ,2

