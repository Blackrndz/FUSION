/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Depreciation%20Methods%20-%20Manage%20Depreciation%20Methods.sql $:
 * $Id: Manage Depreciation Methods - Manage Depreciation Methods.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */


SELECT QRSLT.METHOD_CODE  RES_NAME
,QRSLT.NAME RES_DESCRIPTION
,QRSLT.SET_NAME RES_REFERENCE_DATA_SET
,QRSLT.MEANING RES_METHOD_TYPE
,QRSLT.MEANING1 RES_CALCULATION_BASIS
,QRSLT.DESCRIPTION RES_DEPRECIATION_BASIS_RULE
,DECODE(STL_METHOD_FLAG,'YES','Yes','No') RES_STRAIGHT_LINE_METHOD
,DECODE(DEPRECIATE_LASTYEAR_FLAG,'YES','Yes','No')  RES_DEPRECIATE_IN_YEAR_RETIRED
,(CASE 
	WHEN USE_LIFE_IN_PERIODS_FLAG = 'N' THEN 
		'Life in years and months'
	WHEN USE_LIFE_IN_PERIODS_FLAG = 'Y' THEN
		'Life in periods'
	ELSE
		NULL
	END) RES_LIFE_OPTIONS
,DECODE(USE_LIFE_IN_PERIODS_FLAG,'Y',NULL,TRUNC(QRSLT.LIFE_IN_MONTHS/12)) RES_LIFE_IN_YEARS
,DECODE(USE_LIFE_IN_PERIODS_FLAG,'Y',NULL,MOD(QRSLT.LIFE_IN_MONTHS,12)) RES_LIFE_IN_MONTHS
,DECODE(USE_LIFE_IN_PERIODS_FLAG,'Y',QRSLT.LIFE_IN_MONTHS,NULL) RES_LIFE_IN_PERIODS
,QRSLT.PRORATE_PERIODS_PER_YEAR RES_PRORATE_PERIODS_PER_YEAR
,DECODE(QRSLT.EXCLUDE_SALVAGE_VALUE_FLAG,'YES','Yes','No') RES_EXCLUDE_SALVAGE_VALUE
,DECODE(QRSLT.POLISH_ADJ_CALC_BASIS_FLAG,'Y','Yes','No')  RES_POLISH_ADJUSTMENT_CALCULAT
,QRSLT.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,QRSLT.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,QRSLT.CREATED_BY RSC_CREATED_BY
,QRSLT.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM (SELECT DepreciationMethodEO.METHOD_CODE
,DepreciationMethodEO.NAME
,DEPRECIATIONMETHODEO.SET_ID
,DEPRECIATIONMETHODEO.DEPRECIATE_LASTYEAR_FLAG
,DepreciationMethodEO.RATE_SOURCE_RULE
,DepreciationMethodEO.DEPRN_BASIS_RULE
,DepreciationMethodEO.DEPRN_BASIS_RULE_ID
,DepreciationMethodEO.PRORATE_PERIODS_PER_YEAR
,DepreciationMethodEO.STL_METHOD_FLAG
,DEPRECIATIONMETHODEO.METHOD_ID
,DEPRECIATIONMETHODEO.LIFE_IN_MONTHS
,DEPRECIATIONMETHODEO.USE_LIFE_IN_PERIODS_FLAG
,DEPRECIATIONMETHODEO.EXCLUDE_SALVAGE_VALUE_FLAG
,DEPRECIATIONMETHODEO.POLISH_ADJ_CALC_BASIS_FLAG
,DEPRECIATIONMETHODEO.LAST_UPDATED_BY 
,DEPRECIATIONMETHODEO.LAST_UPDATE_DATE
,DEPRECIATIONMETHODEO.CREATION_DATE
,DEPRECIATIONMETHODEO.CREATED_BY
,LookupMethodTypePEO.LOOKUP_TYPE
,LookupMethodTypePEO.LOOKUP_CODE
,LookupMethodTypePEO.MEANING
,LookupCalcbasisPEO.LOOKUP_CODE AS LOOKUP_CODE1
,LookupCalcbasisPEO.LOOKUP_TYPE AS LOOKUP_TYPE1
,LOOKUPCALCBASISPEO.MEANING     as MEANING1
,SETIDSETSEO.SET_NAME 
,DEPRECIATIONRU.DESCRIPTION
FROM FA_METHODS DEPRECIATIONMETHODEO
,FA_DEPRN_BASIS_RULES DEPRECIATIONRU
,FND_LOOKUPS LookupMethodTypePEO
,FND_LOOKUPS LOOKUPCALCBASISPEO
,FND_SETID_SETS_VL SETIDSETSEO
WHERE LookupMethodTypePEO.LOOKUP_TYPE (+)          = 'FA_RATE_SOURCE_RULE'
AND DepreciationMethodEO.RATE_SOURCE_RULE          = LookupMethodTypePEO.LOOKUP_CODE (+)
AND LookupCalcbasisPEO.LOOKUP_TYPE (+)             = 'FA_DEPRN_BASIS_RULE'
AND DEPRECIATIONMETHODEO.DEPRN_BASIS_RULE          = LOOKUPCALCBASISPEO.LOOKUP_CODE (+)
AND DEPRECIATIONMETHODEO.SET_ID                    = SETIDSETSEO.SET_ID(+)
AND DEPRECIATIONMETHODEO.DEPRN_BASIS_RULE_ID       =  DEPRECIATIONRU.DEPRN_BASIS_RULE_ID(+)
ORDER BY DepreciationMethodEO.METHOD_CODE
,DepreciationMethodEO.RATE_SOURCE_RULE
,DEPRECIATIONMETHODEO.DEPRN_BASIS_RULE
) QRSLT