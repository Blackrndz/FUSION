/* ****************************************************************************
 * $Revision: 78239 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 22:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20HCM%20Extract%20Definitions%20-%20Extract%20Definition.sql $:
 * $Id: Manage HCM Extract Definitions - Extract Definition.sql 78239 2022-04-07 15:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
--RSC_PREREQUISITE_OBJECTS=PER_EXT_DEFINITIONS_VL

SELECT extDefsE0.BASE_DEFINITION_NAME RES_NAME
,TO_CHAR(extDefsE0.DATE_START,'DD-Mon-YYYY') RES_START_DATE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'PER_EXT_TYPES'
    AND LOOKUP_CODE = extDefsE0.EXT_TYPE_CODE
    ) RES_TYPE
,DECODE(extDefsE0.FREEZE_STATUS,'Y','Yes','N','No') RES_LOCK_DEFINITION
,DECODE(extDefsE0.ATTRIBUTE28,'A','Active','Inactive') RES_STATUS
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'ORA_PER_EXT_VALID_STATUS'
    AND LOOKUP_CODE = 'ORA_PER_EXT_'||extDefsE0.VALID_STATUS
    ) RES_VALID
,extDefsE0.DESCRIPTION RES_DESCRIPTION
,DECODE(extDefsE0.ATTRIBUTE24,'Y','Yes','N','No') RES_CHANGES_ONLY
,(CASE
    WHEN extDefsE0.EXT_TYPE_CODE IN ('ARCRET','PAYINT','PAYROLLAR','ORA_INBINT','ORA_RECAR') THEN
        (SELECT NAME
            FROM PER_LEGISLATIVE_DATA_GROUPS_TL
            WHERE LANGUAGE = USERENV('LANG')
            AND LEGISLATIVE_DATA_GROUP_ID = extDefsE0.LEGISLATIVE_DATA_GROUP_ID)
    END) RES_LEGISLATIVE_DATA_GROUP
,'' RES_SOURCE_TEMPLATE
,extDefsE0.UNFREEZE_COMMENTS RES_UNLOCK_COMMENTS
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'ORA_PER_EXT_BEN_VENDORS'
    AND LOOKUP_CODE = extDefsE0.ATTRIBUTE19
     )  RES_CONSUMER
,extDefsE0.ATTRIBUTE18 RES_ADDITIONAL_DETAILS
,extDefsE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,extDefsE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,extDefsE0.CREATED_BY RSC_CREATED_BY
,extDefsE0.CREATION_DATE RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,(SELECT LEGISLATION_CODE
	FROM PER_LEGISLATIVE_DATA_GROUPS_VL
	WHERE LEGISLATIVE_DATA_GROUP_ID = extDefsE0.LEGISLATIVE_DATA_GROUP_ID
	) RSC_COUNTRY_ID

FROM PER_EXT_DEFINITIONS_VL extDefsE0
WHERE extDefsE0.LEGISLATION_CODE IS NULL
AND extDefsE0.CREATOR_ID IS NULL
ORDER BY extDefsE0.BASE_DEFINITION_NAME