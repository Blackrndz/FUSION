/* ****************************************************************************
 * $Revision: 60928 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2017-02-06 17:14:01 +0700 (Mon, 06 Feb 2017) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/reverse_sql/FINANCIALS/Complete%20Primary%20to%20Secondary%20Ledger%20Mapping%20-%20Journal%20Conversion%20Rules.sql $:
 * $Id: Complete Primary to Secondary Ledger Mapping - Journal Conversion Rules.sql 60928 2017-02-06 10:14:01Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
SELECT gmsINSTITUE0.INSTITUTION_NAME RES_NAME
,PersonNameDPEO.DISPLAY_NAME RES_CONTACT_NAME
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = gmsINSTITUCONTACTTYPE0.CONTACT_TYPE
	AND LOOKUP_TYPE = 'ORA_GMS_OFFICIAL_TYPE' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE  AND NVL(END_DATE_ACTIVE,TO_DATE('31-12-4712','DD-MM-YYYY'))
	) RES_OFFICIAL_TYPE
,(SELECT DESCRIPTION FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = gmsINSTITUCONTACTTYPE0.CONTACT_TYPE
	AND LOOKUP_TYPE = 'ORA_GMS_OFFICIAL_TYPE' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE  AND NVL(END_DATE_ACTIVE,TO_DATE('31-12-4712','DD-MM-YYYY'))
	) RES_DESCRIPTION


,gmsINSTITUCONTACTTYPE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,gmsINSTITUCONTACTTYPE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,gmsINSTITUCONTACTTYPE0.CREATED_BY  RSC_CREATED_BY
,gmsINSTITUCONTACTTYPE0.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM GMS_INSTITUTIONS_VL gmsINSTITUE0
,GMS_INSTITUTION_CONTACTS gmsINSTITUCONTACTE0
,GMS_INSTN_CONTACT_TYPES gmsINSTITUCONTACTTYPE0
,FUSION.PER_PERSON_NAMES_F_V PersonNameDPEO

WHERE gmsINSTITUE0.INSTITUTION_ID = gmsINSTITUCONTACTE0.INSTITUTION_ID
AND gmsINSTITUCONTACTE0.PERSON_ID = PersonNameDPEO.PERSON_ID
AND gmsINSTITUCONTACTE0.INSTN_CONTACT_ID = gmsINSTITUCONTACTTYPE0.INSTN_CONTACT_ID
AND SYSDATE BETWEEN PersonNameDPEO.EFFECTIVE_START_DATE AND PersonNameDPEO.EFFECTIVE_END_DATE
ORDER BY gmsINSTITUE0.INSTITUTION_NAME
,PersonNameDPEO.DISPLAY_NAME
,RES_OFFICIAL_TYPE
