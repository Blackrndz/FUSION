/* ****************************************************************************
 * $Revision$:
 * $Author$:
 * $Date$:
 * $HeadURL$:
 * $Id$:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */


SELECT (SELECT NAME 
	FROM GL_LEDGERS 
	WHERE LEDGER_ID = xccBCEBUE0.LEDGER_ID
	) RES_LEDGER_NAME
,(SELECT BU_NAME
	FROM FUN_ALL_BUSINESS_UNITS_V
	WHERE BU_ID = xccBCEBUE0.BUSINESS_UNIT_ID 
	) RES_BUSINESS_UNIT_NAME
,(SELECT USER_TRANSACTION_SOURCE 
	FROM PJF_TXN_SOURCES_VL 
	WHERE TRANSACTION_SOURCE = xccBCETRANSOURCE0.TRANSACTION_SOURCE_CODE
	) RES_BUSINESS_UNIT_TRANSACTION_
,(CASE 
	WHEN xccBCETRANSOURCE0.ALL_DOCUMENT_TYPE_FLAG = 'Y' THEN 
		(CASE
			WHEN (SELECT COUNT(*) CNT 
				FROM PJF_TXN_DOCUMENT_VL 
				WHERE TO_CHAR(TRANSACTION_SOURCE_ID) = xccBCETRANSOURCE0.TRANSACTION_SOURCE_CODE) > 1 THEN
				'All'
			WHEN xccBCETRANSOURCE0.TRANSACTION_SOURCE_CODE = 'PROJECTS' THEN
				'All'
			ELSE
				(SELECT DOCUMENT_NAME 
					FROM PJF_TXN_DOCUMENT_VL 
					WHERE TO_CHAR(TRANSACTION_SOURCE_ID) = xccBCETRANSOURCE0.TRANSACTION_SOURCE_CODE)
            END)
	ELSE 
		(SELECT DOCUMENT_NAME 
			FROM PJF_TXN_DOCUMENT_VL 
			WHERE DOCUMENT_CODE = xccBCEDOCE0.DOCUMENT_TYPE_CODE)
	END) RES_BUSINESS_UNIT_DOCUMENTS
,'Yes' RES_BUSINESS_UNIT_DOCUMENTS_EN
,xccBCETRANSOURCE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,xccBCETRANSOURCE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,xccBCETRANSOURCE0.CREATED_BY RSC_CREATED_BY
,xccBCETRANSOURCE0.CREATION_DATE RSC_CREATION_DATE
,xccBCEBUE0.LEDGER_ID RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,xccBCEBUE0.BUSINESS_UNIT_ID RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID
FROM XCC_BCE_BUSINESS_UNITS xccBCEBUE0
,XCC_BCE_TRANSACTION_SOURCES xccBCETRANSOURCE0
,XCC_BCE_DOCUMENT_TYPES xccBCEDOCE0
WHERE xccBCEBUE0.LEDGER_ID = xccBCETRANSOURCE0.LEDGER_ID
AND xccBCEBUE0.BUSINESS_UNIT_ID = xccBCETRANSOURCE0.BUSINESS_UNIT_ID 
AND xccBCETRANSOURCE0.BUSINESS_FUNCTION_CODE = 'PROJECT_ACCOUNTING_BF'
AND xccBCETRANSOURCE0.LEDGER_ID = xccBCEDOCE0.LEDGER_ID(+)
AND xccBCETRANSOURCE0.BUSINESS_UNIT_ID = xccBCEDOCE0.BUSINESS_UNIT_ID(+)
AND xccBCETRANSOURCE0.TRANSACTION_SOURCE_CODE = xccBCEDOCE0.TRANSACTION_SOURCE_CODE(+)
ORDER BY 1,2