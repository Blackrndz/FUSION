/* ****************************************************************************
 * $Revision: 78239 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 22:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Leave%20Agreements%20-%20Leave%20Agreement.sql $:
 * $Id: Manage Leave Agreements - Leave Agreement.sql 78239 2022-04-07 15:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- RSC_PREREQUISITE_OBJECTS=ANC_ABSENCE_AGREEMENTS_VL

SELECT TO_CHAR(ancABSENAGREEMEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,DECODE(TO_CHAR(ancABSENAGREEMEO.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(ancABSENAGREEMEO.EFFECTIVE_END_DATE,'DD-Mon-YYYY')) RES_EFFECTIVE_END_DATE
,(SELECT TERRITORY_SHORT_NAME
    FROM FND_TERRITORIES_VL
    WHERE TERRITORY_CODE = ancABSENAGREEMEO.LEGISLATION_CODE
	) RES_LEGISLATION
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES
	WHERE LANGUAGE = USERENV('LANG')
	AND LOOKUP_TYPE = 'ORA_ANC_AGREE_CHP'
	AND LOOKUP_CODE = ancABSENAGREEMEO.AGREEMENT_PATTERN_CD 
	) RES_PATTERN
,ancABSENAGREEMEO.NAME RES_NAME
,ancABSENAGREEMEO.DESCRIPTION RES_DESCRIPTION
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES
	WHERE LANGUAGE = USERENV('LANG')
	AND LOOKUP_TYPE = 'ANC_SETUP_OBJ_STATUS'
	AND LOOKUP_CODE = ancABSENAGREEMEO.STATUS 
	) RES_STATUS
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES
	WHERE LANGUAGE = USERENV('LANG')
	AND LOOKUP_TYPE = 'ORA_ANC_ELIGIBILITY'
	AND LOOKUP_CODE = ancABSENAGREEMEO.ELIGI_RULE_CD 
	) RES_ELIGIBILITY_RULE
,(CASE
	WHEN ancABSENAGREEMEO.ELIGI_RULE_CD = 'ORA_ANC_FORMULA' THEN
		(SELECT BASE_FORMULA_NAME
			FROM FF_FORMULAS_VL
			WHERE FORMULA_ID = ancABSENAGREEMEO.ELIGI_FORMULA_ID
			AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE)
	WHEN ancABSENAGREEMEO.ELIGI_RULE_CD = 'ORA_ANC_PROFILE' THEN
		(SELECT NAME
			FROM BEN_ELIGY_PRFL
			WHERE ELIGY_PRFL_ID = ancABSENAGREEMEO.ELIGI_PROFILE_ID
			AND SYSDATE BETWEEN START_DATE AND END_DATE)
	END) RES_FORMULA_ELIGIBILITY_PROFIL
,DECODE(ancABSENAGREEMEO.ELIGI_OVERRIDE_CD,'Y','Yes','No') RES_ENABLE_ELIGIBILITY_OVERRID
,(SELECT BASE_FORMULA_NAME
			FROM FF_FORMULAS_VL
			WHERE FORMULA_ID = ancABSENAGREEMEO.VALIDATION_FORMULA_ID
			AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE) RES_VALIDATION_FORMULA
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES
	WHERE LANGUAGE = USERENV('LANG')
	AND LOOKUP_TYPE = 'ORA_ANC_PARTNER_RULE'
	AND LOOKUP_CODE = ancABSENAGREEMEO.PARTNER_RULE_CD 
	) RES_PARTNER_RULE
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES
	WHERE LANGUAGE = USERENV('LANG')
	AND LOOKUP_TYPE = 'ORA_ANC_LEG_GROUPING'
	AND LOOKUP_CODE = ancABSENAGREEMEO.LEG_GROUPING_CD 
	) RES_LEGISLATIVE_GROUPING_CODE
,(SELECT NAME FROM ANC_ABSENCE_TYPES_VL WHERE ABSENCE_TYPE_ID = ancABSENAGREEMEO.ABSENCE_TYPE_ID
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_SOURCE_ABSENCE_TYPE
,ancABSENAGREEMEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,ancABSENAGREEMEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,ancABSENAGREEMEO.CREATED_BY RSC_CREATED_BY
,ancABSENAGREEMEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,ancABSENAGREEMEO.LEGISLATION_CODE RSC_COUNTRY_ID

FROM ANC_ABSENCE_AGREEMENTS_VL ancABSENAGREEMEO
WHERE SYSDATE BETWEEN ancABSENAGREEMEO.EFFECTIVE_START_DATE AND NVL(ancABSENAGREEMEO.EFFECTIVE_END_DATE,TO_DATE('4712-12-31','YYYY-MM-DD'))
AND ancABSENAGREEMEO.LANGUAGE = USERENV('LANG')
ORDER BY ancABSENAGREEMEO.NAME