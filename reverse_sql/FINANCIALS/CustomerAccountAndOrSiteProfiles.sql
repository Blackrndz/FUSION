/* ****************************************************************************
 * $Revision: 78241 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2022-04-08 10:33:04 +0700 (Fri, 08 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/CustomerAccountAndOrSiteProfiles.sql $:
 * $Id: CustomerAccountAndOrSiteProfiles.sql 78241 2022-04-08 03:33:04Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

-- RSC_PREREQUISITE_OBJECTS=HZ_CUSTOMER_PROFILES_F
-- RSC_PREREQUISITE_OBJECTS=RA_CUSTOMER_PROFILES_INT_ALL
-- STRICTLY_BATCH_SEQ = RES_CUSTOMER_ACCOUNT_SOURCE__0,RES_ACCOUNT_SITE_SOURCE_SYST_1
 
--Account level
SELECT '' RES_BATCH_IDENTIFIER
,'I' RES_INSERT_UPDATE_INDICATOR
,'CUSTOMER' RES_PARTY_ORIGINAL_SYSTEM
,HzPartiesE0.PARTY_NUMBER RES_PARTY_ORIGINAL_SYSTEM_REFE
,'CUSTOMER' RES_CUSTOMER_ACCOUNT_SOURCE_SY
,HzCustAccountsE0.ACCOUNT_NUMBER RES_CUSTOMER_ACCOUNT_SOURCE__0
,'' RES_ACCOUNT_SITE_SOURCE_SYSTEM
,'' RES_ACCOUNT_SITE_SOURCE_SYST_1
,HzCustProfileClassesE0.NAME RES_CUSTOMER_PROFILE_CLASS
,ArCollectorsE0.NAME RES_COLLECTOR_NAME
,(SELECT DISPLAY_NAME FROM PER_PERSON_NAMES_F WHERE PERSON_ID = HzCustomerProfileFE0.CREDIT_ANALYST_ID
	AND NAME_TYPE = 'GLOBAL') RES_CREDIT_ANALYST
,HzCustomerProfileFE0.CREDIT_REVIEW_CYCLE RES_CREDIT_REVIEW_CYCLE
,TO_CHAR(HzCustomerProfileFE0.LAST_CREDIT_REVIEW_DATE,'YYYY/MM/DD') RES_LAST_REVIEW_DATE
,TO_CHAR(HzCustomerProfileFE0.NEXT_CREDIT_REVIEW_DATE,'YYYY/MM/DD') RES_NEXT_REVIEW_DATE
,HzCustomerProfileFE0.CREDIT_BALANCE_STATEMENTS RES_SEND_CREDIT_BALANCE
,HzCustomerProfileFE0.CREDIT_CHECKING RES_INCLUDE_IN_CREDIT_CHECK
,HzCustomerProfileFE0.CREDIT_HOLD RES_CREDIT_HOLD
,HzCustomerProfileFE0.DISCOUNT_TERMS RES_ALLOW_DISCOUNT
,HzCustomerProfileFE0.DUNNING_LETTERS RES_SEND_DUNNING_LETTERS
,HzCustomerProfileFE0.INTEREST_CHARGES RES_ENABLE_LATE_CHARGES
,HzCustomerProfileFE0.SEND_STATEMENTS RES_SEND_STATEMENT
,HzCustomerProfileFE0.TOLERANCE RES_TOLERANCE
,HzCustomerProfileFE0.TAX_PRINTING_OPTION RES_TAX_PRINTING_OPTION
,HzCustomerProfileFE0.ACCOUNT_STATUS RES_ACCOUNT_STATUS
,HzCustomerProfileFE0.AUTOCASH_HIERARCHY_ID RES_AUTOCASH_RULE_SET
,HzCustomerProfileFE0.CREDIT_RATING RES_CREDIT_RATING
,HzCustomerProfileFE0.DISCOUNT_GRACE_DAYS RES_DISCOUNT_GRACE_DAYS
,HzCustomerProfileFE0.INTEREST_PERIOD_DAYS RES_INTEREST_DAYS_PERIOD
,HzCustomerProfileFE0.OVERRIDE_TERMS RES_OVERRIDE_TERMS
,HzCustomerProfileFE0.PAYMENT_GRACE_DAYS RES_RECEIPT_GRACE_DAYS
,HzCustomerProfileFE0.PERCENT_COLLECTABLE RES_COLLECTIBLE
,HzCustomerProfileFE0.RISK_CODE RES_RISK_CODE
,(SELECT NAME
	FROM RA_TERMS_TL
	WHERE TERM_ID = HzCustomerProfileFE0.STANDARD_TERMS
	AND LANGUAGE = USERENV('LANG')
	) RES_PAYMENT_TERMS
,(SELECT NAME
	FROM AR_STATEMENT_CYCLES
	WHERE STATEMENT_CYCLE_ID = HzCustomerProfileFE0.STATEMENT_CYCLE_ID 
	) RES_STATEMENT_CYCLE
,HzCustomerProfileFE0.CHARGE_ON_FINANCE_CHARGE_FLAG RES_INTEREST_CALCULATION_FORMU
,(SELECT NAME
	FROM RA_GROUPING_RULES
	WHERE GROUPING_RULE_ID = HzCustomerProfileFE0.GROUPING_RULE_ID
	) RES_GROUPING_RULE
,HzCustProfileAmtsFE0.CURRENCY_CODE RES_CURRENCY
,HzCustProfileAmtsFE0.AUTO_REC_MIN_RECEIPT_AMOUNT RES_MINIMUM_RECEIPT_AMOUNT
,HzCustProfileAmtsFE0.INTEREST_RATE RES_INTEREST_CHARGE_RATE
,HzCustProfileAmtsFE0.MAX_INTEREST_CHARGE RES_MAXIMUM_LATE_CHARGE_PER_IN
,HzCustProfileAmtsFE0.MIN_DUNNING_AMOUNT RES_MINIMUM_DUNNING_AMOUNT
,HzCustProfileAmtsFE0.MIN_DUNNING_INVOICE_AMOUNT RES_MINIMUM_DUNNING_INVOICE_AM
,HzCustProfileAmtsFE0.MIN_FC_BALANCE_AMOUNT RES_MINIMUM_CUSTOMER_BALANCE_O
,HzCustProfileAmtsFE0.MIN_FC_INVOICE_AMOUNT RES_MINIMUM_INVOICE_BALANCE_OV
,HzCustProfileAmtsFE0.MIN_STATEMENT_AMOUNT RES_MINIMUM_STATEMENT_AMOUNT
,HzCustProfileAmtsFE0.TRX_CREDIT_LIMIT RES_CREDIT_LIMIT
,HzCustProfileAmtsFE0.OVERALL_CREDIT_LIMIT RES_ORDER_AMOUNT_LIMIT
,HzCustomerProfileFE0.ATTRIBUTE_CATEGORY RES_USER_DEFINED_CONTEXT_PROMP
,HzCustomerProfileFE0.ATTRIBUTE1 RES_DESCRIPTIVE_FLEXFIELD_SEGM
,HzCustomerProfileFE0.ATTRIBUTE2 RES_DESCRIPTIVE_FLEXFIELD_SE_2
,HzCustomerProfileFE0.ATTRIBUTE3 RES_DESCRIPTIVE_FLEXFIELD_SE_3
,HzCustomerProfileFE0.ATTRIBUTE4 RES_DESCRIPTIVE_FLEXFIELD_SE_4
,HzCustomerProfileFE0.ATTRIBUTE5 RES_DESCRIPTIVE_FLEXFIELD_SE_5
,HzCustomerProfileFE0.ATTRIBUTE6 RES_DESCRIPTIVE_FLEXFIELD_SE_6
,HzCustomerProfileFE0.ATTRIBUTE7 RES_DESCRIPTIVE_FLEXFIELD_SE_7
,HzCustomerProfileFE0.ATTRIBUTE8 RES_DESCRIPTIVE_FLEXFIELD_SE_8
,HzCustomerProfileFE0.ATTRIBUTE9 RES_DESCRIPTIVE_FLEXFIELD_SE_9
,HzCustomerProfileFE0.ATTRIBUTE10 RES_DESCRIPTIVE_FLEXFIELD_S_10
,HzCustomerProfileFE0.ATTRIBUTE11 RES_DESCRIPTIVE_FLEXFIELD_S_11
,HzCustomerProfileFE0.ATTRIBUTE12 RES_DESCRIPTIVE_FLEXFIELD_S_12
,HzCustomerProfileFE0.ATTRIBUTE13 RES_DESCRIPTIVE_FLEXFIELD_S_13
,HzCustomerProfileFE0.ATTRIBUTE14 RES_DESCRIPTIVE_FLEXFIELD_S_14
,HzCustomerProfileFE0.ATTRIBUTE15 RES_DESCRIPTIVE_FLEXFIELD_S_15
,HzCustProfileAmtsFE0.ATTRIBUTE_CATEGORY RES_USER_DEFINED_AMOUNT_CONTEX
,HzCustProfileAmtsFE0.ATTRIBUTE1 RES_DESCRIPTIVE_FLEXFIELD_AMOU
,HzCustProfileAmtsFE0.ATTRIBUTE2 RES_DESCRIPTIVE_FLEXFIELD_A_16
,HzCustProfileAmtsFE0.ATTRIBUTE3 RES_DESCRIPTIVE_FLEXFIELD_A_17
,HzCustProfileAmtsFE0.ATTRIBUTE4 RES_DESCRIPTIVE_FLEXFIELD_A_18
,HzCustProfileAmtsFE0.ATTRIBUTE5 RES_DESCRIPTIVE_FLEXFIELD_A_19
,HzCustProfileAmtsFE0.ATTRIBUTE6 RES_DESCRIPTIVE_FLEXFIELD_A_20
,HzCustProfileAmtsFE0.ATTRIBUTE7 RES_DESCRIPTIVE_FLEXFIELD_A_21
,HzCustProfileAmtsFE0.ATTRIBUTE8 RES_DESCRIPTIVE_FLEXFIELD_A_22
,HzCustProfileAmtsFE0.ATTRIBUTE9 RES_DESCRIPTIVE_FLEXFIELD_A_23
,HzCustProfileAmtsFE0.ATTRIBUTE10 RES_DESCRIPTIVE_FLEXFIELD_A_24
,HzCustProfileAmtsFE0.ATTRIBUTE11 RES_DESCRIPTIVE_FLEXFIELD_A_25
,HzCustProfileAmtsFE0.ATTRIBUTE12 RES_DESCRIPTIVE_FLEXFIELD_A_26
,HzCustProfileAmtsFE0.ATTRIBUTE13 RES_DESCRIPTIVE_FLEXFIELD_A_27
,HzCustProfileAmtsFE0.ATTRIBUTE14 RES_DESCRIPTIVE_FLEXFIELD_A_28
,HzCustProfileAmtsFE0.ATTRIBUTE15 RES_DESCRIPTIVE_FLEXFIELD_A_29
/*,'CUSTOMER' RES_PARTY_SOURCE_SYSTEM
,HzPartiesE0.PARTY_NUMBER RES_PARTY_SOURCE_SYSTEM_REFERE*/
,HzCustomerProfileFE0.AUTO_REC_INCL_DISPUTED_FLAG RES_AUTORECEIPTS_INCLUDE_DISPU
,HzCustomerProfileFE0.CLEARING_DAYS RES_RECEIPT_CLEARING_DAYS
,'' RES_ORGANIZATION_ID
,HzCustomerProfileFE0.CONS_INV_FLAG RES_ENABLE_BALANCE_FORWARD_BIL
,HzCustomerProfileFE0.CONS_INV_TYPE RES_BILL_TYPE
,HzCustomerProfileFE0.LOCKBOX_MATCHING_OPTION RES_MATCH_RECEIPTS_BY
,HzCustomerProfileFE0.AUTOCASH_HIERARCHY_ID_FOR_ADR RES_REMAINDER_RULE_SET
,HzCustomerProfileFE0.CREDIT_CLASSIFICATION RES_CREDIT_CLASSIFICATION
,HzCustomerProfileFE0.CONS_BILL_LEVEL RES_BILL_LEVEL
,HzCustomerProfileFE0.LATE_CHARGE_CALCULATION_TRX RES_LATE_CHARGE_CALCULATION_ME
,HzCustomerProfileFE0.CREDIT_ITEMS_FLAG RES_CREDIT_ITEMS_INDICATOR_FOR
,HzCustomerProfileFE0.DISPUTED_TRANSACTIONS_FLAG RES_DISPUTED_TRANSACTION_INDIC
,HzCustomerProfileFE0.LATE_CHARGE_TYPE RES_LATE_CHARGE_TYPE
,HzCustomerProfileFE0.INTEREST_CALCULATION_PERIOD RES_INTEREST_CALCULATION_PERIO
,HzCustomerProfileFE0.HOLD_CHARGED_INVOICES_FLAG RES_ASSESS_LATE_CHARGES_ONCE
,HzCustomerProfileFE0.MULTIPLE_INTEREST_RATES_FLAG RES_USE_MULTIPLE_INTEREST_RATE
,TO_CHAR(HzCustomerProfileFE0.CHARGE_BEGIN_DATE,'YYYY/MM/DD') RES_CHARGE_START_DATE
,HzCustProfileAmtsFE0.EXCHANGE_RATE_TYPE RES_CONVERSION_RATE_TYPE
,HzCustProfileAmtsFE0.MIN_FC_INVOICE_OVERDUE_TYPE RES_MINIMUM_INVOICE_BALANCE_30
,HzCustProfileAmtsFE0.MIN_FC_INVOICE_PERCENT RES_MINIMUM_INVOICE_BALANCE_31
,HzCustProfileAmtsFE0.MIN_FC_BALANCE_OVERDUE_TYPE RES_MINIMUM_CUSTOMER_BALANC_32
,HzCustProfileAmtsFE0.MIN_FC_BALANCE_PERCENT RES_MINIMUM_CUSTOMER_BALANC_33
,HzCustProfileAmtsFE0.INTEREST_TYPE RES_INTEREST_CHARGE_TYPE
,HzCustProfileAmtsFE0.INTEREST_FIXED_AMOUNT RES_INTEREST_CHARGE_AMOUNT -- Interest Charge Amount
,HzCustProfileAmtsFE0.PENALTY_TYPE RES_PENALTY_CHARGE_TYPE
,HzCustProfileAmtsFE0.PENALTY_RATE RES_PENALTY_CHARGE_RATE
,HzCustProfileAmtsFE0.MIN_INTEREST_CHARGE RES_MINIMUM_LATE_CHARGE_PER_IN
,HzCustProfileAmtsFE0.PENALTY_FIXED_AMOUNT RES_PENALTY_CHARGE_AMOUNT -- Penalty Charge Amount
,HzCustomerProfileFE0.AUTOMATCH_RULE_ID RES_AUTOMATCH_RULE_SET
,HzCustomerProfileFE0.MATCH_BY_AUTOUPDATE_FLAG RES_AUTOMATICALLY_UPDATE_RECEI
,HzCustomerProfileFE0.PRINTING_OPTION_CODE RES_GENERATE_BILL
,HzCustomerProfileFE0.PREF_CONTACT_METHOD RES_PREFERRED_DELIVERY_METHOD
,HzCustomerProfileFE0.STMT_DELIVERY_METHOD RES_STATEMENT_PREFERRED_DELIVE
,HzCustomerProfileFE0.XML_INV_FLAG RES_XML_INVOICING_FOR_INVOICE
,HzCustomerProfileFE0.XML_DM_FLAG RES_XML_INVOICING_FOR_DEBIT_ME
,HzCustomerProfileFE0.XML_CB_FLAG RES_XML_INVOICING_FOR_CHARGEBA
,HzCustomerProfileFE0.XML_CM_FLAG RES_XML_INVOICING_FOR_CREDIT_M
,raCustproFILE0.CMK_CONFIG_FLAG RES_ENABLE_COLLABORATION_MESSA
,raCustproFILE0.SERVICE_PROVIDER_NAME RES_SERVICE_PROVIDER_NAME
,raCustproFILE0.PARTNER_ID RES_TRADING_PARTNER_ID
,raCustproFILE0.PARTNER_ID_TYPE_CODE RES_TRADING_PARTNER_ID_TYPE
,raCustproFILE0.AR_OUTBOUND_TRANSACTION_FLAG RES_RECEIVABLES_OUTBOUND_XML_T
,raCustproFILE0.AR_INBOUND_CONFIRM_BOD_FLAG RES_RECEIVABLES_INBOUND_CONFIR
,HzCustAccountsE0.ACCOUNT_NUMBER RES_ACCOUNT_NUMBER
,HzPartiesE0.PARTY_NUMBER RES_PARTY_NUMBER
,HzCustomerProfileFE0.PREF_CONTACT_METHOD RES_PREFERRED_CONTACT_METHOD
,(SELECT SCHEDULE_NAME FROM ar_charge_schedules WHERE SCHEDULE_ID = HzCustProfileAmtsFE0.INTEREST_SCHEDULE_ID) RES_INTEREST_CHARGE_SCHEDULE_I
,(SELECT SCHEDULE_NAME FROM ar_charge_schedules WHERE SCHEDULE_ID = HzCustProfileAmtsFE0.PENALTY_SCHEDULE_ID) RES_PENALTY_CHARGE_SCHEDULE_ID
,HzCustomerProfileFE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,HzCustomerProfileFE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,HzCustomerProfileFE0.CREATED_BY RSC_CREATED_BY
,HzCustomerProfileFE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM HZ_PARTIES HzPartiesE0
,HZ_PARTY_USG_ASSIGNMENTS HzPartyUsgAssignmentsE0
--,HZ_PARTY_SITES HzPartySitesE0
,HZ_CUST_ACCOUNTS HzCustAccountsE0
,(SELECT * 
	FROM HZ_CUSTOMER_PROFILES_F
	WHERE SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
	) HzCustomerProfileFE0
,HZ_CUST_PROFILE_CLASSES HzCustProfileClassesE0
,AR_COLLECTORS ArCollectorsE0
,HZ_CUST_PROFILE_AMTS_F HzCustProfileAmtsFE0
,RA_CUSTOMER_PROFILES_INT_ALL raCustproFILE0
WHERE HzPartiesE0.PARTY_ID = HzPartyUsgAssignmentsE0.PARTY_ID
AND HzPartyUsgAssignmentsE0.PARTY_USAGE_CODE = 'CUSTOMER'
AND HzPartiesE0.PARTY_ID = HzCustAccountsE0.PARTY_ID
AND HzCustAccountsE0.CUST_ACCOUNT_ID = HzCustomerProfileFE0.CUST_ACCOUNT_ID
AND HzCustomerProfileFE0.SITE_USE_ID IS NULL
AND HzCustomerProfileFE0.PROFILE_CLASS_ID = HzCustProfileClassesE0.PROFILE_CLASS_ID
AND HzCustomerProfileFE0.COLLECTOR_ID = ArCollectorsE0.COLLECTOR_ID
AND HzCustomerProfileFE0.CUST_ACCOUNT_PROFILE_ID = HzCustProfileAmtsFE0.CUST_ACCOUNT_PROFILE_ID(+)
AND HzCustAccountsE0.ORIG_SYSTEM_REFERENCE = raCustproFILE0.CUST_ORIG_SYSTEM_REFERENCE(+)


UNION
--Account Site level
SELECT '' RES_BATCH_IDENTIFIER
,'I' RES_INSERT_UPDATE_INDICATOR
,'CUSTOMER' RES_PARTY_ORIGINAL_SYSTEM
,HzPartiesE0.PARTY_NUMBER RES_PARTY_ORIGINAL_SYSTEM_REFE
,'CUSTOMER' RES_CUSTOMER_ACCOUNT_SOURCE_SY
,HzCustAccountsE0.ACCOUNT_NUMBER RES_CUSTOMER_ACCOUNT_SOURCE__0
,'CUSTOMER' RES_ACCOUNT_SITE_SOURCE_SYSTEM
,HzPartySitesE0.PARTY_SITE_NUMBER RES_ACCOUNT_SITE_SOURCE_SYST_1
,HzCustProfileClassesE0.NAME RES_CUSTOMER_PROFILE_CLASS
,ArCollectorsE0.NAME RES_COLLECTOR_NAME
,(SELECT DISPLAY_NAME FROM PER_PERSON_NAMES_F WHERE PERSON_ID = HzCustomerProfileFE0.CREDIT_ANALYST_ID
	AND NAME_TYPE = 'GLOBAL') RES_CREDIT_ANALYST
,HzCustomerProfileFE0.CREDIT_REVIEW_CYCLE RES_CREDIT_REVIEW_CYCLE
,TO_CHAR(HzCustomerProfileFE0.LAST_CREDIT_REVIEW_DATE,'YYYY/MM/DD') RES_LAST_REVIEW_DATE
,TO_CHAR(HzCustomerProfileFE0.NEXT_CREDIT_REVIEW_DATE,'YYYY/MM/DD') RES_NEXT_REVIEW_DATE
,HzCustomerProfileFE0.CREDIT_BALANCE_STATEMENTS RES_SEND_CREDIT_BALANCE
,HzCustomerProfileFE0.CREDIT_CHECKING RES_INCLUDE_IN_CREDIT_CHECK
,HzCustomerProfileFE0.CREDIT_HOLD RES_CREDIT_HOLD
,HzCustomerProfileFE0.DISCOUNT_TERMS RES_ALLOW_DISCOUNT
,HzCustomerProfileFE0.DUNNING_LETTERS RES_SEND_DUNNING_LETTERS
,HzCustomerProfileFE0.INTEREST_CHARGES RES_ENABLE_LATE_CHARGES
,HzCustomerProfileFE0.SEND_STATEMENTS RES_SEND_STATEMENT
,HzCustomerProfileFE0.TOLERANCE RES_TOLERANCE
,HzCustomerProfileFE0.TAX_PRINTING_OPTION RES_TAX_PRINTING_OPTION
,HzCustomerProfileFE0.ACCOUNT_STATUS RES_ACCOUNT_STATUS
,HzCustomerProfileFE0.AUTOCASH_HIERARCHY_ID RES_AUTOCASH_RULE_SET
,HzCustomerProfileFE0.CREDIT_RATING RES_CREDIT_RATING
,HzCustomerProfileFE0.DISCOUNT_GRACE_DAYS RES_DISCOUNT_GRACE_DAYS
,HzCustomerProfileFE0.INTEREST_PERIOD_DAYS RES_INTEREST_DAYS_PERIOD
,HzCustomerProfileFE0.OVERRIDE_TERMS RES_OVERRIDE_TERMS
,HzCustomerProfileFE0.PAYMENT_GRACE_DAYS RES_RECEIPT_GRACE_DAYS
,HzCustomerProfileFE0.PERCENT_COLLECTABLE RES_COLLECTIBLE
,HzCustomerProfileFE0.RISK_CODE RES_RISK_CODE
,(SELECT NAME
	FROM RA_TERMS_TL
	WHERE TERM_ID = HzCustomerProfileFE0.STANDARD_TERMS
	AND LANGUAGE = USERENV('LANG')
	) RES_PAYMENT_TERMS
,(SELECT NAME
	FROM AR_STATEMENT_CYCLES
	WHERE STATEMENT_CYCLE_ID = HzCustomerProfileFE0.STATEMENT_CYCLE_ID 
	) RES_STATEMENT_CYCLE
,HzCustomerProfileFE0.CHARGE_ON_FINANCE_CHARGE_FLAG RES_INTEREST_CALCULATION_FORMU
,(SELECT NAME
	FROM RA_GROUPING_RULES
	WHERE GROUPING_RULE_ID = HzCustomerProfileFE0.GROUPING_RULE_ID
	) RES_GROUPING_RULE
,HzCustProfileAmtsFE0.CURRENCY_CODE RES_CURRENCY
,HzCustProfileAmtsFE0.AUTO_REC_MIN_RECEIPT_AMOUNT RES_MINIMUM_RECEIPT_AMOUNT
,HzCustProfileAmtsFE0.INTEREST_RATE RES_INTEREST_CHARGE_RATE
,HzCustProfileAmtsFE0.MAX_INTEREST_CHARGE RES_MAXIMUM_LATE_CHARGE_PER_IN
,HzCustProfileAmtsFE0.MIN_DUNNING_AMOUNT RES_MINIMUM_DUNNING_AMOUNT
,HzCustProfileAmtsFE0.MIN_DUNNING_INVOICE_AMOUNT RES_MINIMUM_DUNNING_INVOICE_AM
,HzCustProfileAmtsFE0.MIN_FC_BALANCE_AMOUNT RES_MINIMUM_CUSTOMER_BALANCE_O
,HzCustProfileAmtsFE0.MIN_FC_INVOICE_AMOUNT RES_MINIMUM_INVOICE_BALANCE_OV
,HzCustProfileAmtsFE0.MIN_STATEMENT_AMOUNT RES_MINIMUM_STATEMENT_AMOUNT
,HzCustProfileAmtsFE0.TRX_CREDIT_LIMIT RES_CREDIT_LIMIT
,HzCustProfileAmtsFE0.OVERALL_CREDIT_LIMIT RES_ORDER_CREDIT_LIMIT
,HzCustomerProfileFE0.ATTRIBUTE_CATEGORY RES_USER_DEFINED_CONTEXT_PROMP
,HzCustomerProfileFE0.ATTRIBUTE1 RES_DESCRIPTIVE_FLEXFIELD_SEGM
,HzCustomerProfileFE0.ATTRIBUTE2 RES_DESCRIPTIVE_FLEXFIELD_SE_2
,HzCustomerProfileFE0.ATTRIBUTE3 RES_DESCRIPTIVE_FLEXFIELD_SE_3
,HzCustomerProfileFE0.ATTRIBUTE4 RES_DESCRIPTIVE_FLEXFIELD_SE_4
,HzCustomerProfileFE0.ATTRIBUTE5 RES_DESCRIPTIVE_FLEXFIELD_SE_5
,HzCustomerProfileFE0.ATTRIBUTE6 RES_DESCRIPTIVE_FLEXFIELD_SE_6
,HzCustomerProfileFE0.ATTRIBUTE7 RES_DESCRIPTIVE_FLEXFIELD_SE_7
,HzCustomerProfileFE0.ATTRIBUTE8 RES_DESCRIPTIVE_FLEXFIELD_SE_8
,HzCustomerProfileFE0.ATTRIBUTE9 RES_DESCRIPTIVE_FLEXFIELD_SE_9
,HzCustomerProfileFE0.ATTRIBUTE10 RES_DESCRIPTIVE_FLEXFIELD_S_10
,HzCustomerProfileFE0.ATTRIBUTE11 RES_DESCRIPTIVE_FLEXFIELD_S_11
,HzCustomerProfileFE0.ATTRIBUTE12 RES_DESCRIPTIVE_FLEXFIELD_S_12
,HzCustomerProfileFE0.ATTRIBUTE13 RES_DESCRIPTIVE_FLEXFIELD_S_13
,HzCustomerProfileFE0.ATTRIBUTE14 RES_DESCRIPTIVE_FLEXFIELD_S_14
,HzCustomerProfileFE0.ATTRIBUTE15 RES_DESCRIPTIVE_FLEXFIELD_S_15
,HzCustProfileAmtsFE0.ATTRIBUTE_CATEGORY RES_USER_DEFINED_AMOUNT_CONTEX
,HzCustProfileAmtsFE0.ATTRIBUTE1 RES_DESCRIPTIVE_FLEXFIELD_AMOU
,HzCustProfileAmtsFE0.ATTRIBUTE2 RES_DESCRIPTIVE_FLEXFIELD_A_16
,HzCustProfileAmtsFE0.ATTRIBUTE3 RES_DESCRIPTIVE_FLEXFIELD_A_17
,HzCustProfileAmtsFE0.ATTRIBUTE4 RES_DESCRIPTIVE_FLEXFIELD_A_18
,HzCustProfileAmtsFE0.ATTRIBUTE5 RES_DESCRIPTIVE_FLEXFIELD_A_19
,HzCustProfileAmtsFE0.ATTRIBUTE6 RES_DESCRIPTIVE_FLEXFIELD_A_20
,HzCustProfileAmtsFE0.ATTRIBUTE7 RES_DESCRIPTIVE_FLEXFIELD_A_21
,HzCustProfileAmtsFE0.ATTRIBUTE8 RES_DESCRIPTIVE_FLEXFIELD_A_22
,HzCustProfileAmtsFE0.ATTRIBUTE9 RES_DESCRIPTIVE_FLEXFIELD_A_23
,HzCustProfileAmtsFE0.ATTRIBUTE10 RES_DESCRIPTIVE_FLEXFIELD_A_24
,HzCustProfileAmtsFE0.ATTRIBUTE11 RES_DESCRIPTIVE_FLEXFIELD_A_25
,HzCustProfileAmtsFE0.ATTRIBUTE12 RES_DESCRIPTIVE_FLEXFIELD_A_26
,HzCustProfileAmtsFE0.ATTRIBUTE13 RES_DESCRIPTIVE_FLEXFIELD_A_27
,HzCustProfileAmtsFE0.ATTRIBUTE14 RES_DESCRIPTIVE_FLEXFIELD_A_28
,HzCustProfileAmtsFE0.ATTRIBUTE15 RES_DESCRIPTIVE_FLEXFIELD_A_29
/*,'CUSTOMER' RES_PARTY_SOURCE_SYSTEM
,HzPartiesE0.PARTY_NUMBER RES_PARTY_SOURCE_SYSTEM_REFERE*/
,HzCustomerProfileFE0.AUTO_REC_INCL_DISPUTED_FLAG RES_AUTORECEIPTS_INCLUDE_DISPU
,HzCustomerProfileFE0.CLEARING_DAYS RES_RECEIPT_CLEARING_DAYS
,buE0.BU_NAME RES_ORGANIZATION_ID
,HzCustomerProfileFE0.CONS_INV_FLAG RES_ENABLE_BALANCE_FORWARD_BIL
,HzCustomerProfileFE0.CONS_INV_TYPE RES_BILL_TYPE
,HzCustomerProfileFE0.LOCKBOX_MATCHING_OPTION RES_MATCH_RECEIPTS_BY
,HzCustomerProfileFE0.AUTOCASH_HIERARCHY_ID_FOR_ADR RES_REMAINDER_RULE_SET
,HzCustomerProfileFE0.CREDIT_CLASSIFICATION RES_CREDIT_CLASSIFICATION
,HzCustomerProfileFE0.CONS_BILL_LEVEL RES_BILL_LEVEL
,HzCustomerProfileFE0.LATE_CHARGE_CALCULATION_TRX RES_LATE_CHARGE_CALCULATION_ME
,HzCustomerProfileFE0.CREDIT_ITEMS_FLAG RES_CREDIT_ITEMS_INDICATOR_FOR
,HzCustomerProfileFE0.DISPUTED_TRANSACTIONS_FLAG RES_DISPUTED_TRANSACTION_INDIC
,HzCustomerProfileFE0.LATE_CHARGE_TYPE RES_LATE_CHARGE_TYPE
,HzCustomerProfileFE0.INTEREST_CALCULATION_PERIOD RES_INTEREST_CALCULATION_PERIO
,HzCustomerProfileFE0.HOLD_CHARGED_INVOICES_FLAG RES_ASSESS_LATE_CHARGES_ONCE
,HzCustomerProfileFE0.MULTIPLE_INTEREST_RATES_FLAG RES_USE_MULTIPLE_INTEREST_RATE
,TO_CHAR(HzCustomerProfileFE0.CHARGE_BEGIN_DATE,'YYYY/MM/DD') RES_CHARGE_START_DATE
,HzCustProfileAmtsFE0.EXCHANGE_RATE_TYPE RES_CONVERSION_RATE_TYPE
,HzCustProfileAmtsFE0.MIN_FC_INVOICE_OVERDUE_TYPE RES_MINIMUM_INVOICE_BALANCE_30
,HzCustProfileAmtsFE0.MIN_FC_INVOICE_PERCENT RES_MINIMUM_INVOICE_BALANCE_31
,HzCustProfileAmtsFE0.MIN_FC_BALANCE_OVERDUE_TYPE RES_MINIMUM_CUSTOMER_BALANC_32
,HzCustProfileAmtsFE0.MIN_FC_BALANCE_PERCENT RES_MINIMUM_CUSTOMER_BALANC_33
,HzCustProfileAmtsFE0.INTEREST_TYPE RES_INTEREST_CHARGE_TYPE
,HzCustProfileAmtsFE0.INTEREST_FIXED_AMOUNT RES_INTEREST_CHARGE_AMOUNT -- Interest Charge Amount
,HzCustProfileAmtsFE0.PENALTY_TYPE RES_PENALTY_CHARGE_TYPE
,HzCustProfileAmtsFE0.PENALTY_RATE RES_PENALTY_CHARGE_RATE
,HzCustProfileAmtsFE0.MIN_INTEREST_CHARGE RES_MINIMUM_LATE_CHARGE_PER_IN
,HzCustProfileAmtsFE0.PENALTY_FIXED_AMOUNT RES_PENALTY_CHARGE_AMOUNT -- Penalty Charge Amount
,HzCustomerProfileFE0.AUTOMATCH_RULE_ID RES_AUTOMATCH_RULE_SET
,HzCustomerProfileFE0.MATCH_BY_AUTOUPDATE_FLAG RES_AUTOMATICALLY_UPDATE_RECEI
,HzCustomerProfileFE0.PRINTING_OPTION_CODE RES_GENERATE_BILL
,HzCustomerProfileFE0.PREF_CONTACT_METHOD RES_PREFERRED_DELIVERY_METHOD
,HzCustomerProfileFE0.STMT_DELIVERY_METHOD RES_STATEMENT_PREFERRED_DELIVE
,HzCustomerProfileFE0.XML_INV_FLAG RES_XML_INVOICING_FOR_INVOICE
,HzCustomerProfileFE0.XML_DM_FLAG RES_XML_INVOICING_FOR_DEBIT_ME
,HzCustomerProfileFE0.XML_CB_FLAG RES_XML_INVOICING_FOR_CHARGEBA
,HzCustomerProfileFE0.XML_CM_FLAG RES_XML_INVOICING_FOR_CREDIT_M
,raCustproFILE0.CMK_CONFIG_FLAG RES_ENABLE_COLLABORATION_MESSA
,raCustproFILE0.SERVICE_PROVIDER_NAME RES_SERVICE_PROVIDER_NAME
,raCustproFILE0.PARTNER_ID RES_TRADING_PARTNER_ID
,raCustproFILE0.PARTNER_ID_TYPE_CODE RES_TRADING_PARTNER_ID_TYPE
,raCustproFILE0.AR_OUTBOUND_TRANSACTION_FLAG RES_RECEIVABLES_OUTBOUND_XML_T
,raCustproFILE0.AR_INBOUND_CONFIRM_BOD_FLAG RES_RECEIVABLES_INBOUND_CONFIR
,HzCustAccountsE0.ACCOUNT_NUMBER RES_ACCOUNT_NUMBER
,HzPartiesE0.PARTY_NUMBER RES_PARTY_NUMBER
,HzCustomerProfileFE0.PREF_CONTACT_METHOD RES_PREFERRED_CONTACT_METHOD
,(SELECT SCHEDULE_NAME FROM ar_charge_schedules WHERE SCHEDULE_ID = HzCustProfileAmtsFE0.INTEREST_SCHEDULE_ID) RES_INTEREST_CHARGE_SCHEDULE_I
,(SELECT SCHEDULE_NAME FROM ar_charge_schedules WHERE SCHEDULE_ID = HzCustProfileAmtsFE0.PENALTY_SCHEDULE_ID) RES_PENALTY_CHARGE_SCHEDULE_ID
,HzCustomerProfileFE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,HzCustomerProfileFE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,HzCustomerProfileFE0.CREATED_BY RSC_CREATED_BY
,HzCustomerProfileFE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,buE0.BU_ID RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM HZ_PARTIES HzPartiesE0
,HZ_PARTY_USG_ASSIGNMENTS HzPartyUsgAssignmentsE0
,HZ_PARTY_SITES HzPartySitesE0
,HZ_CUST_ACCOUNTS HzCustAccountsE0
,(SELECT * 
	FROM HZ_CUSTOMER_PROFILES_F
	WHERE SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
	) HzCustomerProfileFE0
,HZ_CUST_PROFILE_CLASSES HzCustProfileClassesE0
,AR_COLLECTORS ArCollectorsE0
,HZ_CUST_PROFILE_AMTS_F HzCustProfileAmtsFE0
,HZ_CUST_ACCT_SITES_ALL HzCustAcctSitesAllE0
,HZ_CUST_SITE_USES_ALL HzCustSiteUsesAllE0
,RA_CUSTOMER_PROFILES_INT_ALL raCustproFILE0
,FUN_ALL_BUSINESS_UNITS_V buE0
WHERE HzPartiesE0.PARTY_ID = HzPartyUsgAssignmentsE0.PARTY_ID
AND HzPartyUsgAssignmentsE0.PARTY_USAGE_CODE = 'CUSTOMER'
AND HzPartiesE0.PARTY_ID = HzCustAccountsE0.PARTY_ID
AND HzCustAccountsE0.CUST_ACCOUNT_ID = HzCustomerProfileFE0.CUST_ACCOUNT_ID
AND HzCustomerProfileFE0.SITE_USE_ID = HzCustSiteUsesAllE0.SITE_USE_ID
AND HzCustomerProfileFE0.PROFILE_CLASS_ID = HzCustProfileClassesE0.PROFILE_CLASS_ID
AND HzCustomerProfileFE0.COLLECTOR_ID = ArCollectorsE0.COLLECTOR_ID
AND HzPartiesE0.PARTY_ID = HzPartySitesE0.PARTY_ID
AND HzPartySitesE0.PARTY_SITE_ID = HzCustAcctSitesAllE0.PARTY_SITE_ID
AND HzCustAccountsE0.CUST_ACCOUNT_ID = HzCustAcctSitesAllE0.CUST_ACCOUNT_ID
AND HzCustAcctSitesAllE0.CUST_ACCT_SITE_ID = HzCustSiteUsesAllE0.CUST_ACCT_SITE_ID
AND HzCustomerProfileFE0.CUST_ACCOUNT_PROFILE_ID = HzCustProfileAmtsFE0.CUST_ACCOUNT_PROFILE_ID(+)
AND HzCustAcctSitesAllE0.SET_ID = buE0.DEFAULT_SET_ID(+)
AND HzCustAcctSitesAllE0.ORIG_SYSTEM_REFERENCE = raCustproFILE0.CUST_SITE_ORIG_SYS_REF(+)

