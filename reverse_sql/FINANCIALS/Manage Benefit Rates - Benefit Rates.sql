/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Benefit%20Rates%20-%20Benefit%20Rates.sql $:
 * $Id: Manage Benefit Rates - Benefit Rates.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
--RSC_PREREQUISITE_OBJECTS=BEN_TYPES 
 
SELECT (CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') = 'IMP' THEN
        'Create Imputed Rate'
    ELSE
        (CASE
            WHEN benRatesE0.ALWS_RLVR_CRS_FLAG = 'Y' THEN
                'Create Rollover Rate'
            ELSE
                'Create Standard Rate'
            END)
    END) RES_RATE_TYPE
,TO_CHAR(benRatesE0.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,DECODE(TO_CHAR(benRatesE0.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(benRatesE0.EFFECTIVE_END_DATE,'DD-Mon-YYYY')) RES_EFFECTIVE_END_DATE
,benRatesE0.NAME RES_RATE_NAME
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        benPlansE0.NAME
    END) RES_PLAN_NAME
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') = 'IMP' THEN
        benPlansE0.NAME
    END) RES_IMPUTED_SHELL_PLAN
,(SELECT NAME
    FROM BEN_OPT_F
    WHERE SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
    AND OPT_ID = benRatesE0.CONTEXT_OPT_ID
    ) RES_OPTION
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (SELECT NAME
            FROM BEN_PGM_F
            WHERE SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
            AND PGM_ID = benRatesE0.CONTEXT_PGM_ID)
    END) RES_RESTRICT_RATE_ON_PROGRAM
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_STAT'
    AND LOOKUP_CODE = benRatesE0.ACTY_BASE_RT_STAT_CD
    ) RES_STATUS
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_USG'
    AND LOOKUP_CODE = benRatesE0.RT_USG_CD
    ) RES_RATE_USAGE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'ORA_BEN_RT_LVL'
    AND LOOKUP_CODE = benRatesE0.CONFIG_CHAR_2
    ) RES_RATE_LEVEL
    
    
,'' RES_DEFINED_RATE_FREQUENCY
,'' RES_COMMUNICATED_RATE_FREQUENC


,(SELECT NAME
    FROM HR_ORGANIZATION_UNITS
    WHERE SYSDATE BETWEEN DATE_FROM AND DATE_TO
    AND ORGANIZATION_ID = benRatesE0.LEGAL_ENTITY_ID
    ) RES_LEGAL_EMPLOYER
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_RATE_DISPLAY_CD'
             AND LOOKUP_CODE = benRatesE0.RATE_DISPLAY_CD)
    END) RES_RATE_DISPLAY_TYPE
    
    
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND benRatesE0.ALWS_RLVR_CRS_FLAG = 'Y' THEN
        ''
    END) RES_RATE_FOR_LIMITS_ENFORCEMEN


,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND benRatesE0.ALWS_RLVR_CRS_FLAG = 'Y' THEN
        DECODE(benRatesE0.ALWS_RLVR_CRS_FLAG,'Y','Yes','N','No')
    END) RES_ALLOW_ROLLOVER_OF_FLEX_CRE
,benRatesE0.CONFIG_CHAR_3 RES_SHORT_NAME
,benRatesE0.CONFIG_CHAR_4 RES_SHORT_CODE


--Payroll Information

,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ACTY_TYP'
    AND LOOKUP_CODE = benRatesE0.ACTY_TYP_CD
    ) RES_ACTIVITY_TYPE
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_NNMNTRY_UOM'
             AND LOOKUP_CODE = benRatesE0.NNMNTRY_UOM)
    END) RES_UNIT_OF_MEASURE
,DECODE(benRatesE0.ELE_RQD_FLAG,'Y','Yes','N','No') RES_ELEMENT_AND_INPUT_VALUES_R -- Element and input values required
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        DECODE(benRatesE0.ASN_ON_ENRT_FLAG,'Y','Yes','N','No')
    END) RES_ASSIGN_ON_ENROLLMENT
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        DECODE(benRatesE0.DSPLY_ON_ENRT_FLAG,'Y','Yes','N','No')
    END) RES_DISPLAY_ON_ENROLLMENT
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') = 'IMP' THEN
        DECODE(benRatesE0.USE_CALC_ACTY_BS_RT_FLAG,'Y','Yes','N','No')
    END) RES_ENABLE_CALCULATE_FOR_ENROL
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        DECODE(benRatesE0.USES_VARBL_RT_FLAG,'Y','Yes','N','No')
    END) RES_USES_VARIABLE_RATE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_TX_TYP'
    AND LOOKUP_CODE = benRatesE0.TX_TYP_CD
    ) RES_TAX_TYPE_CODE
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_PRNT_CHLD'
             AND LOOKUP_CODE = benRatesE0.PARNT_CHLD_CD)
    END) RES_PARENT_OR_CHILD_RATE_TYPE
,(SELECT ELEMENT_NAME
    FROM PAY_ELEMENT_TYPES_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND ELEMENT_TYPE_ID = benRatesE0.ELEMENT_TYPE_ID
    ) RES_PAYROLL_ELEMENT
,(SELECT NAME
    FROM PAY_INPUT_VALUES_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND INPUT_VALUE_ID = benRatesE0.INPUT_VALUE_ID
    ) RES_ELEMENT_INPUT_VALUE
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (SELECT FORMULA_NAME
             FROM FF_FORMULAS_VL
             WHERE benRatesE0.EFFECTIVE_END_DATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
			 AND FORMULA_ID = benRatesE0.INPUT_VA_CALC_RL)
    END) RES_EXTRA_INPUT_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ELE_ENTRY_VAL'
    AND LOOKUP_CODE = benRatesE0.ELE_ENTRY_VAL_CD
    ) RES_VALUE_PASSED_TO_PAYROLL


--Additional Information - Calculation

,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_MLT'
             AND LOOKUP_CODE = benRatesE0.RT_MLT_CD)
    END) RES_CALCULATION_METHOD
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        DECODE(benRatesE0.USE_CALC_ACTY_BS_RT_FLAG,'Y','Yes','N','No')
    END) RES_CALCULATE_FOR_ENROLLMENT

,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'FLFX' THEN
        DECODE(benRatesE0.ENTR_VAL_AT_ENRT_FLAG,'Y','Yes','N','No')
    END) RES_PARTICIPANTS_ENTER_VALUE_D
,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'FLFX' THEN
        DECODE(benRatesE0.ENTR_ANN_VAL_FLAG,'Y','Yes','N','No')
    END) RES_PARTICIPANTS_ENTER_ANNUAL_
	
--Additional Information - Calculation - Multiplier
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CVG','CLANDCVG','PRNT','PRNTANDCVG','CL') THEN
        benRatesE0.VAL
    END) RES_MULTIPLIER

--Additional Information - Calculation - Multiple of Compensation
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CL') THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_BNFT_RT_TYP'
             AND LOOKUP_CODE = benRatesE0.BNFT_RT_TYP_CD)
    END) RES_OPERATOR
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CL') THEN
        (SELECT NAME
             FROM BEN_COMP_LVL_FCTR
             WHERE COMP_LVL_FCTR_ID = benRatesE0.COMP_LVL_FCTR_ID)
    END) RES_COMPENSATION_FACTOR

--Additional Information - Calculation - Multiple of Coverage
/*,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CVG','PRNTANDCVG') THEN
        ''
    END) "Coverage Name"*/
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CVG','PRNTANDCVG') THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_BNFT_RT_TYP'
             AND LOOKUP_CODE = benRatesE0.BNFT_RT_TYP_CD)
    END) RES_COVERAGE_NAME_OPERATOR

--Additional Information - Calculation - Rounding Rule
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CVG','PRNT','PRNTANDCVG','CL') THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_RNDG'
             AND LOOKUP_CODE = benRatesE0.RNDG_CD)
    END) RES_ROUNDING_RULE
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CVG','PRNT','PRNTANDCVG','CL') THEN
        (SELECT FORMULA_NAME
             FROM FF_FORMULAS_VL
             WHERE FORMULA_ID = benRatesE0.RNDG_RL)
    END) RES_ROUNDING_FORMULA


--Additional Information - Calculation - Amount
,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'FLFX' THEN
        benRatesE0.VAL
    END) RES_VALUE
	
--Additional Information - Calculation - Parent Rate
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('PRNT','PRNTANDCVG') THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_MLT'
             AND LOOKUP_CODE = benRatesE0.RT_TYP_CD)
    END) RES_PARENT_RATE_OPERATOR
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('PRNT','PRNTANDCVG') THEN
        (SELECT NAME
            FROM BEN_ACTY_BASE_RT_F
            WHERE SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
            AND ACTY_BASE_RT_ID = benRatesE0.PARNT_ACTY_BASE_RT_ID)
    END) RES_PARENT_RATE_NAME

,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'RL' THEN
        (SELECT FORMULA_NAME
             FROM FF_FORMULAS_VL
             WHERE FORMULA_ID = benRatesE0.VAL_CALC_RL) -- Calculate for enrollment formula
    END) RES_VALUE_FORMULA

,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'ORA_USRVALS' THEN
        (SELECT NAME
            FROM BEN_TYPES
            WHERE SYSDATE BETWEEN START_DATE AND END_DATE
            AND TYPE_ID = benRatesE0.CONFIG_ID_2)
    END) RES_USER_VALUE_NAME


--Additional Information - Calculation - Formula
,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'ERL' THEN
        (SELECT FORMULA_NAME
             FROM FF_FORMULAS_VL
             WHERE FORMULA_ID = benRatesE0.VAL_CALC_RL) -- Post enrollment calculation formula
    END) RES_POST_ENROLLMENT_CALCULATIO
    
--Additional Information - Calculation - Limits
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CVG','PRNT','PRNTANDCVG','CL','RL','ERL') THEN
        benRatesE0.LWR_LMT_VAL
    END) RES_LOW_LIMIT_VALUE
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CVG','PRNT','PRNTANDCVG','CL','RL','ERL') THEN
        (SELECT FORMULA_NAME
             FROM FF_FORMULAS_VL
             WHERE FORMULA_ID = benRatesE0.LWR_LMT_CALC_RL)
    END) RES_LOW_LIMIT_VALUE_FORMULA
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CVG','PRNT','PRNTANDCVG','CL','RL','ERL') THEN
        benRatesE0.UPR_LMT_VAL
    END) RES_HIGH_LIMIT_VALUE
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CVG','PRNT','PRNTANDCVG','CL','RL','ERL') THEN
        (SELECT FORMULA_NAME
             FROM FF_FORMULAS_VL
             WHERE FORMULA_ID = benRatesE0.UPR_LMT_CALC_RL)
    END) RES_HIGH_LIMIT_VALUE_FORMULA

/*
--Additional Information - Calculation - Annual Values
,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'FLFX' THEN
        benRatesE0.ANN_MN_ELCN_VAL
    END) "Annual Minimum Election Value"
,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'FLFX' THEN
        benRatesE0.INCRMT_ELCN_VAL
    END) "Increment"
,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'FLFX' THEN
        benRatesE0.ANN_MX_ELCN_VAL
    END) "Annual Maximum Election Value"
,(CASE
    WHEN benRatesE0.RT_MLT_CD = 'FLFX' THEN
        benRatesE0.DFLT_VAL
    END) "Default Value"











--Additional Information - Calculation - Compensation Factor Details
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CL') THEN
        ''
    END) "Determination Rule"
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CL') THEN
        ''
    END) "Greater than or Equal to Compensation"
,(CASE
    WHEN benRatesE0.RT_MLT_CD IN ('CLANDCVG','CL') THEN
        ''
    END) "Less Than Compensation"
*/


--Payment Schedule

,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_PROCG_SRC'
    AND LOOKUP_CODE = benRatesE0.PROCG_SRC_CD
    ) RES_PROCESSING_SOURCE
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') = 'IMP' THEN
        DECODE(benRatesE0.PROC_EACH_PP_DFLT_FLAG,'Y','Yes','N','No')
    END) RES_PROCESS_EACH_PAY_PERIOD_BY
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') = 'IMP' THEN
        DECODE(benRatesE0.USES_PYMT_SCHED_FLAG,'Y','Yes','N','No')
    END) RES_USE_PAYMENT_SCHEDULE
    
/*
,(CASE
    WHEN benRatesE0.USES_PYMT_SCHED_FLAG = 'Y' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_PYMT_SCHED'
             AND LOOKUP_CODE = paymentSchedulsE0.PYMT_SCHED_CD)
     END) "Payment Schedule"
,(CASE
    WHEN benRatesE0.USES_PYMT_SCHED_FLAG = 'Y' THEN
        (SELECT FORMULA_NAME
             FROM FF_FORMULAS_VL
             WHERE FORMULA_ID = paymentSchedulsE0.PYMT_SCHED_RL)
     END) "Payment Formula"
,(CASE
    WHEN benRatesE0.USES_PYMT_SCHED_FLAG = 'Y' THEN
        TO_CHAR(paymentSchedulsE0.EFFECTIVE_START_DATE,'DD-Mon-YYYY')
     END) "Payment Schedule - Effective Start Date"
,(CASE
    WHEN benRatesE0.USES_PYMT_SCHED_FLAG = 'Y' THEN
        DECODE(TO_CHAR(paymentSchedulsE0.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(paymentSchedulsE0.EFFECTIVE_END_DATE,'DD-Mon-YYYY'))
     END) "Payment Schedule - Effective End Date"
*/


--Additional Information - Processing Information

,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'ORA_BEN_RT_COSTING'
    AND LOOKUP_CODE = benRatesE0.CONFIG_CHAR_1
    ) RES_COSTING_METHOD
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RCRRG'
    AND LOOKUP_CODE = benRatesE0.RCRRG_CD
    ) RES_RECURRENCE
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (SELECT FORMULA_NAME
            FROM FF_FORMULAS_VL
            WHERE benRatesE0.EFFECTIVE_END_DATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
			AND FORMULA_ID = benRatesE0.RATE_PERIODIZATION_RL)
    END) RES_RATE_PERIODIZATION_FORMULA
,NULL RES_DISTRIBUTION_FORMULA


--Additional Information - Partial Month Determination

,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_PRTL_MO_DET_MTHD'
    AND LOOKUP_CODE = benRatesE0.PRTL_MO_DET_MTHD_CD
    ) RES_METHOD_DETERMINATION_RULE

,(CASE
    WHEN benRatesE0.PRTL_MO_DET_MTHD_CD = 'RL' THEN
        (SELECT FORMULA_NAME
             FROM FF_FORMULAS_VL
             WHERE FORMULA_ID = benRatesE0.PRTL_MO_DET_MTHD_RL)
    END) RES_PARTIAL_MONTH_DETERMINATIO
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (SELECT MEANING
            FROM FND_LOOKUP_VALUES
            WHERE LANGUAGE = USERENV('LANG')
            AND LOOKUP_TYPE = 'BEN_PRTL_MO_EFF_DT_DET'
            AND LOOKUP_CODE = benRatesE0.PRTL_MO_EFF_DT_DET_CD)
   END) RES_PARTIAL_MONTH_EFFECTIVE_DA -- Partial Month Effective Date Rule
,(CASE
    WHEN benRatesE0.PRTL_MO_DET_MTHD_CD = 'WASHRULE' THEN
        benRatesE0.WSH_RL_DY_MO_NUM
    END) RES_WASH_RULE_DAY
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' THEN
        (CASE
            WHEN benRatesE0.PRTL_MO_EFF_DT_DET_CD = 'RL' THEN
                (SELECT FORMULA_NAME
                     FROM FF_FORMULAS_VL
                     WHERE FORMULA_ID = benRatesE0.PRTL_MO_EFF_DT_DET_RL)
            END)
    END) RES_PARTIAL_MONTH_EFFECTIVE__0


--Additional Information - Annual Rates

,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND NVL(benRatesE0.ALWS_RLVR_CRS_FLAG,'N') = 'N' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_DET_PL_YTD_CNTRS'
             AND LOOKUP_CODE = benRatesE0.DET_PL_YTD_CNTRS_CD)
    END) RES_EXPECTED_CONTRIBUTIONS
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND NVL(benRatesE0.ALWS_RLVR_CRS_FLAG,'N') = 'N' THEN
        (SELECT NAME
             FROM BEN_COMP_LVL_FCTR
             WHERE COMP_LVL_FCTR_ID = benRatesE0.CLM_COMP_LVL_FCTR_ID)
    END) RES_CLAIMS_COMPARE
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND NVL(benRatesE0.ALWS_RLVR_CRS_FLAG,'N') = 'N' THEN
        (SELECT NAME
             FROM BEN_COMP_LVL_FCTR
             WHERE COMP_LVL_FCTR_ID = benRatesE0.PTD_COMP_LVL_FCTR_ID)
    END) RES_COMPENSATION_LEVEL


,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND NVL(benRatesE0.ALWS_RLVR_CRS_FLAG,'N') = 'N' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_PRORT_ANN_ELCN_VAL'
             AND LOOKUP_CODE = benRatesE0.PRORT_MX_ANN_ELCN_VAL_CD)
    END) RES_PRORATED_MAXIMUM_ANNUAL_VA -- Prorated Maximum Annual Value Rule
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND NVL(benRatesE0.ALWS_RLVR_CRS_FLAG,'N') = 'N' THEN
        (SELECT FORMULA_NAME
            FROM FF_FORMULAS_VL
            WHERE benRatesE0.EFFECTIVE_END_DATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
			AND FORMULA_ID = benRatesE0.PRORT_MX_ANN_ELCN_VAL_RL)
    END) RES_PRORATED_MAXIMUM_ANNUAL__1 -- Prorated Maximum Annual Value Formula
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND NVL(benRatesE0.ALWS_RLVR_CRS_FLAG,'N') = 'N' THEN
        (SELECT MEANING
             FROM FND_LOOKUP_VALUES
             WHERE LANGUAGE = USERENV('LANG')
             AND LOOKUP_TYPE = 'BEN_PRORT_ANN_ELCN_VAL'
             AND LOOKUP_CODE = benRatesE0.PRORT_MN_ANN_ELCN_VAL_CD)
    END) RES_PRORATE_ANNUAL_MINIMUM_VAL -- Prorate Annual Minimum Value Rule
,(CASE
    WHEN NVL(benPlansE0.FUNCTION_CODE,'XXX') != 'IMP' AND NVL(benRatesE0.ALWS_RLVR_CRS_FLAG,'N') = 'N' THEN
        (SELECT FORMULA_NAME
            FROM FF_FORMULAS_VL
            WHERE benRatesE0.EFFECTIVE_END_DATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
			AND FORMULA_ID = benRatesE0.PRORT_MN_ANN_ELCN_VAL_RL)
    END) RES_PRORATE_ANNUAL_MINIMUM_V_2 -- Prorate Annual Minimum Value Formula



,benRatesE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,benRatesE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,benRatesE0.CREATED_BY RSC_CREATED_BY
,benRatesE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM BEN_ACTY_BASE_RT_F benRatesE0
,(SELECT PL_ID
    ,NAME
    ,FUNCTION_CODE
    FROM BEN_PL_F
    WHERE SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
    ) benPlansE0
,(SELECT ACTY_BASE_RT_ID
    ,PYMT_SCHED_CD
    ,PYMT_SCHED_RL
    ,EFFECTIVE_START_DATE
    ,EFFECTIVE_END_DATE
    FROM BEN_ACTY_RT_PYMT_SCHED_F
    WHERE SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
    ) paymentSchedulsE0
WHERE SYSDATE BETWEEN benRatesE0.EFFECTIVE_START_DATE AND benRatesE0.EFFECTIVE_END_DATE
AND benRatesE0.CONTEXT_PL_ID = benPlansE0.PL_ID
AND benRatesE0.ACTY_BASE_RT_ID = paymentSchedulsE0.ACTY_BASE_RT_ID(+)
ORDER BY benRatesE0.NAME