/* ****************************************************************************
 * $Revision: 80152 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2023-02-13 11:18:04 +0700 (Mon, 13 Feb 2023) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Job%20-%20Job%20Details.sql $:
 * $Id: Manage Job - Job Details.sql 80152 2023-02-13 04:18:04Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 

select QRSLT.name RES_NAME 
,QRSLT.JOB_CODE RES_CODE
,TO_CHAR(QRSLT.EFFECTIVE_START_DATE,'DD-Mon-YYYY')  RES_EFFECTIVE_START_DATE
,TO_CHAR(QRSLT.EFFECTIVE_END_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_END_DATE
,QRSLT.SET_NAME RES_JOB_SET
,(SELECT ActionsPEO.action_name  
	FROM PER_ACTION_REASON_USAGES ActionReasonUsagesPEO
	,PER_ACTIONS_VL ActionsPEO
	WHERE ACTIONREASONUSAGESPEO.ACTION_ID = ACTIONSPEO.ACTION_ID
	AND ACTIONREASONUSAGESPEO.ACTION_REASON_ID = QRSLT.ACTION_OCCURRENCE_ID
	) RES_ACTION_REASON
,(select MEANING 
	from HCM_LOOKUPS HCMLOOKUPPEO 
	where HCMLOOKUPPEO.LOOKUP_TYPE = 'ACTIVE_INACTIVE' 
	and HCMLOOKUPPEO.LOOKUP_CODE = QRSLT.ACTIVE_STATUS
	) RES_STATUS
,(select MEANING 
	from HCM_LOOKUPS HCMLOOKUPPEO 
	where HCMLOOKUPPEO.LOOKUP_TYPE = 'PART_FULL_TIME' 
	and HCMLOOKUPPEO.LOOKUP_CODE = QRSLT.FULL_PART_TIME
	) RES_FULL_TIME_OR_PART_TIME
,(select MEANING 
	from HCM_LOOKUPS HCMLOOKUPPEO 
	where HCMLOOKUPPEO.LOOKUP_TYPE = 'REGULAR_TEMPORARY' 
	and HCMLOOKUPPEO.LOOKUP_CODE = QRSLT.REGULAR_TEMPORARY
	) RES_REGULAR_OR_TEMPORARY
,QRSLT.JOB_FAMILY_NAME RES_JOB_FAMILY
,(select MEANING 
	from HCM_LOOKUPS HCMLOOKUPPEO 
	where HCMLOOKUPPEO.LOOKUP_TYPE = 'JOB_FUNCTION_CODE' 
	and HCMLOOKUPPEO.LOOKUP_CODE = QRSLT.JOB_FUNCTION_CODE
	) RES_JOB_FUNCTION 
,QRSLT.APPROVAL_AUTHORITY RES_LEVEL 
,(select MEANING 
	from HCM_LOOKUPS HCMLOOKUPPEO 
	where HCMLOOKUPPEO.LOOKUP_TYPE = 'MANAGER_LEVEL' 
	and HCMLOOKUPPEO.LOOKUP_CODE = QRSLT.MANAGER_LEVEL
	) RES_MANAGEMENT_LEVEL
,DECODE(QRSLT.MED_CHECKUP_REQ,'Y','Yes','No') RES_MEDICAL_CHECKUP_REQUIRED
,DECODE(QRSLT.BENCHMARK_JOB_FLAG,'Y','Yes','No') RES_BENCHMARK
,(select name 
	from PER_JOBS_F_TL TL 
	where sysdate between NVL(TL.EFFECTIVE_START_DATE,sysdate) and NVL(TL.EFFECTIVE_END_DATE,sysdate)  
	and TL.JOB_ID = QRSLT.BENCHMARK_JOB_ID
	AND TL.LANGUAGE = USERENV('LANG') 
	) RES_BENCHMARK_JOB
,(select name 
	from PER_JOBS_F_TL TL 
	where sysdate between NVL(TL.EFFECTIVE_START_DATE,sysdate) and NVL(TL.EFFECTIVE_END_DATE,sysdate)  
	and TL.JOB_ID = QRSLT.PROGRESSION_JOB_ID 
	AND TL.LANGUAGE = USERENV('LANG') 
	) RES_PROGRESSION_JOB
,(SELECT NAME 
	FROM PER_GRADE_LADDERS_F_VL 
	WHERE GRADE_LADDER_ID = QRSLT.GRADE_LADDER_ID 
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND NVL(EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY'))
	)  RES_GRADE_LADDER
/*,QRSLT.POSITION_TYPE RES_POSITION_TYPE
,QRSLT.FLSA_STATUS RES_OVERTIME_STATUS
,QRSLT.EEO_1_CATEGORY  RES_EEO_1_CATEGORY
,QRSLT.JOB_GROUP  RES_JOB_GROUP
,QRSLT.INFORMATION4 RES_LINE_OF_PROGRESSION
,QRSLT.STANDARD_OCCUPATIONAL_CLAS RES_STANDARD_OCCUPATIONAL_CLAS
,QRSLT.EEO_4_CATEGORY RES_EEO_4_CATEGORY
,QRSLT.EEO_4_FUNC RES_EEO_4_FUNCTION
,QRSLT.INSEE_PCS_CODE   RES_INSEE_PCS_CODE
,QRSLT.EXTENSION_TO_PCS_CODE  RES_EXTENSION_TO_PCS_CODE
,QRSLT.RECOGNIZED_AS_ECAP  RES_RECOGNIZED_AS_ECAP
,DECODE(QRSLT.EMPLOYMENT_EQUITY_ELIGIBLE,'Y','Yes','No') RES_EMPLOYMENT_EQUITY_ELIGIBLE
,QRSLT.EEOG RES_EEOG
,QRSLT.NOC_CODE RES_NOC_CODE
,QRSLT.SOCIAL_INSURANCE_SALARY_TY RES_SOCIAL_INSURANCE_SALARY_TY
,NULL RES_CBO_OCCUPATION*/
,QRSLT.LAST_UPDATED_BY as RSC_LAST_UPDATED_BY
,QRSLT.LAST_UPDATE_DATE as RSC_LAST_UPDATE_DATE 
,QRSLT.CREATED_BY  RSC_CREATED_BY
,QRSLT.CREATION_DATE  RSC_CREATION_DATE
, null RSC_LEDGER_ID
, null RSC_CHART_OF_ACCOUNTS_ID
, null RSC_BUSINESS_UNIT_ID
, null RSC_LEGAL_ENTITY_ID
, null RSC_ORGANIZATION_ID
, null RSC_BUSINESS_GROUP_ID
, NULL RSC_ENTERPRISE_ID
, NULL RSC_COUNTRY_ID
    
from (
SELECT 	
	JobDEO.JOB_ID
,JobDEO.EFFECTIVE_START_DATE
,JobDEO.EFFECTIVE_END_DATE
,JobDEO.NAME
,JobDEO.JOB_CODE
,JobDEO.ACTIVE_STATUS
,JobFamilyDPEO.JOB_FAMILY_NAME
,JobDEO.JOB_FUNCTION_CODE
,SetIdSetPEO.SET_NAME
,JobDEO.MANAGER_LEVEL
,JobDEO.BENCHMARK_JOB_FLAG
,JOBDEO.BENCHMARK_JOB_ID
,JobDEO.PROGRESSION_JOB_ID
,JobDEO.SET_ID
,JobDEO.BUSINESS_GROUP_ID
,JobDEO.JOB_FAMILY_ID
,JobDEO.ACTION_OCCURRENCE_ID
,JobDEO.MED_CHECKUP_REQ
,JobDEO.REGULAR_TEMPORARY
,JobDEO.FULL_PART_TIME
,JobDEO.APPROVAL_AUTHORITY
,JobDEO.GRADE_LADDER_ID 
,JobDEO.ATTRIBUTE_CATEGORY
,JobDEO.ATTRIBUTE1
,JobDEO.ATTRIBUTE2
,JobDEO.ATTRIBUTE3
,JobDEO.ATTRIBUTE4
,JobDEO.ATTRIBUTE5
,JobDEO.ATTRIBUTE6
,JobDEO.ATTRIBUTE7
,JobDEO.ATTRIBUTE8
,JobDEO.ATTRIBUTE9
,JobDEO.ATTRIBUTE10
,JobDEO.ATTRIBUTE11
,JobDEO.ATTRIBUTE12
,JobDEO.ATTRIBUTE13
,JobDEO.ATTRIBUTE14
,JobDEO.ATTRIBUTE15
,JobDEO.ATTRIBUTE16
,JobDEO.ATTRIBUTE17
,JobDEO.ATTRIBUTE18
,JobDEO.ATTRIBUTE19
,JobDEO.ATTRIBUTE20
,JobDEO.ATTRIBUTE21
,JobDEO.ATTRIBUTE22
,JobDEO.ATTRIBUTE23
,JobDEO.ATTRIBUTE24
,JobDEO.ATTRIBUTE25
,JobDEO.ATTRIBUTE26
,JobDEO.ATTRIBUTE27
,JobDEO.ATTRIBUTE28
,JobDEO.ATTRIBUTE29
,JobDEO.ATTRIBUTE30
,JobDEO.OBJECT_VERSION_NUMBER
,JobDEO.CREATED_BY
,JobDEO.CREATION_DATE
,JobDEO.LAST_UPDATED_BY
,JobDEO.LAST_UPDATE_DATE
,JobDEO.LAST_UPDATE_LOGIN
,SetIdSetPEO.SET_ID                     AS SET_ID1
,JobFamilyDPEO.JOB_FAMILY_ID            AS JOB_FAMILY_ID1
,JobFamilyDPEO.EFFECTIVE_START_DATE     AS EFFECTIVE_START_DATE2
,JobFamilyDPEO.EFFECTIVE_END_DATE       AS EFFECTIVE_END_DATE2
,JOBFAMILYDPEO.OBJECT_VERSION_NUMBER    as OBJECT_VERSION_NUMBER2
,(
	(SELECT MEANING
	FROM HR_LOOKUPS
	WHERE(LOOKUP_TYPE = 'HRX_CH_POSITION_TYPE'
	AND ENABLED_FLAG  = 'Y')
	AND(LOOKUP_CODE   = JobLegislativeDEO.INFORMATION1
	and rownum        = 1)
	)) POSITION_TYPE 
	,(
	(SELECT MEANING
	FROM HR_LOOKUPS
	where(LOOKUP_TYPE = 'HRX_US_FLSA_CATEGORY')
	AND(LOOKUP_CODE   = JobLegislativeDEO2.INFORMATION1
	and rownum        = 1)
	))  FLSA_STATUS 
	,(
	(SELECT MEANING
	FROM HR_LOOKUPS
	where(LOOKUP_TYPE = 'HRX_US_EEO1_JOB_CATEGORY')
	AND(LOOKUP_CODE   = JOBLEGISLATIVEDEO2.INFORMATION2
	and rownum        = 1)
	)) EEO_1_CATEGORY 
	,(
	(SELECT MEANING
	FROM HR_LOOKUPS
	where(LOOKUP_TYPE = 'HRX_US_JOB_GROUP')
	AND(LOOKUP_CODE   = JobLegislativeDEO2.INFORMATION3
	and rownum        = 1)
	)) JOB_GROUP 
	,JOBLEGISLATIVEDEO6.INFORMATION4
	,(
	(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	where(LOOKUP_TYPE = 'HRX_FR_PCS_CODE')
	AND(LOOKUP_CODE   = JobLegislativeDEO3.INFORMATION1
	and rownum        = 1)
	)) INSEE_PCS_CODE
	,(
	(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	where(LOOKUP_TYPE = 'HRX_FR_PCS_EXT_CODE')
	AND(LOOKUP_CODE   = JobLegislativeDEO3.INFORMATION2
	and rownum        = 1)
	)) EXTENSION_TO_PCS_CODE
	,(
	(SELECT MEANING
	FROM HCM_LOOKUPS
	WHERE(LOOKUP_TYPE = 'HRC_YES_NO'
	and ENABLED_FLAG  = 'Y')
	AND(LOOKUP_CODE   = JobLegislativeDEO3.INFORMATION3
	and rownum        = 1)
	)) RECOGNIZED_AS_ECAP
	,(
	(SELECT MEANING
	FROM HR_LOOKUPS
	WHERE(LOOKUP_TYPE = 'HRX_CA_EEOG_CATEGORY'
	and ENABLED_FLAG  = 'Y')
	and(LOOKUP_CODE   = JOBLEGISLATIVEDEO4.INFORMATION1
	and rownum        = 1) 
	)) EEOG
	,JOBLEGISLATIVEDEO4.INFORMATION2 NOC_CODE
	,(
	(SELECT MEANING
	FROM HCM_LOOKUPS
	WHERE(LOOKUP_TYPE = 'ORA_HRX_MX_SI_SALARY_TYPE'
	AND ENABLED_FLAG  = 'Y')
	AND(LOOKUP_CODE   = JobLegislativeDEO5.INFORMATION1
	and rownum        = 1)
	)) SOCIAL_INSURANCE_SALARY_TY
	,(
	(SELECT MEANING
	FROM HCM_LOOKUPS
	WHERE(LOOKUP_TYPE = 'HRX_US_EEO4_JOB_CATEGORY'
	AND ENABLED_FLAG  = 'Y')
	AND(LOOKUP_CODE   = JobLegislativeDEO6.INFORMATION6
	and rownum        = 1)
	)) EEO_4_CATEGORY
	,JOBLEGISLATIVEDEO4.INFORMATION3 EMPLOYMENT_EQUITY_ELIGIBLE
	,(
	(SELECT MEANING
	FROM HCM_LOOKUPS
	WHERE(LOOKUP_TYPE = 'HRX_US_EEO4_JOB_FUNCTION'
	AND ENABLED_FLAG  = 'Y')
	AND(LOOKUP_CODE   = JobLegislativeDEO6.INFORMATION7
	and rownum        = 1)
	)) EEO_4_FUNC
	,JOBLEGISLATIVEDEO6.INFORMATION5 STANDARD_OCCUPATIONAL_CLAS
FROM PER_JOBS_F_VL JobDEO
,FND_SETID_SETS_VL SetIdSetPEO
,PER_JOB_FAMILY_F_VL JOBFAMILYDPEO
--,PER_JOBS_F_TL JOBTRANSLATIONEO
,(SELECT * 
	FROM PER_JOB_LEG_F 
	WHERE INFORMATION_CATEGORY = 'CH'
	) JOBLEGISLATIVEDEO
,(SELECT * 
	FROM PER_JOB_LEG_F 
	WHERE INFORMATION_CATEGORY = 'HRX_US_JOBS'
	) JOBLEGISLATIVEDEO2
,(SELECT * 
	FROM PER_JOB_LEG_F 
	WHERE INFORMATION_CATEGORY = 'FR'
	) JOBLEGISLATIVEDEO3
,(SELECT * 
	FROM PER_JOB_LEG_F 
	WHERE INFORMATION_CATEGORY = 'CA'
	) JOBLEGISLATIVEDEO4
,(SELECT * 
	FROM PER_JOB_LEG_F 
	WHERE INFORMATION_CATEGORY = 'ORA_HRX_MX_JOBS'
	) JOBLEGISLATIVEDEO5
,(SELECT * 
	FROM PER_JOB_LEG_F 
	WHERE INFORMATION_CATEGORY = 'HRX_US_JOBS'
	) JOBLEGISLATIVEDEO6
WHERE(JobDEO.SET_ID             = SetIdSetPEO.SET_ID)
AND(JobDEO.JOB_FAMILY_ID        = JobFamilyDPEO.JOB_FAMILY_ID(+))
and JOBDEO.JOB_ID  = JOBLEGISLATIVEDEO.JOB_ID(+)
--and JOBLEGISLATIVEDEO.INFORMATION_CATEGORY = 'CH'
and(JOBDEO.EFFECTIVE_START_DATE between JOBLEGISLATIVEDEO.EFFECTIVE_START_DATE(+) and JOBLEGISLATIVEDEO.EFFECTIVE_END_DATE(+))
and JOBDEO.JOB_ID  = JOBLEGISLATIVEDEO2.JOB_ID(+)
--and JOBLEGISLATIVEDEO2.INFORMATION_CATEGORY = 'HRX_US_JOBS' 
and(JOBDEO.EFFECTIVE_START_DATE between JOBLEGISLATIVEDEO2.EFFECTIVE_START_DATE(+) and JOBLEGISLATIVEDEO2.EFFECTIVE_END_DATE(+))
and JOBDEO.JOB_ID  = JOBLEGISLATIVEDEO3.JOB_ID(+)
--and JOBLEGISLATIVEDEO3.INFORMATION_CATEGORY = 'FR' 
and(JOBDEO.EFFECTIVE_START_DATE between JOBLEGISLATIVEDEO3.EFFECTIVE_START_DATE(+) and JOBLEGISLATIVEDEO3.EFFECTIVE_END_DATE(+))
and JOBDEO.JOB_ID  = JOBLEGISLATIVEDEO4.JOB_ID(+)
--and JOBLEGISLATIVEDEO4.INFORMATION_CATEGORY = 'CA' 
and(JOBDEO.EFFECTIVE_START_DATE between JOBLEGISLATIVEDEO4.EFFECTIVE_START_DATE(+) and JOBLEGISLATIVEDEO4.EFFECTIVE_END_DATE(+))
and JOBDEO.JOB_ID  = JOBLEGISLATIVEDEO5.JOB_ID(+)
--and JOBLEGISLATIVEDEO5.INFORMATION_CATEGORY = 'ORA_HRX_MX_JOBS' 
and(JOBDEO.EFFECTIVE_START_DATE between JOBLEGISLATIVEDEO5.EFFECTIVE_START_DATE(+) and JOBLEGISLATIVEDEO5.EFFECTIVE_END_DATE(+))
and JOBDEO.JOB_ID  = JOBLEGISLATIVEDEO6.JOB_ID(+)
--and JOBLEGISLATIVEDEO6.INFORMATION_CATEGORY = 'HRX_US_JOBS' 
and(JOBDEO.EFFECTIVE_START_DATE between JOBLEGISLATIVEDEO6.EFFECTIVE_START_DATE(+) and JOBLEGISLATIVEDEO6.EFFECTIVE_END_DATE(+))

) QRSLT 
order by QRSLT.name,QRSLT.JOB_CODE,QRSLT.EFFECTIVE_START_DATE