/* ****************************************************************************
 * $Revision: 79547 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2022-10-20 14:37:06 +0700 (Thu, 20 Oct 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Corporate%20Card%20Programs%20-%20Company%20Accounts.sql $:
 * $Id: Manage Corporate Card Programs - Company Accounts.sql 79547 2022-10-20 07:37:06Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- RSC_PREREQUISITE_OBJECTS=EXM_CC_COMPANY_ACCOUNTS
-- FIELD_TO_APPLY_FUNCTION=RES_EXPENSE_CLEARING_ACCOUNT/GET_CODE_COMBINATION

SELECT ExmCardProgramsE0.CARD_PROGRAM_NAME RES_NAME
,ExmCcCompanyAccountsE0.COMPANY_ACCOUNT_NAME RES_COMPANY_ACCOUNT_NAME
,ExmCcCompanyAccountsE0.COMPANY_NUMBER RES_COMPANY_ACCOUNT_NUMBER
,ExmCcCompanyAccountsE0.MARKET_CODE RES_MARKET_CODE
,ExmCcCompanyAccountsE0.BILLING_CNTL_ACCT_NUMBER RES_REQUESTING_CONTROL_ACCOUNT
,ExmCcCompanyAccountsE0.BILLING_BASIC_CTRL_ACCT_NUM RES_BILLING_CONTROL_ACCOUNT_NU
,ExmCcCompanyAccountsE0.CARD_ISSUER_NUMBER RES_CARD_ISSUER_NUMBER
,ExmCcCompanyAccountsE0.INTERBANK_CARDASSOC_NUMBER RES_PROCESSOR_ASSIGNED_NUMBER
,(SELECT PARTY_NAME 
	FROM HZ_PARTIES
	WHERE PARTY_ID = ExmCcCompanyAccountsE0.CARD_ISSUER_ID
	) RES_CARD_ISSUER
,(SELECT PARTY_SITE_NAME
	FROM HZ_PARTY_SITES
	WHERE PARTY_SITE_ID = ExmCcCompanyAccountsE0.CARD_ISSUER_SITE_ID
	) RES_CARD_ISSUER_SITE
,TO_CHAR(ExmCcCompanyAccountsE0.INACTIVE_DATE,'DD-Mon-YYYY') RES_INACTIVE_DATE
,(SELECT DISPLAY_NAME
	FROM PER_PERSON_NAMES_F
	WHERE PERSON_ID = ExmCcCompanyAccountsE0.CORPORATE_CARD_ADMIN
	AND NAME_TYPE = 'GLOBAL'
	AND SYSDATE BETWEEN EFFECTIVE_START_DATE AND EFFECTIVE_END_DATE
	) RES_CORPORATE_CARD_ADMINISTRAT
,(SELECT BU_NAME
	FROM FUN_ALL_BUSINESS_UNITS_V
	WHERE BU_ID = ExmCcCompanyAccountsE0.REQUISITION_BU
	) RES_PAYABLES_BUSINESS_UNIT
,(SELECT CURRENCY_CODE||' - '||NAME
	FROM FND_CURRENCIES_TL
	WHERE CURRENCY_CODE = ExmCcCompanyAccountsE0.PAYMENT_CURRENCY_CODE
	AND LANGUAGE = USERENV('LANG')
	) RES_PAYMENT_CURRENCY
,DECODE(ExmCcCompanyAccountsE0.MULTI_CURRENCY_ENABLED,'Y','Yes','No')  RES_ALLOW_MULTIPLE_BILLED_CURR
,(SELECT NAME
	FROM AP_TERMS_TL
	WHERE TERM_ID = ExmCcCompanyAccountsE0.PAYMENT_TERM_ID
	AND LANGUAGE = USERENV('LANG')
	) RES_PAYMENT_TERMS
,ExmCcCompanyAccountsE0.PAY_GROUP_CODE RES_PAY_GROUP
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'EXM_PAYMENT_DUE_FROM'
	AND LOOKUP_CODE = ExmCcCompanyAccountsE0.PAYMENT_DUE_FROM_CODE
	) RES_PAYMENT_OPTION
,ExmCcCompanyAccountsE0.EXPENSE_CLEARING_CCID RES_EXPENSE_CLEARING_ACCOUNT
,DECODE(ExmCcCompanyAccountsE0.OVERLAY_BALANCING_SEG_FLAG,'Y','Yes','No') RES_OVERLAY_BALANCING_SEGMENT
,DECODE(ExmCcCompanyAccountsE0.INCL_PERSONAL_EXPENSE_FLAG,'Y','Yes','No') RES_REQUIRE_PERSONAL_EXPENSES_
,ExmCcCompanyAccountsE0.BOOK_NUMBER RES_BOOK_NUMBER
,ExmCcCompanyAccountsE0.LOAD_NUMBER RES_LOAD_NUMBER
,(SELECT TERRITORY_CODE
	FROM FND_TERRITORIES
	WHERE TO_NUMBER(ISO_NUMERIC_CODE)= ExmCcCompanyAccountsE0.CARD_ISSUER_COUNTRY
	) RES_CARD_ISSUER_COUNTRY_CODE
,ExmCcCompanyAccountsE0.CARD_DISGUISE_CTRL_ACCT_NUM RES_CARD_DISGUISING_CONTROL_AC
,ExmCcCompanyAccountsE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,ExmCcCompanyAccountsE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,ExmCcCompanyAccountsE0.CREATED_BY  RSC_CREATED_BY
,ExmCcCompanyAccountsE0.CREATION_DATE  RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,ExmCcCompanyAccountsE0.REQUISITION_BU RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM EXM_CARD_PROGRAMS ExmCardProgramsE0
,EXM_CC_COMPANY_ACCOUNTS ExmCcCompanyAccountsE0
WHERE ExmCardProgramsE0.CARD_PROGRAM_ID = ExmCcCompanyAccountsE0.CARD_PROGRAM_ID
ORDER BY ExmCardProgramsE0.CARD_PROGRAM_NAME
,ExmCcCompanyAccountsE0.COMPANY_ACCOUNT_NAME