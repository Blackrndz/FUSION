/* ****************************************************************************
 * $Revision:  $:
 * $Author: Nasrullah Dusenmahamad $:
 * $Date: 2018-03-20  $:
 * $HeadURL: $:
 * $Id: Configure Exception Sets - Exception  $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- RSC_PREREQUISITE_OBJECTS=PER_EXT_DEFINITIONS_VL

SELECT extDefsE0.BASE_DEFINITION_NAME RES_NAME
,deliveriesE0.BASE_DELIVERY_OPTION_NAME RES_DELIVERY_OPTION_NAME
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'PER_EXT_DELIVERY_TYPES'
    AND LOOKUP_CODE = deliveriesE0.DELIVERY_TYPE
    ) RES_DELIVERY_TYPE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'PER_EXT_OUTPUT_TYPES'
    AND LOOKUP_CODE = deliveriesE0.OUTPUT_TYPE
    ) RES_OUTPUT_TYPE
,deliveriesE0.BIP_REPORT_NAME RES_REPORT
,deliveriesE0.BIP_TEMPLATE_NAME RES_TEMPLATE_NAME
,DECODE(deliveriesE0.MANDATORY_FLAG,'Y','Yes','No') RES_REQUIRED
,deliveriesE0.OUTPUT_NAME RES_OUTPUT_NAME

--EMAIL
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'EMAIL' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER2'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_CC
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'EMAIL' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER8'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_BCC
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'EMAIL' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER3'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_FROM_EMAIL
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'EMAIL' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER1'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_EMAIL_ADDRESS
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'EMAIL' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER5'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_EMAIL_BODY
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'EMAIL' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER7'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_REPLY_TO
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'EMAIL' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER4'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_SUBJECT


--FTP
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'FTP' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER4'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_REMOTE_DIRECTORY
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'FTP' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER5'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_REMOTE_FILE_NAME
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'FTP' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PARAMETER1'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_SERVER_NAME
	

--WEB
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'HCMCONNECT' OR deliveriesE0.DELIVERY_TYPE = 'FTP' THEN
        (SELECT MEANING
            FROM FND_LOOKUP_VALUES
            WHERE LANGUAGE = USERENV('LANG')
            AND LOOKUP_TYPE = 'ORA_PER_EXT_COMPRESS_TYPES'
            AND LOOKUP_CODE = (SELECT OPTION_VALUE
                FROM PER_EXT_DELIVERY_OPTION_DTLS
                WHERE OPTION_TYPE = 'ZIP'
                AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID))
    END) RES_COMPRESS
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'HCMCONNECT' OR deliveriesE0.DELIVERY_TYPE = 'FTP' THEN
        (SELECT MEANING
            FROM FND_LOOKUP_VALUES
            WHERE LANGUAGE = USERENV('LANG')
            AND LOOKUP_TYPE = 'ORA_HRC_FILE_ENCRYPT_TYPE'
            AND LOOKUP_CODE = (SELECT OPTION_VALUE
                    FROM PER_EXT_DELIVERY_OPTION_DTLS
                    WHERE OPTION_TYPE = 'ENCMODE'
                    AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID))
    END) RES_ENCRYPTION_MODE
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'HCMCONNECT' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'INTGNAME'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_INTEGRATION_NAME
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'HCMCONNECT' OR deliveriesE0.DELIVERY_TYPE = 'FTP' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'ENC_KEY_NAME'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_ENCRYPTION_KEY
	
--FTP	
,(CASE
    WHEN deliveriesE0.DELIVERY_TYPE = 'FTP' THEN
        (SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'CONFIG'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID)
    END) RES_CONFIGURATIONNAME

,(SELECT OPTION_VALUE
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'DELIMITER'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID) RES_DELIMITER
,(SELECT DECODE(OPTION_VALUE,'Y','Yes','No')
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PRINT_HDR'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID) RES_PRINT_HEADER_RECORD
,(SELECT DECODE(OPTION_VALUE,'Y','Yes','No')
            FROM PER_EXT_DELIVERY_OPTION_DTLS
            WHERE OPTION_TYPE = 'PRINT_INFO'
            AND EXT_DELIVERY_OPTION_ID = deliveriesE0.EXT_DELIVERY_OPTION_ID) RES_PRINT_DEFAULT_ATTRIBUTES
	
,deliveriesE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,deliveriesE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,deliveriesE0.CREATED_BY RSC_CREATED_BY
,deliveriesE0.CREATION_DATE RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,(SELECT LEGISLATION_CODE
	FROM PER_LEGISLATIVE_DATA_GROUPS_VL
	WHERE LEGISLATIVE_DATA_GROUP_ID = extDefsE0.LEGISLATIVE_DATA_GROUP_ID
	) RSC_COUNTRY_ID

FROM PER_EXT_DEFINITIONS_VL extDefsE0
,PER_EXT_DELIVERY_OPTIONS_B deliveriesE0
WHERE extDefsE0.LEGISLATION_CODE IS NULL
AND extDefsE0.CREATOR_ID IS NULL
AND extDefsE0.EXT_DEFINITION_ID = deliveriesE0.EXT_DEFINITION_ID
ORDER BY extDefsE0.BASE_DEFINITION_NAME