/* ****************************************************************************
 * $Revision: 72749 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2019-10-23 15:22:46 +0700 (Wed, 23 Oct 2019) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13.19/trunk/core/reverse_sql/FINANCIALS/Manage%20Availability%20Lookups%20-%20Lookup%20Types.sql $:
 * $Id: Manage Availability Lookups - Lookup Types.sql 72749 2019-10-23 08:22:46Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
WITH cmpLOOKUP0 AS (
			SELECT KEY_VALUE,ATTRIBUTE_VALUE,ENABLED_FLAG,DISPLAY_NAME FROM CMP_LOOKUP_USAGES_VL WHERE ATTRIBUTE_VALUE = 0 AND ATTRIBUTE_NAME = 'CMP_RATING_FB')
	,cmpLOOKUP1 AS (
			SELECT KEY_VALUE,ATTRIBUTE_VALUE,ENABLED_FLAG,DISPLAY_NAME FROM CMP_LOOKUP_USAGES_VL WHERE ATTRIBUTE_VALUE = 1 AND ATTRIBUTE_NAME = 'CMP_RATING_FB')
	,cmpLOOKUP2 AS (
			SELECT KEY_VALUE,ATTRIBUTE_VALUE,ENABLED_FLAG,DISPLAY_NAME FROM CMP_LOOKUP_USAGES_VL WHERE ATTRIBUTE_VALUE = 2 AND ATTRIBUTE_NAME = 'CMP_RATING_FB')
	,cmpLOOKUP3 AS (
			SELECT KEY_VALUE,ATTRIBUTE_VALUE,ENABLED_FLAG,DISPLAY_NAME FROM CMP_LOOKUP_USAGES_VL WHERE ATTRIBUTE_VALUE = 3 AND ATTRIBUTE_NAME = 'CMP_RATING_FB')
	,cmpLOOKUP4 AS (
			SELECT KEY_VALUE,ATTRIBUTE_VALUE,ENABLED_FLAG,DISPLAY_NAME FROM CMP_LOOKUP_USAGES_VL WHERE ATTRIBUTE_VALUE = 4 AND ATTRIBUTE_NAME = 'CMP_RATING_FB')
	,cmpLOOKUP5 AS (
			SELECT KEY_VALUE,ATTRIBUTE_VALUE,ENABLED_FLAG,DISPLAY_NAME FROM CMP_LOOKUP_USAGES_VL WHERE ATTRIBUTE_VALUE = 5 AND ATTRIBUTE_NAME = 'CMP_RATING_FB')
			
SELECT cmpPLANEO.PLAN_NAME RES_PLAN
,DECODE(cmpPLANEO.FEEDBACK_ENABLED_FLAG,'Y','Yes','No') RES_ENABLE_FEEDBACK_SURVEY
,DECODE(cmpFEEDBACKEO.RATING_ENABLED_FLAG,'Y','Yes','No') RES_ENABLE_RATINGS
,cmpFEEDBACKEO.RATING_INSTRUCTION RES_SPECIAL_INSTRUCTIONS
,cmpLOOKUP0.ATTRIBUTE_VALUE RES_RATING_0
,cmpLOOKUP1.ATTRIBUTE_VALUE RES_RATING_1
,cmpLOOKUP2.ATTRIBUTE_VALUE RES_RATING_2
,cmpLOOKUP3.ATTRIBUTE_VALUE RES_RATING_3
,cmpLOOKUP4.ATTRIBUTE_VALUE RES_RATING_4
,cmpLOOKUP5.ATTRIBUTE_VALUE RES_RATING_5
,DECODE(cmpLOOKUP0.ENABLED_FLAG,'Y','Yes','No') RES_RATING_0_ENABLE
,DECODE(cmpLOOKUP1.ENABLED_FLAG,'Y','Yes','No') RES_RATING_1_ENABLE
,DECODE(cmpLOOKUP2.ENABLED_FLAG,'Y','Yes','No') RES_RATING_2_ENABLE
,DECODE(cmpLOOKUP3.ENABLED_FLAG,'Y','Yes','No') RES_RATING_3_ENABLE
,DECODE(cmpLOOKUP4.ENABLED_FLAG,'Y','Yes','No') RES_RATING_4_ENABLE
,DECODE(cmpLOOKUP5.ENABLED_FLAG,'Y','Yes','No') RES_RATING_5_ENABLE
,cmpLOOKUP0.DISPLAY_NAME RES_RATING_0_DISPLAY_NAME
,cmpLOOKUP1.DISPLAY_NAME RES_RATING_1_DISPLAY_NAME
,cmpLOOKUP2.DISPLAY_NAME RES_RATING_2_DISPLAY_NAME
,cmpLOOKUP3.DISPLAY_NAME RES_RATING_3_DISPLAY_NAME
,cmpLOOKUP4.DISPLAY_NAME RES_RATING_4_DISPLAY_NAME
,cmpLOOKUP5.DISPLAY_NAME RES_RATING_5_DISPLAY_NAME
,cmpFEEDBACKEO.QUESTION1 RES_QUESTION_1
,cmpFEEDBACKEO.QUESTION2 RES_QUESTION_2
,cmpFEEDBACKEO.QUESTION3 RES_QUESTION_3
,cmpFEEDBACKEO.QUESTION4 RES_QUESTION_4
,cmpFEEDBACKEO.QUESTION5 RES_QUESTION_5

 
,cmpFEEDBACKEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,cmpFEEDBACKEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,cmpFEEDBACKEO.CREATED_BY RSC_CREATED_BY
,cmpFEEDBACKEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM CMP_PLANS_VL cmpPLANEO
,CMP_FEEDBACK_VL cmpFEEDBACKEO
,cmpLOOKUP0
,cmpLOOKUP1
,cmpLOOKUP2
,cmpLOOKUP3
,cmpLOOKUP4
,cmpLOOKUP5
WHERE cmpPLANEO.PLAN_ID = cmpFEEDBACKEO.PLAN_ID
AND cmpFEEDBACKEO.PLAN_ID = cmpLOOKUP0.KEY_VALUE
AND cmpFEEDBACKEO.PLAN_ID = cmpLOOKUP1.KEY_VALUE
AND cmpFEEDBACKEO.PLAN_ID = cmpLOOKUP2.KEY_VALUE
AND cmpFEEDBACKEO.PLAN_ID = cmpLOOKUP3.KEY_VALUE
AND cmpFEEDBACKEO.PLAN_ID = cmpLOOKUP4.KEY_VALUE
AND cmpFEEDBACKEO.PLAN_ID = cmpLOOKUP5.KEY_VALUE
AND cmpPLANEO.COMP_TYPE = 'CWB'
ORDER BY cmpPLANEO.PLAN_NAME