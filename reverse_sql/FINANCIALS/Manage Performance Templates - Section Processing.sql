/* ****************************************************************************
 * $Revision: 78329 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2022-04-19 15:19:57 +0700 (Tue, 19 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Performance%20Templates%20-%20Section%20Processing.sql $:
 * $Id: Manage Performance Templates - Section Processing.sql 78329 2022-04-19 08:19:57Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
 -- RSC_PREREQUISITE_OBJECTS = HRA_TMPL_SECTIONS
 -- RSC_PREREQUISITE_OBJECTS = HRA_TMPL_DEFNS_VL
 
SELECT pfTemplatesE0.NAME RES_NAME
,(SELECT NAME
    FROM HRA_SECTION_DEFNS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND SECTION_DEF_ID = tempSectionsE0.SECTION_DEF_ID
    ) RES_SECTION_NAME
,(SELECT DESCRIPTION
    FROM HRA_SECTION_DEFNS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND SECTION_DEF_ID = tempSectionsE0.SECTION_DEF_ID
    ) RES_SECTION_DESCRIPTION
,tempSectionsE0.SEQUENCE_NUMBER RES_SEQUENCE_NUMBER

-- Section Type
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'HRA_SECTION_TYPE'
    AND LOOKUP_CODE = tempSectionsE0.SECTION_TYPE_CODE
     ) RES_SECTION_TYPE
     
-- Ratings
,(SELECT RATING_NAME
    FROM HRT_RATING_MODELS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND RATING_MODEL_ID = tempSectionsE0.SECTION_RATING_MODEL_ID
    ) RES_SECTION_RATING_MODEL
,DECODE(tempSectionsE0.RATE_SECTION_FLAG,'Y','Yes','No') RES_ENABLE_MANUAL_SECTION_RATI

-- Calculation Rules
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'HRA_PERF_CALC_RULE_TYPE'
    AND LOOKUP_CODE = tempSectionsE0.CALCULATION_RULE_CODE
    ) RES_CALCULATION_RULE_FOR_SECTI
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = tempSectionsE0.FAST_FORMULA_ID
    ) RES_FAST_FORMULA_RULE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'ORA_HRA_MAPPING_METRIC'
    AND LOOKUP_CODE = tempSectionsE0.CALC_MAPPING_CODE
    ) RES_MAPPING_METRIC
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'HRA_PERF_MAPPING_METHOD'
    AND LOOKUP_CODE = tempSectionsE0.MAPPING_METHOD_CODE
    ) RES_MAPPING_METHOD
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'ORA_HRA_PERF_DECIMAL_PLACES'
    AND LOOKUP_CODE = tempSectionsE0.DECIMAL_PLACES
    ) RES_DECIMAL_PLACES
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'HRA_PERF_ROUNDING_RULE_CODE'
    AND LOOKUP_CODE = tempSectionsE0.ROUNDING_RULE_CODE
    ) RES_DECIMAL_ROUNDING_RULE


-- Comments
,DECODE(tempSectionsE0.ENABLE_SECTION_COMMENTS_FLAG,'Y','Yes','No') RES_ENABLE_SECTION_COMMENTS


-- Weighting
,DECODE(tempSectionsE0.WEIGHT_SECTION_FLAG,'Y','Yes','No') RES_ENABLE_SECTION_WEIGHTS
,(CASE
    WHEN tempSectionsE0.WEIGHT_SECTION_FLAG = 'Y' THEN
        tempSectionsE0.SECTION_WEIGHT
    END) RES_SECTION_WEIGHT
,(CASE
    WHEN tempSectionsE0.WEIGHT_SECTION_FLAG = 'Y' THEN
        tempSectionsE0.SECTION_MIN_WEIGHT
    END) RES_SECTION_MINIMUM_WEIGHT

-- Item Processing: Performance Goals
,DECODE(tempSectionsE0.ENABLE_ITEMS_FLAG,'Y','Yes','No') RES_ENABLE_ITEMS


-- Ratings and Calculations
,(CASE
    WHEN tempSectionsE0.ENABLE_ITEMS_FLAG = 'Y' THEN
        DECODE(tempSectionsE0.RATE_ITEM_FLAG,'Y','Yes','No')
    END) RES_ENABLE_RATINGS_FOR_ITEMS
,(CASE
    WHEN tempSectionsE0.RATE_ITEM_FLAG = 'Y' THEN
        (SELECT MEANING
            FROM FND_LOOKUP_VALUES
            WHERE LANGUAGE = USERENV('LANG')
            AND LOOKUP_TYPE = 'HRA_PERF_ITEM_RATING_TYPE'
            AND LOOKUP_CODE = tempSectionsE0.RATING_TYPE_CODE)
    END) RES_RATING_TYPE
,(CASE
    WHEN tempSectionsE0.RATE_ITEM_FLAG = 'Y' AND tempSectionsE0.SECTION_RATING_MODEL_ID IS NOT NULL THEN
        DECODE(tempSectionsE0.USE_SECRTG_FOR_PERFRTG_FLAG,'Y','Yes','No')
    END) RES_USE_SECTION_RATING_MODEL_F
,(CASE
    WHEN tempSectionsE0.RATE_ITEM_FLAG = 'Y' THEN
        (SELECT RATING_NAME
            FROM HRT_RATING_MODELS_TL
            WHERE LANGUAGE = USERENV('LANG')
            AND RATING_MODEL_ID = tempSectionsE0.PERF_RATING_MODEL_ID)
    END) RES_PERFORMANCE_RATING_MODEL
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'HRA_PERF_ITEM_CALC_TYPE'
    AND LOOKUP_CODE = tempSectionsE0.ITEM_CALCULATION_CODE
    ) RES_ITEM_CALCULATION


-- Comments
,DECODE(tempSectionsE0.ENABLE_ITEMS_FLAG ,'Y','Yes','No') RES_ENABLE_ITEM_COMMENTS


--Properties
,(CASE
    WHEN tempSectionsE0.ENABLE_ITEMS_FLAG = 'Y' AND tempSectionsE0.RATE_ITEM_FLAG = 'Y' THEN
        DECODE(tempSectionsE0.SHOW_TARGET_PERF_RTG,'Y','Yes','No')
    END) RES_TARGET_PERFORMANCE_RATING
,(CASE
    WHEN tempSectionsE0.ENABLE_ITEMS_FLAG = 'Y' THEN
        DECODE(tempSectionsE0.SHOW_SECTION_MIN_WEIGHT,'Y','Yes','No')
    END) RES_MINIMUM_WEIGHT
,(CASE
    WHEN tempSectionsE0.ENABLE_ITEMS_FLAG = 'Y' THEN
        DECODE(tempSectionsE0.SHOW_SECTION_WEIGHT,'Y','Yes','No')
    END)  RES_WEIGHT
,(CASE
    WHEN tempSectionsE0.ENABLE_ITEMS_FLAG = 'Y' THEN
        DECODE(tempSectionsE0.SHOW_MANDATORY,'Y','Yes','No')
    END) RES_REQUIRED
	
	
-- Section Content: Performance Goals
,DECODE(tempSectionsE0.USE_PROFILE_FLAG,'Y','Yes','No') RES_USE_PROFILE_RELATED_TO_WOR

,(SELECT DESCRIPTION
    FROM HRT_PROFILE_TYPES_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND PROFILE_TYPE_ID = tempSectionsE0.PROFILE_TYPE_ID
) RES_PROFILE_TYPE

,DECODE(tempSectionsE0.USE_SPEC_PROFILE_FLAG,'Y','Yes','No') RES_USE_SPECIFIC_PROFILE

,(SELECT DESCRIPTION
    FROM HRT_PROFILES_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND PROFILE_ID = tempSectionsE0.PROFILE_ID
) RES_PROFILE

,DECODE(tempSectionsE0.USE_WORKER_GOALS_FLAG,'Y','Yes','No') RES_POPULATE_WITH_WORKER_PERFO
,DECODE(tempSectionsE0.USE_SPEC_CONTENT_ITEM_FLAG,'Y','Yes','No') RES_USE_SPECIFIC_CONTENT_ITEMS
,DECODE(tempSectionsE0.SHOW_TARGET_PROF_LEVEL,'Y','Yes','No') RES_TARGET_PROFICIENCY_LEVEL
,DECODE(tempSectionsE0.USE_WRITING_ASSISTANT_FLAG,'Y','Yes','No') RES_ENABLE_WRITING_ASSISTANT_F

,tempSectionsE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,tempSectionsE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,tempSectionsE0.CREATED_BY  RSC_CREATED_BY
,tempSectionsE0.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID
  

FROM HRA_TMPL_DEFNS_VL pfTemplatesE0
,HRA_TMPL_SECTIONS tempSectionsE0
WHERE pfTemplatesE0.TEMPLATE_DEFN_ID = tempSectionsE0.TEMPLATE_DEFN_ID
ORDER BY pfTemplatesE0.NAME
,tempSectionsE0.SEQUENCE_NUMBER