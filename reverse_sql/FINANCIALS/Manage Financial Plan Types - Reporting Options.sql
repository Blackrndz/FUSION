/* ****************************************************************************
* $Revision: 78229 $:
* $Author: pisan.jariyasettachok $:
* $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
* $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Financial%20Plan%20Types%20-%20Reporting%20Options.sql $:
* $Id: Manage Financial Plan Types - Reporting Options.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
* ****************************************************************************
* Description:
* ************************************************************************** */

SELECT 	tmpEO.NAME							RES_NAME
,(CASE
	WHEN PLAN_OPTION_CODE = 'COST_AND_REV_SEP' 
	THEN (SELECT MEANING FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = tmpEO.REPORT_QUANTITY_FROM_CODE
				AND LOOKUP_TYPE = 'PJO_REP_QTY_USING') 	
	WHEN tmpEO.PLAN_OPTION_CODE = 'REVENUE_ONLY'
	THEN (SELECT MEANING FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = 'REVENUE'
				AND LOOKUP_TYPE = 'PJO_REP_QTY_USING')
	ELSE (SELECT MEANING FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = 'COST'
				AND LOOKUP_TYPE = 'PJO_REP_QTY_USING')
			END) RES_REPORT_QUANTITY_USING
,(CASE
	WHEN tmpEO.PLAN_OPTION_CODE != 'REVENUE_ONLY'
	THEN (SELECT MEANING FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = tmpEO.MARGIN_DERIVED_FROM_CODE
				AND LOOKUP_TYPE = 'PJO_MARGIN_DERIVED_FROM_CODE') 		
			END) RES_REPORT_COST	
,tmpEO.FACTOR_BY_CODE		RES_AMOUNT_SCALE
,(SELECT MEANING FROM FND_LOOKUPS
	WHERE LOOKUP_CODE = tmpEO.CURRENCY_TYPE
		AND LOOKUP_TYPE = 'PJO_REP_CURRENCY_TYPE') 					RES_CURRENCY_TYPE
,tmpEO.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,tmpEO.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,tmpEO.CREATED_BY  RSC_CREATED_BY
,tmpEO.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM
((SELECT pjoPlanTypeEO.PLAN_OPTION_CODE
,pjoPlanTypeEO.NAME
,pjoPlanTypeEO.REPORT_QUANTITY_FROM_CODE
,pjoPlanOptionEO.MARGIN_DERIVED_FROM_CODE 
,pjoPlanOptionEO.FACTOR_BY_CODE
,pjoPlanOptionEO.CURRENCY_TYPE
,pjoPlanOptionEO.LAST_UPDATED_BY
,pjoPlanOptionEO.LAST_UPDATE_DATE
,pjoPlanOptionEO.CREATED_BY
,pjoPlanOptionEO.CREATION_DATE
FROM PJO_PLAN_TYPES_VL pjoPlanTypeEO
,PJO_PLANNING_OPTIONS pjoPlanOptionEO
WHERE pjoPlanTypeEO.PLAN_TYPE_CODE = 'FINANCIAL_PLAN'
AND pjoPlanTypeEO.PLAN_TYPE_ID = pjoPlanOptionEO.PLAN_TYPE_ID
AND pjoPlanOptionEO.PLAN_OPTION_LEVEL_CODE = 'PLAN_TYPE'
AND pjoPlanOptionEO.PROJECT_ID = 0
AND pjoPlanOptionEO.PLANNED_FOR_CODE != 'REVENUE')
UNION
(SELECT pjoPlanTypeEO.PLAN_OPTION_CODE
,pjoPlanTypeEO.NAME
,pjoPlanTypeEO.REPORT_QUANTITY_FROM_CODE
,pjoPlanOptionEO.MARGIN_DERIVED_FROM_CODE
,pjoPlanOptionEO.FACTOR_BY_CODE
,pjoPlanOptionEO.CURRENCY_TYPE
,pjoPlanOptionEO.LAST_UPDATED_BY
,pjoPlanOptionEO.LAST_UPDATE_DATE
,pjoPlanOptionEO.CREATED_BY
,pjoPlanOptionEO.CREATION_DATE
 FROM PJO_PLAN_TYPES_VL pjoPlanTypeEO
,PJO_PLANNING_OPTIONS pjoPlanOptionEO
WHERE pjoPlanTypeEO.PLAN_TYPE_CODE = 'FINANCIAL_PLAN'
AND pjoPlanTypeEO.PLAN_TYPE_ID = pjoPlanOptionEO.PLAN_TYPE_ID
AND pjoPlanOptionEO.PLAN_OPTION_LEVEL_CODE = 'PLAN_TYPE'
AND pjoPlanTypeEO.PLAN_OPTION_CODE = 'REVENUE_ONLY'
AND pjoPlanOptionEO.PROJECT_ID = 0)) tmpEO


