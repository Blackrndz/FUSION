/* ****************************************************************************
 * $Revision: 56510 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2016-07-06 09:21:36 +0700 (Wed, 06 Jul 2016) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/reverse_sql/FINANCIALS/Manage%20Locations%20(United%20States)%20-%20Manage%20Locations.sql $:
 * $Id: Manage Locations (United States) - Manage Locations.sql 56510 2016-07-06 02:21:36Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
--RSC_PREREQUISITE_OBJECTS=PAY_COST_ALLOC_ACCOUNTS 
 
SELECT jobsE0.NAME RES_POSITION
,TO_CHAR(costsE0.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,jobsE0.POSITION_CODE RES_CODE
,costAccsE0.PROPORTION*100 RES_PERCENTAGE 
,costAccsE0.SEGMENT1 RES_COST_ACCOUNT_1
,costAccsE0.SEGMENT2 RES_COST_ACCOUNT_2
,costAccsE0.SEGMENT3 RES_COST_ACCOUNT_3
,costAccsE0.SEGMENT4 RES_COST_ACCOUNT_4
,costAccsE0.SEGMENT5 RES_COST_ACCOUNT_5
/*,costAccsE0.SEGMENT6 RES_COST_ACCOUNT_6
,costAccsE0.SEGMENT7 RES_COST_ACCOUNT_7
,costAccsE0.SEGMENT8 RES_COST_ACCOUNT_8
,costAccsE0.SEGMENT9 RES_COST_ACCOUNT_9
,costAccsE0.SEGMENT10 RES_COST_ACCOUNT_10
,costAccsE0.SEGMENT11 RES_COST_ACCOUNT_11
,costAccsE0.SEGMENT12 RES_COST_ACCOUNT_12
,costAccsE0.SEGMENT13 RES_COST_ACCOUNT_13
,costAccsE0.SEGMENT14 RES_COST_ACCOUNT_14
,costAccsE0.SEGMENT15 RES_COST_ACCOUNT_15
,costAccsE0.SEGMENT16 RES_COST_ACCOUNT_16
,costAccsE0.SEGMENT17 RES_COST_ACCOUNT_17
,costAccsE0.SEGMENT18 RES_COST_ACCOUNT_18
,costAccsE0.SEGMENT19 RES_COST_ACCOUNT_19
,costAccsE0.SEGMENT20 RES_COST_ACCOUNT_20
,costAccsE0.SEGMENT21 RES_COST_ACCOUNT_21
,costAccsE0.SEGMENT22 RES_COST_ACCOUNT_22
,costAccsE0.SEGMENT23 RES_COST_ACCOUNT_23
,costAccsE0.SEGMENT24 RES_COST_ACCOUNT_24
,costAccsE0.SEGMENT25 RES_COST_ACCOUNT_25
,costAccsE0.SEGMENT26 RES_COST_ACCOUNT_26
,costAccsE0.SEGMENT27 RES_COST_ACCOUNT_27
,costAccsE0.SEGMENT28 RES_COST_ACCOUNT_28
,costAccsE0.SEGMENT29 RES_COST_ACCOUNT_29
,costAccsE0.SEGMENT30 RES_COST_ACCOUNT_30*/
,costAccsE0.ID_FLEX_NUM RSC_EXTRA_COLUMN1
,costAccsE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,costAccsE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,costAccsE0.CREATED_BY  RSC_CREATED_BY
,costAccsE0.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID


FROM HR_ALL_POSITIONS_F_VL jobsE0
,(SELECT *
    FROM PAY_COST_ALLOCATIONS_F
    WHERE SOURCE_TYPE = 'POS'
    ) costsE0
,PAY_COST_ALLOC_ACCOUNTS costAccsE0

WHERE jobsE0.POSITION_ID = costsE0.SOURCE_ID
AND SYSDATE BETWEEN jobsE0.EFFECTIVE_START_DATE AND jobsE0.EFFECTIVE_END_DATE
AND costsE0.COST_ALLOCATION_RECORD_ID = costAccsE0.COST_ALLOCATION_RECORD_ID
ORDER BY jobsE0.NAME
,jobsE0.POSITION_CODE
