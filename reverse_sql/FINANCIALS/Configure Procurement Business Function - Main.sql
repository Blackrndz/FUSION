/* ****************************************************************************
 * $Revision: 80270 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2023-02-22 15:41:00 +0700 (Wed, 22 Feb 2023) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Configure%20Procurement%20Business%20Function%20-%20Main.sql $:
 * $Id: Configure Procurement Business Function - Main.sql 80270 2023-02-22 08:41:00Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- RSC_PREREQUISITE_OBJECTS=PO_SYSTEM_PARAMETERS_ALL
 
/*Cannot find RES_SAVE_VALUE_AS_DEFAULT, RES_PROSPECTIVE_SUPPLIER_REGIS and RES_SPEND_AUTHORIZED_SUPPLIER_ on 26-Oct-2016*/
SELECT BusinessUnitUsagePEO.BU_NAME RES_PROCUREMENT_BU
,'' RES_SAVE_VALUE_AS_DEFAULT
,PaymentTermHeaderPEO.NAME RES_PAYMENT_TERMS
,(SELECT DISTINCT(
		CASE
			WHEN PurchasingSystemParameterEO.SERVICE_LEVEL IS NOT NULL
			THEN PartyEO.PARTY_NAME||'-'||
				(SELECT MEANING
				FROM RCS_LOOKUPS
				WHERE LOOKUP_TYPE                             = 'WSH_SERVICE_LEVELS'
				AND PurchasingSystemParameterEO.SERVICE_LEVEL = LOOKUP_CODE
				) ||'-'||
				(SELECT MEANING
				FROM RCS_LOOKUPS
				WHERE LOOKUP_TYPE                                 = 'WSH_MODE_OF_TRANSPORT'
				AND PurchasingSystemParameterEO.MODE_OF_TRANSPORT = LOOKUP_CODE
				)
			ELSE PartyEO.PARTY_NAME
		END)
	FROM WSH_CARRIERS CarrierEO
	,HZ_PARTIES PartyEO
	,WSH_ORG_CARRIER_SERVICES WarehouseCarrierServiceEO
	WHERE CarrierEO.CARRIER_ID                     = PartyEO.PARTY_ID
	AND CarrierEO.CARRIER_ID                       = WarehouseCarrierServiceEO.CARRIER_ID(+)
	AND CarrierEO.CARRIER_ID                       = PurchasingSystemParameterEO.CARRIER_ID
	AND WarehouseCarrierServiceEO.ORGANIZATION_ID IS NULL
	) RES_SHIPPING_METHOD
,(SELECT DISTINCT PartyEO.PARTY_NAME
	FROM WSH_CARRIERS CarrierEO
	,HZ_PARTIES PartyEO
	,WSH_ORG_CARRIER_SERVICES WarehouseCarrierServiceEO
	WHERE CarrierEO.CARRIER_ID                     = PartyEO.PARTY_ID
	AND CarrierEO.CARRIER_ID                       = WarehouseCarrierServiceEO.CARRIER_ID(+)
	AND CarrierEO.CARRIER_ID                       = PurchasingSystemParameterEO.CARRIER_ID
	AND WarehouseCarrierServiceEO.ORGANIZATION_ID IS NULL
	) RES_SHIPPING_METHOD_CARRIER
,(SELECT MEANING
	FROM RCS_LOOKUPS
	WHERE LOOKUP_TYPE                                 = 'WSH_MODE_OF_TRANSPORT'
	AND PurchasingSystemParameterEO.MODE_OF_TRANSPORT = LOOKUP_CODE
	) RES_SHIPPING_METHOD_MODE_OF_TR
,(SELECT MEANING
	FROM RCS_LOOKUPS
	WHERE LOOKUP_TYPE                             = 'WSH_SERVICE_LEVELS'
	AND PurchasingSystemParameterEO.SERVICE_LEVEL = LOOKUP_CODE
	) RES_SHIPPING_METHOD_SERVICE_LE
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'FREIGHT TERMS'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.FREIGHT_TERMS_LOOKUP_CODE
	) RES_FREIGHT_TERMS
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'FOB'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.FOB_LOOKUP_CODE
	) RES_FOB
,DECODE(PurchasingSystemParameterEO.BUYER_MANAGED_TRANSPORT_FLAG,'Y','Yes','No') RES_BUYER_MANAGED_TRANSPORTATI
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'PRICE BREAK TYPE'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.PRICE_BREAK_LOOKUP_CODE
	) RES_PRICE_BREAK_TYPE
,PersonNameDPEO.FULL_NAME RES_BUYER
,OrgOrganizationDefPEO.ORGANIZATION_CODE RES_INVENTORY_ORGANIZATION_COD
,OrgOrganizationDefPEO.ORGANIZATION_NAME RES_INVENTORY_ORGANIZATION_NAM
,PurchasingLineTypePEO.LINE_TYPE RES_LINE_TYPE
,PurchasingSystemParameterEO.CURRENCY_CODE RES_CURRENCY
,GlDailyConversionTypes.USER_CONVERSION_TYPE RES_CONVERSION_RATE_TYPE
,LanguagePEO.DESCRIPTION||' '||LanguagePEO.LANGUAGE_CODE RES_PREFERRED_LANGUAGE
,'' RES_PROSPECTIVE_SUPPLIER_REGIS
,'' RES_SPEND_AUTHORIZED_SUPPLIER_
,PurchasingSystemParameterEO.MAX_ATTACHMENT_SIZE RES_MAXIMUM_FILE_SIZE_MEGABYTE
,PurchasingSystemParameterEO.MAX_LINES_ON_PDF RES_MAXIMUM_LINES_IN_PDF
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'RETROACTIVE_PRICING_ACCESS'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.ALLOW_RETRO_PRICING
	) RES_ALLOW_RETROACTIVE_PRICING
,PurchasingSystemParameterEO.RECEIVE_CLOSE_TOLERANCE RES_RECEIPT_CLOSE_TOLERANCE_PE
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'RECEIVE CLOSE'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.RECEIVE_CLOSE_CODE
	) RES_RECEIPT_CLOSE_POINT
,PurchasingSystemParameterEO.INVOICE_CLOSE_TOLERANCE RES_INVOICE_CLOSE_TOLERANCE_PE
,(
	CASE
		WHEN PurchasingSystemParameterEO.RECEIVING_FLAG          = 'N'
		AND PurchasingSystemParameterEO.INSPECTION_REQUIRED_FLAG = 'N'
		THEN '2 Way'
		WHEN PurchasingSystemParameterEO.RECEIVING_FLAG          = 'Y'
		AND PurchasingSystemParameterEO.INSPECTION_REQUIRED_FLAG = 'N'
		THEN '3 Way'
		WHEN PurchasingSystemParameterEO.RECEIVING_FLAG          = 'Y'
		AND PurchasingSystemParameterEO.INSPECTION_REQUIRED_FLAG = 'Y'
		THEN '4 Way'
	END) RES_MATCH_APPROVAL_LEVEL
,DECODE(PurchasingSystemParameterEO.ALLOW_MANUL_PRICE_UPDATE_ORDER,'Y','Yes','No') RES_ALLOW_MANUAL_PRICE_UPDATE_
,DECODE(PurchasingSystemParameterEO.DEFAULT_PROMISE_DATE,'Y','Yes','No') RES_DEFAULT_PROMISED_DATE_FROM
,DECODE(PurchasingSystemParameterEO.ENFORCE_VENDOR_HOLD_FLAG,'Y','Yes','No') RES_ENFORCE_SUPPLIER_HOLD
,DECODE(PurchasingSystemParameterEO.GEN_ORDER_FOR_NEG_REQS_FLAG,'Y','Yes','No') RES_AUTOGENERATE_ORDERS_FROM_R
,DECODE(PurchasingSystemParameterEO.BYPASS_APPROVAL_FLAG,'Y','Yes','No') RES_BYPASS_APPROVALS_FOR_AUTOM
,DECODE(PurchasingSystemParameterEO.COMMUNICATE_CO_FLAG ,'Y','Yes','No') RES_COMMUNICATE_PURCHASE_ORDER
,DECODE(PurchasingSystemParameterEO.COMMUNICATE_PA_FLAG ,'Y','Yes','No') RES_COMMUNICATE_PURCHASE_AGREE
,DECODE(PurchasingSystemParameterEO.AUTO_SOURCING_FLAG ,'Y','Yes','No') RES_ENABLE_AUTOMATIC_SOURCING_
,DECODE(PurchasingSystemParameterEO.PUNCHOUT_SOURCING_ONLY_FLAG ,'Y','Yes','No') RES_PUNCHOUT_REQUESTS_ONLY
,DECODE(PurchasingSystemParameterEO.GENERATE_ORDERS_AUTOMATIC ,'Y','Yes','No') RES_AUTOGENERATE_ORDERS_FROM_0
,DECODE(PurchasingSystemParameterEO.SUBMIT_APPROVAL_AUTOMATIC ,'Y','Yes','No') RES_AUTOMATICALLY_SUBMIT_FOR_A

,DECODE(PurchasingSystemParameterEO.GROUP_REQUISITIONS,'Y','Yes','No') RES_GROUP_REQUISITIONS
,DECODE(PurchasingSystemParameterEO.USE_SALES_ORDER_NUMBER_FLAG,'Y','Yes','No') RES_USE_CUSTOMER_SALES_ORDER
,DECODE(PurchasingSystemParameterEO.USE_SHIP_TO_FOR_GROUP_REQS,'Y','Yes','No') RES_USE_SHIP_TO_LOCATION
,DECODE(PurchasingSystemParameterEO.GROUP_REQUISITION_LINES,'Y','Yes','No') RES_GROUP_REQUISITION_LINES
,DECODE(PurchasingSystemParameterEO.USE_NEED_BY_DATE,'Y','Yes','No') RES_USE_REQUESTED_DATE
,DECODE(PurchasingSystemParameterEO.USE_SHIP_TO,'Y','Yes','No') RES_USE_SHIP_TO_ORGANIZATION_A
,DECODE(PurchasingSystemParameterEO.ALLOW_ITEM_DESC_UPDATE_FLAG,'Y','Yes','No') RES_ALLOW_ITEM_DESCRIPTION_UPD

,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'AGING_ONSET_POINT'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.AGING_ONSET_POINT
	) RES_AGING_ONSET_POINT
,PurchasingSystemParameterEO.AGING_PERIOD_DAYS RES_AGING_PERIOD_DAYS
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'CONSUMPTION_ADVICE_FREQUENCY'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.CONSUMPTION_ADVICE_FREQUENCY
	) RES_CONSUMPTION_ADVICE_FREQUEN
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'CONSUMPTION_ADVICE_SUMMARY'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.CONSUMPTION_ADVICE_SUMMARY
	) RES_CONSUMPTION_ADVICE_SUMMARY
,(SELECT NEGOTIATION_DISPLAY_NAME
	FROM PON_DOCTYPE_STYLES_VL
	WHERE STYLE_ID = PurchasingSystemParameterEO.STYLE_ID
	AND DOCTYPE_ID = PurchasingSystemParameterEO.DOCTYPE_ID
	) RES_NEGOTIATION_TYPE
,(SELECT STYLE_NAME
	FROM PON_NEGOTIATION_STYLES_TL
	WHERE STYLE_ID = PurchasingSystemParameterEO.STYLE_ID
	AND LANGUAGE = USERENV('LANG')
	) RES_NEGOTIATION_STYLE
,DECODE(PurchasingSystemParameterEO.ENFORCE_TEMPLATE_FLAG,'Y','Yes','No') RES_NEGOTIATION_TEMPLATE_REQUI
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES_VL
	WHERE LOOKUP_TYPE = 'PON_RANK_INDICATOR_CODE'
	AND LOOKUP_CODE   = PurchasingSystemParameterEO.RANK_INDICATOR
	) RES_RANK_INDICATOR
,PurchasingSystemParameterEO.HDR_ATTR_DEFAULT_MAX_SCORE RES_MAXIMUM_REQUIREMENT_SCORE
,(SELECT MEANING 
	FROM FND_LOOKUP_VALUES
	WHERE LOOKUP_TYPE = 'ORA_PON_PURCHASING_DOC_OPTION'
	AND LOOKUP_CODE = PurchasingSystemParameterEO.PO_CREATION_PROCESS
	AND LANGUAGE = USERENV('LANG')
	) RES_PURCHASING_DOCUMENTS
,DECODE(PurchasingSystemParameterEO.INITIATE_APPROVAL_ENABLED_FLAG,'Y','Yes','No') RES_INITIATE_APPROVAL
,DECODE(PurchasingSystemParameterEO.HDR_ATTR_ENABLE_WEIGHTS,'Y','Yes','No') RES_ENABLE_WEIGHTS_IN_REQUIREM 
,DECODE(PurchasingSystemParameterEO.HDR_ATTR_DISP_SCORE_CRITERIA,'Y','Yes','No') RES_DISPLAY_REQUIREMENT_SCORIN 
,DECODE(PurchasingSystemParameterEO.RANK_VISIBLE_BLIND,'Y','Yes','No') RES_DISPLAY_RANK_IN_BLIND_NEGO
,DECODE(PurchasingSystemParameterEO.BEST_PRICE_VISIBLE_BLIND,'Y','Yes','No') RES_DISPLAY_BEST_PRICE_IN_BLIN
,DECODE(PurchasingSystemParameterEO.ENFORCE_MIN_BID_PRICE,'Y','Yes','No') RES_ENFORCE_SUPPLIERS_PREVIOUS
,DECODE(PurchasingSystemParameterEO.NEG_APPROVAL_ENABLED_FLAG,'Y','Yes','No') RES_ENABLE_NEGOTIATION_APPROVA
,DECODE(PurchasingSystemParameterEO.AWARD_APPROVAL_ENABLED_FLAG,'Y','Yes','No') RES_ENABLE_AWARD_APPROVAL 
,DECODE(PurchasingSystemParameterEO.SOURCING_SUPP_ELIGIBILITY_FLAG ,'Y','Yes','No')  RES_INVITE_ONLY_SOURCING_ELIGI
,PurchasingSystemParameterEO.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,PurchasingSystemParameterEO.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,PurchasingSystemParameterEO.CREATED_BY  RSC_CREATED_BY
,PurchasingSystemParameterEO.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,PurchasingSystemParameterEO.PRC_BU_ID RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID
   
FROM PO_SYSTEM_PARAMETERS_ALL PurchasingSystemParameterEO
,FUN_BU_USAGES_V BusinessUnitUsagePEO
,AP_TERMS_VL PaymentTermHeaderPEO
,PER_PERSON_NAMES_F_V PersonNameDPEO
,INV_ORGANIZATION_DEFINITIONS_V OrgOrganizationDefPEO
,PO_LINE_TYPES_VL PurchasingLineTypePEO
,GL_DAILY_CONVERSION_TYPES GlDailyConversionTypes
,FND_LANGUAGES_VL LanguagePEO
WHERE PurchasingSystemParameterEO.PRC_BU_ID               = BusinessUnitUsagePEO.BUSINESS_UNIT_ID
AND BusinessUnitUsagePEO.MODULE_ID                        = 110
AND BusinessUnitUsagePEO.MODULE_KEY                       = 'PROCUREMENT_BF'
AND PurchasingSystemParameterEO.TERMS_ID                  = PaymentTermHeaderPEO.TERM_ID(+)
AND PurchasingSystemParameterEO.DEFAULT_BUYER_ID          = PersonNameDPEO.PERSON_ID(+)
AND PurchasingSystemParameterEO.INVENTORY_ORGANIZATION_ID = OrgOrganizationDefPEO.ORGANIZATION_ID(+)
AND PurchasingSystemParameterEO.LINE_TYPE_ID              = PurchasingLineTypePEO.LINE_TYPE_ID(+)
AND PurchasingSystemParameterEO.DEFAULT_RATE_TYPE         = GlDailyConversionTypes.CONVERSION_TYPE(+)
AND PurchasingSystemParameterEO.LANGUAGE_CODE             = LanguagePEO.LANGUAGE_CODE(+)
ORDER BY BusinessUnitUsagePEO.BU_NAME