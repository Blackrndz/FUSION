/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Payables%20Calendars%20-%20Payables%20Calendar.sql $:
 * $Id: Manage Payables Calendars - Payables Calendar.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
 
SELECT QRSLT.CALENDAR_NAME RES_NAME
, QRSLT.DESCRIPTION RES_DESCRIPTION
, QRSLT.CALENDAR_TYPE_MEANING RES_CALENDAR_TYPE
, QRSLT.PERIOD_FREQUENCY_MEANING  RES_PERIOD_FREQUENCY
, QRSLT.PERIODS_PER_YEAR RES_PERIODS_PER_YEAR
, TO_CHAR(QRSLT.START_DATE,'DD-Mon-YYYY') RES_START_DATE
, DECODE(QRSLT.PERIOD_NAME_FORMAT,'QUARTER', 'Quarter','WEEK','Week',QRSLT.PERIOD_NAME_FORMAT) RES_PERIOD_NAME_FORMAT
, TO_CHAR(QRSLT.EFFECTIVE_FROM,'DD-Mon-YYYY') RES_FROM_DATE
, TO_CHAR(QRSLT.EFFECTIVE_TO,'DD-Mon-YYYY') RES_TO_DATE
,QRSLT.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,QRSLT.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,QRSLT.CREATED_BY  RSC_CREATED_BY
,QRSLT.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM
	(SELECT distinct ApOtherPeriodTypes.LAST_UPDATED_BY
	,ApOtherPeriodTypes.PERIODS_PER_YEAR
	,ApOtherPeriodTypes.CALENDAR_NAME
	,ApOtherPeriodTypes.LAST_UPDATE_DATE
	,APOTHERPERIODTYPES.CALENDAR_TYPE
	,(SELECT meaning
		FROM FND_LOOKUP_VALUES
		WHERE LOOKUP_TYPE = 'MODULE'
		AND LOOKUP_CODE   = APOTHERPERIODTYPES.CALENDAR_TYPE
		and language = userenv('LANG')
		) CALENDAR_TYPE_meaning
	,ApOtherPeriodTypes.DESCRIPTION
	,ApOtherPeriodTypes.LAST_UPDATE_LOGIN	
	,ApOtherPeriodTypes.CREATED_BY
	,ApOtherPeriodTypes.CREATION_DATE
	,APOTHERPERIODTYPES.OBJECT_VERSION_NUMBER
	,APOTHERPERIODTYPES.PERIOD_FREQUENCY
	,(SELECT meaning
		FROM FND_LOOKUP_VALUES
		WHERE LOOKUP_TYPE = 'PERIOD FREQUENCY'
		AND LOOKUP_CODE   = APOTHERPERIODTYPES.PERIOD_FREQUENCY
		and language = userenv('LANG')
		) PERIOD_FREQUENCY_meaning
	,ApOtherPeriodTypes.START_DATE
	,ApOtherPeriodTypes.EFFECTIVE_FROM
	,ApOtherPeriodTypes.EFFECTIVE_TO
	,ApOtherPeriodTypes.PERIOD_NAME_FORMAT
	FROM AP_OTHER_PERIOD_TYPES APOTHERPERIODTYPES 
	) QRSLT
		ORDER BY QRSLT.CALENDAR_NAME
	,QRSLT.CALENDAR_TYPE_MEANING