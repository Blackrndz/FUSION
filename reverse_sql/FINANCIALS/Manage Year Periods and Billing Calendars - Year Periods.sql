/* ****************************************************************************
* $Revision: 78229 $:
* $Author: pisan.jariyasettachok $:
* $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
* $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Year%20Periods%20and%20Billing%20Calendars%20-%20Year%20Periods.sql $:
* $Id: Manage Year Periods and Billing Calendars - Year Periods.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
* ****************************************************************************
* Description:
* ************************************************************************** */
WITH tmpEO AS (SELECT START_DATE,ROW_NUMBER() OVER (ORDER BY START_DATE) AS ROW_NUMBER FROM BEN_YR_PERD) 

SELECT 'Single' RES_YEAR_PERIOD_OPTION
,TO_CHAR(benYRPEO.START_DATE,'DD-Mon-YYYY') RES_START_DATE
,TO_CHAR(benYRPEO.END_DATE,'DD-Mon-YYYY') RES_END_DATE
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = benYRPEO.PERD_TYP_CD
	AND LOOKUP_TYPE = 'BEN_PERD_TYP' AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_PERIOD_TYPE
,TO_CHAR(benYRPEO.LMTN_YR_STRT_DT,'DD-Mon-YYYY') RES_LIMITATION_YEAR_START_DATE
,TO_CHAR(benYRPEO.LMTN_YR_END_DT,'DD-Mon-YYYY') RES_LIMITATION_YEAR_END_DATE
,NULL RES_START_YEAR
,NULL RES_NUMBER_OF_CALENDAR_YEARS

, benYRPEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
, benYRPEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
, benYRPEO.CREATED_BY RSC_CREATED_BY
, benYRPEO.CREATION_DATE RSC_CREATION_DATE
, NULL RSC_LEDGER_ID
, NULL RSC_CHART_OF_ACCOUNTS_ID
, NULL RSC_BUSINESS_UNIT_ID
, NULL RSC_LEGAL_ENTITY_ID
, NULL RSC_ORGANIZATION_ID
, NULL RSC_BUSINESS_GROUP_ID
, NULL RSC_ENTERPRISE_ID
, NULL RSC_COUNTRY_ID

FROM BEN_YR_PERD benYRPEO
ORDER BY RES_START_DATE DESC