/* ****************************************************************************
 * $Revision$:
 * $Author$:
 * $Date$:
 * $HeadURL$:
 * $Id$:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 

--RSC_PREREQUISITE_OBJECTS=FINANCIALS_SYSTEM_PARAMS_ALL
 
-- syntax: APPLICATION_ID##RES##DFF_CODE (Descriptive Flexfield name)
-- DFF_LOGIC_TO_APPLY=7003##RES##JGxFinancialsSystemParams
-- DFF_ATTRIBUTES=GLOBAL_ATTRIBUTE,GLOBAL_ATTRIBUTE_NUMBER,GLOBAL_ATTRIBUTE_DATE

-- IMPORTANT:
-- - the alias names for the Foreign keys must be the same as in the inventory.
-- - the alias name for context code must be RES_CONTEXT_CODE
-- - NO ALIASES for atributes fields.

SELECT FAB.BU_NAME RES_BUSINESS_UNIT
,F.GLOBAL_ATTRIBUTE_CATEGORY RES_CONTEXT_CODE
,F.GLOBAL_ATTRIBUTE1 
,F.GLOBAL_ATTRIBUTE2
,F.GLOBAL_ATTRIBUTE3
,F.GLOBAL_ATTRIBUTE4
,F.GLOBAL_ATTRIBUTE5
,F.GLOBAL_ATTRIBUTE6
,F.GLOBAL_ATTRIBUTE7
,F.GLOBAL_ATTRIBUTE8
,F.GLOBAL_ATTRIBUTE9
,F.GLOBAL_ATTRIBUTE10
,F.GLOBAL_ATTRIBUTE11
,F.GLOBAL_ATTRIBUTE12
,F.GLOBAL_ATTRIBUTE13
,F.GLOBAL_ATTRIBUTE14
,F.GLOBAL_ATTRIBUTE15
,F.GLOBAL_ATTRIBUTE16
,F.GLOBAL_ATTRIBUTE17
,F.GLOBAL_ATTRIBUTE18
,F.GLOBAL_ATTRIBUTE19
,F.GLOBAL_ATTRIBUTE20
,F.GLOBAL_ATTRIBUTE_NUMBER1
,F.GLOBAL_ATTRIBUTE_NUMBER2
,F.GLOBAL_ATTRIBUTE_NUMBER3
,F.GLOBAL_ATTRIBUTE_NUMBER4
,F.GLOBAL_ATTRIBUTE_NUMBER5
,TO_CHAR(F.GLOBAL_ATTRIBUTE_DATE1,'DD-Mon-YYYY') GLOBAL_ATTRIBUTE_DATE1
,TO_CHAR(F.GLOBAL_ATTRIBUTE_DATE2,'DD-Mon-YYYY') GLOBAL_ATTRIBUTE_DATE2
,TO_CHAR(F.GLOBAL_ATTRIBUTE_DATE3,'DD-Mon-YYYY') GLOBAL_ATTRIBUTE_DATE3
,TO_CHAR(F.GLOBAL_ATTRIBUTE_DATE4,'DD-Mon-YYYY') GLOBAL_ATTRIBUTE_DATE4
,TO_CHAR(F.GLOBAL_ATTRIBUTE_DATE5,'DD-Mon-YYYY') GLOBAL_ATTRIBUTE_DATE5


,f.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,f.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,f.CREATED_BY  RSC_CREATED_BY
,f.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,f.ORG_ID RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

from FUSION.FINANCIALS_SYSTEM_PARAMS_ALL F,
FUSION.FUN_ALL_BUSINESS_UNITS_V FAB
where F.ORG_ID = FAB.BU_ID
AND F.ACCTS_PAY_CODE_COMBINATION_ID IS NOT NULL
AND F.PREPAY_CODE_COMBINATION_ID IS NOT NULL

AND (F.GLOBAL_ATTRIBUTE_CATEGORY IS NOT NULL OR
F.GLOBAL_ATTRIBUTE1 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE2 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE3 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE4 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE5 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE6 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE7 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE8 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE9 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE10 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE11 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE12 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE13 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE14 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE15 IS NOT NULL OR
F.GLOBAL_ATTRIBUTE16 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE17 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE18 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE19 IS NOT NULL OR
F.GLOBAL_ATTRIBUTE20 IS NOT NULL OR
F.GLOBAL_ATTRIBUTE_NUMBER1 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE_NUMBER2 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE_NUMBER3 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE_NUMBER4 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE_NUMBER5 IS NOT NULL OR
F.GLOBAL_ATTRIBUTE_DATE1 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE_DATE2 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE_DATE3 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE_DATE4 IS NOT NULL OR 
F.GLOBAL_ATTRIBUTE_DATE5 IS NOT NULL )
order by RES_BUSINESS_UNIT