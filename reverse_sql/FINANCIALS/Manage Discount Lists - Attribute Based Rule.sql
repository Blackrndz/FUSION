 /* ****************************************************************************
 * $Revision: 79396 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2022-09-26 15:18:23 +0700 (Mon, 26 Sep 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Discount%20Lists%20-%20Attribute%20Based%20Rule.sql $:
 * $Id: Manage Discount Lists - Attribute Based Rule.sql 79396 2022-09-26 08:18:23Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

-- RSC_PREREQUISITE_OBJECTS=QP_DISCOUNT_LISTS_TL 
-- RSC_PREREQUISITE_OBJECTS=QP_DISCOUNT_LISTS_ALL_B 
-- RSC_PREREQUISITE_OBJECTS=QP_MATRIX_INHERITED_DIMENSIONS
-- RSC_PREREQUISITE_OBJECTS=QP_MATRIX_DIMENSIONS_TL
-- RSC_PREREQUISITE_OBJECTS=QP_MATRIX_DIMENSIONS_B
-- RSC_PREREQUISITE_OBJECTS=QP_DISCOUNT_LIST_ITEMS
-- RSC_PREREQUISITE_OBJECTS=QP_PRICING_TERMS_VL
-- RSC_PREREQUISITE_OBJECTS=QP_MATRIX_RULES
-- RSC_PREREQUISITE_OBJECTS=QP_PRICING_BASIS_TL
-- RSC_PREREQUISITE_OBJECTS=QP_PRICING_STRATEGIES_TL

WITH RESULT1 AS 
	(SELECT *
	FROM (SELECT QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_NAME
		,QpMatrixDimensionsBE0.DATA_TYPE_CODE
		,QpMatrixDimensionsBE0.DISPLAY_SEQUENCE_NUM
		,QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_ID
		,QpMatrixInteritedDimensionsE0.MAP_TO_RULE_COL_NUM
		,QpMatrixDimensionsBE0.DOMAIN_TYPE_CODE
		,QpMatrixDimensionsBE0.DOMAIN_LOOK_UP_CODE
		,QpMatrixDimensionsBE0.DOMAIN_VO_NAME
		,ROW_NUMBER() OVER (PARTITION BY QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_ID ORDER BY QpMatrixDimensionsBE0.DISPLAY_SEQUENCE_NUM,QpMatrixInteritedDimensionsE0.MAP_TO_RULE_COL_NUM) QPNUM
		FROM QP_MATRIX_INHERITED_DIMENSIONS QpMatrixInteritedDimensionsE0
		,QP_MATRIX_DIMENSIONS_TL QpMatrixDimensionsTLE0
		,QP_MATRIX_DIMENSIONS_B QpMatrixDimensionsBE0
		WHERE QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_DIMENSION_ID = QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_ID
		AND QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_ID = QpMatrixDimensionsBE0.DYNAMIC_MATRIX_DIMENSION_ID
		AND QpMatrixDimensionsBE0.DIMENSION_TYPE = 'Result'
		AND QpMatrixDimensionsTLE0.LANGUAGE = USERENV('LANG'))
	WHERE QPNUM = 1)
,RESULT2 AS 
	(SELECT *
	FROM (SELECT QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_NAME
		,QpMatrixDimensionsBE0.DATA_TYPE_CODE
		,QpMatrixDimensionsBE0.DISPLAY_SEQUENCE_NUM
		,QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_ID
		,QpMatrixInteritedDimensionsE0.MAP_TO_RULE_COL_NUM
		,QpMatrixDimensionsBE0.DOMAIN_TYPE_CODE
		,QpMatrixDimensionsBE0.DOMAIN_LOOK_UP_CODE
		,QpMatrixDimensionsBE0.DOMAIN_VO_NAME
		,ROW_NUMBER() OVER (PARTITION BY QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_ID ORDER BY QpMatrixDimensionsBE0.DISPLAY_SEQUENCE_NUM,QpMatrixInteritedDimensionsE0.MAP_TO_RULE_COL_NUM) QPNUM
		FROM QP_MATRIX_INHERITED_DIMENSIONS QpMatrixInteritedDimensionsE0
		,QP_MATRIX_DIMENSIONS_TL QpMatrixDimensionsTLE0
		,QP_MATRIX_DIMENSIONS_B QpMatrixDimensionsBE0
		WHERE QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_DIMENSION_ID = QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_ID
		AND QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_ID = QpMatrixDimensionsBE0.DYNAMIC_MATRIX_DIMENSION_ID
		AND QpMatrixDimensionsBE0.DIMENSION_TYPE = 'Result'
		AND QpMatrixDimensionsTLE0.LANGUAGE = USERENV('LANG'))
	WHERE QPNUM = 2)
,RESULT3 AS 
	(SELECT *
	FROM (SELECT QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_NAME
		,QpMatrixDimensionsBE0.DATA_TYPE_CODE
		,QpMatrixDimensionsBE0.DISPLAY_SEQUENCE_NUM
		,QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_ID
		,QpMatrixInteritedDimensionsE0.MAP_TO_RULE_COL_NUM
		,QpMatrixDimensionsBE0.DOMAIN_TYPE_CODE
		,QpMatrixDimensionsBE0.DOMAIN_LOOK_UP_CODE
		,QpMatrixDimensionsBE0.DOMAIN_VO_NAME
		,ROW_NUMBER() OVER (PARTITION BY QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_ID ORDER BY QpMatrixDimensionsBE0.DISPLAY_SEQUENCE_NUM,QpMatrixInteritedDimensionsE0.MAP_TO_RULE_COL_NUM) QPNUM
		FROM QP_MATRIX_INHERITED_DIMENSIONS QpMatrixInteritedDimensionsE0
		,QP_MATRIX_DIMENSIONS_TL QpMatrixDimensionsTLE0
		,QP_MATRIX_DIMENSIONS_B QpMatrixDimensionsBE0
		WHERE QpMatrixInteritedDimensionsE0.DYNAMIC_MATRIX_DIMENSION_ID = QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_ID
		AND QpMatrixDimensionsTLE0.DYNAMIC_MATRIX_DIMENSION_ID = QpMatrixDimensionsBE0.DYNAMIC_MATRIX_DIMENSION_ID
		AND QpMatrixDimensionsBE0.DIMENSION_TYPE = 'Result'
		AND QpMatrixDimensionsTLE0.LANGUAGE = USERENV('LANG'))
	WHERE QPNUM = 3)

SELECT QpDiscountListsTl.NAME RES_NAME
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_QP_ITEM_LEVELS'
	AND LOOKUP_CODE = QpDiscountListItems.ITEM_LEVEL_CODE
	) RES_ITEM_LEVEL
,(SELECT ITEM_NUMBER
	FROM EGP_SYSTEM_ITEMS_VL
	WHERE INVENTORY_ITEM_ID = QpDiscountListItems.ITEM_ID
	AND INVENTORY_ORGANIZATION_ID = QpDiscountListsAllB.ORG_ID
	) RES_DISCOUNT_LINES_NAME
,(SELECT UNIT_OF_MEASURE
	FROM INV_UNITS_OF_MEASURE_VL
	WHERE UOM_CODE = QpDiscountListItems.PRICING_UOM_CODE
	) RES_PRICING_UOM
,(SELECT MEANING
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'ORA_QP_RETURN_LINE_TYPES'
	AND LOOKUP_CODE = QpDiscountListItems.LINE_TYPE_CODE
	) RES_LINE_TYPE
,QpPricingTermsVl.NAME RES_RULE_NAME
,(CASE
	WHEN RESULT1.DATA_TYPE_CODE = 'STRING' THEN
		(CASE
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 1 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING1)
					ELSE
						QpMatrixRulesE0.VALUE_STRING1
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 2 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING2)
					ELSE
						QpMatrixRulesE0.VALUE_STRING2
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 3 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING3)
					ELSE
						QpMatrixRulesE0.VALUE_STRING3
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 4 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING4)
					ELSE
						QpMatrixRulesE0.VALUE_STRING4
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 5 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING5)
					ELSE
						QpMatrixRulesE0.VALUE_STRING5
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 6 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING6)
					ELSE
						QpMatrixRulesE0.VALUE_STRING6
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 7 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING7)
					ELSE
						QpMatrixRulesE0.VALUE_STRING7
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 8 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING8)
					ELSE
						QpMatrixRulesE0.VALUE_STRING8
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 9 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING9)
					ELSE
						QpMatrixRulesE0.VALUE_STRING9
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 10 THEN
				(CASE 
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT1.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING10)
					ELSE
						QpMatrixRulesE0.VALUE_STRING10
					END)
			END)
	WHEN RESULT1.DATA_TYPE_CODE = 'NUMBER' THEN
		(CASE
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 1 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER1
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER1
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER1)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 2 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER2
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER2
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER2)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 3 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER3
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER3
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER3)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 4 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER4
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER4
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER4)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 5 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER5
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER5
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER5)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 6 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER6
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER6
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER6)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 7 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER7
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER7
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER7)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 8 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER8
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER8
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER8)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 9 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER9
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER9
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER9)
					END)
			WHEN RESULT1.MAP_TO_RULE_COL_NUM = 10 THEN
				(CASE
					WHEN RESULT1.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER10
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT1.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER10
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER10)
					END)
			END)
		WHEN RESULT1.DATA_TYPE_CODE = 'DATE' THEN
			(CASE
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 1 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE1,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 2 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE2,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 3 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE3,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 4 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE4,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 5 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE5,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 6 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE6,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 7 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE7,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 8 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE8,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 9 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE9,'DD-Mon-YYYY')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 10 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE10,'DD-Mon-YYYY')
			END)
		ELSE
			(CASE
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 1 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP1,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 2 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP2,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 3 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP3,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 4 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP4,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 5 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP5,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 6 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP6,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 7 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP7,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 8 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP8,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 9 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP9,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT1.MAP_TO_RULE_COL_NUM = 10 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP10,'DD-Mon-YYYY HH24:MI:SS')
			END)
	END) RES_ADJUSTMENT_TYPE
,(CASE
	WHEN RESULT2.DATA_TYPE_CODE = 'STRING' THEN
		(CASE
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 1 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING1)
					ELSE
						QpMatrixRulesE0.VALUE_STRING1
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 2 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING2)
					ELSE
						QpMatrixRulesE0.VALUE_STRING2
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 3 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING3)
					ELSE
						QpMatrixRulesE0.VALUE_STRING3
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 4 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING4)
					ELSE
						QpMatrixRulesE0.VALUE_STRING4
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 5 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING5)
					ELSE
						QpMatrixRulesE0.VALUE_STRING5
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 6 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING6)
					ELSE
						QpMatrixRulesE0.VALUE_STRING6
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 7 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING7)
					ELSE
						QpMatrixRulesE0.VALUE_STRING7
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 8 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING8)
					ELSE
						QpMatrixRulesE0.VALUE_STRING8
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 9 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING9)
					ELSE
						QpMatrixRulesE0.VALUE_STRING9
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 10 THEN
				(CASE 
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT2.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING10)
					ELSE
						QpMatrixRulesE0.VALUE_STRING10
					END)
			END)
	WHEN RESULT2.DATA_TYPE_CODE = 'NUMBER' THEN
		(CASE
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 1 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER1
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER1
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER1)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 2 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER2
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER2
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER2)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 3 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER3
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER3
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER3)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 4 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER4
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER4
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER4)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 5 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER5
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER5
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER5)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 6 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER6
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER6
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER6)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 7 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER7
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER7
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER7)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 8 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER8
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER8
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER8)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 9 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER9
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER9
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER9)
					END)
			WHEN RESULT2.MAP_TO_RULE_COL_NUM = 10 THEN
				(CASE
					WHEN RESULT2.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER10
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT2.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER10
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER10)
					END)
			END)
		WHEN RESULT2.DATA_TYPE_CODE = 'DATE' THEN
			(CASE
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 1 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE1,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 2 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE2,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 3 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE3,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 4 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE4,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 5 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE5,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 6 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE6,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 7 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE7,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 8 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE8,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 9 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE9,'DD-Mon-YYYY')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 10 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE10,'DD-Mon-YYYY')
			END)
		ELSE
			(CASE
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 1 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP1,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 2 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP2,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 3 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP3,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 4 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP4,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 5 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP5,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 6 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP6,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 7 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP7,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 8 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP8,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 9 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP9,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT2.MAP_TO_RULE_COL_NUM = 10 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP10,'DD-Mon-YYYY HH24:MI:SS')
			END)
	END) RES_ADJUSTMENT_AMOUNT
,(CASE
	WHEN RESULT3.DATA_TYPE_CODE = 'STRING' THEN
		(CASE
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 1 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING1)
					ELSE
						QpMatrixRulesE0.VALUE_STRING1
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 2 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING2)
					ELSE
						QpMatrixRulesE0.VALUE_STRING2
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 3 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING3)
					ELSE
						QpMatrixRulesE0.VALUE_STRING3
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 4 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING4)
					ELSE
						QpMatrixRulesE0.VALUE_STRING4
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 5 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING5)
					ELSE
						QpMatrixRulesE0.VALUE_STRING5
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 6 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING6)
					ELSE
						QpMatrixRulesE0.VALUE_STRING6
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 7 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING7)
					ELSE
						QpMatrixRulesE0.VALUE_STRING7
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 8 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING8)
					ELSE
						QpMatrixRulesE0.VALUE_STRING8
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 9 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING9)
					ELSE
						QpMatrixRulesE0.VALUE_STRING9
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 10 THEN
				(CASE 
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'LOOK_UP' THEN
						(SELECT MEANING FROM FND_LOOKUPS
							WHERE LOOKUP_TYPE = RESULT3.DOMAIN_LOOK_UP_CODE
							AND LOOKUP_CODE = QpMatrixRulesE0.VALUE_STRING10)
					ELSE
						QpMatrixRulesE0.VALUE_STRING10
					END)
			END)
	WHEN RESULT3.DATA_TYPE_CODE = 'NUMBER' THEN
		(CASE
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 1 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER1
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER1
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER1)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 2 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER2
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER2
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER2)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 3 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER3
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER3
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER3)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 4 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER4
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER4
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER4)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 5 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER5
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER5
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER5)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 6 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER6
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER6
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER6)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 7 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER7
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER7
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER7)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 8 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER8
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER8
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER8)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 9 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER9
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER9
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER9)
					END)
			WHEN RESULT3.MAP_TO_RULE_COL_NUM = 10 THEN
				(CASE
					WHEN RESULT3.DOMAIN_TYPE_CODE = 'VIEW_OBJECT_QUERY' THEN
						(CASE
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingStrategyPVO' THEN
								(SELECT NAME FROM QP_PRICING_STRATEGIES_TL 
									WHERE PRICING_STRATEGY_ID = QpMatrixRulesE0.VALUE_NUMBER10
									AND LANGUAGE = USERENV('LANG'))
							WHEN RESULT3.DOMAIN_VO_NAME = 'PricingBasisPVO' THEN
								(SELECT NAME FROM QP_PRICING_BASIS_TL
									WHERE PRICING_BASIS_ID = QpMatrixRulesE0.VALUE_NUMBER10
									AND LANGUAGE = USERENV('LANG'))
							END)
					ELSE
						TO_CHAR(QpMatrixRulesE0.VALUE_NUMBER10)
					END)
			END)
		WHEN RESULT3.DATA_TYPE_CODE = 'DATE' THEN
			(CASE
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 1 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE1,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 2 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE2,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 3 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE3,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 4 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE4,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 5 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE5,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 6 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE6,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 7 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE7,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 8 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE8,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 9 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE9,'DD-Mon-YYYY')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 10 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_DATE10,'DD-Mon-YYYY')
			END)
		ELSE
			(CASE
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 1 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP1,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 2 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP2,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 3 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP3,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 4 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP4,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 5 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP5,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 6 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP6,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 7 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP7,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 8 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP8,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 9 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP9,'DD-Mon-YYYY HH24:MI:SS')
				WHEN RESULT3.MAP_TO_RULE_COL_NUM = 10 THEN
					TO_CHAR(QpMatrixRulesE0.VALUE_TIMESTAMP10,'DD-Mon-YYYY HH24:MI:SS')
			END)
	END) RES_ADJUSTMENT_BASIS
,TO_CHAR(QpMatrixRulesE0.RULE_START_DATE,'DD-Mon-YYYY HH24:MI:SS') RES_START_DATE
,TO_CHAR(QpMatrixRulesE0.RULE_END_DATE,'DD-Mon-YYYY HH24:MI:SS') RES_END_DATE

,QpPricingTermsVl.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,QpPricingTermsVl.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,QpPricingTermsVl.CREATED_BY  RSC_CREATED_BY
,QpPricingTermsVl.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,QpDiscountListsAllB.ORG_ID RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM QP_DISCOUNT_LISTS_TL QpDiscountListsTl
,QP_DISCOUNT_LISTS_ALL_B QpDiscountListsAllB
,QP_DISCOUNT_LIST_ITEMS QpDiscountListItems
,QP_PRICING_TERMS_VL QpPricingTermsVl
,QP_MATRIX_RULES QpMatrixRulesE0
,RESULT1
,RESULT2
,RESULT3
WHERE QpDiscountListsTl.DISCOUNT_LIST_ID = QpDiscountListsAllB.DISCOUNT_LIST_ID
AND QpDiscountListsTl.DISCOUNT_LIST_ID = QpDiscountListItems.DISCOUNT_LIST_ID
AND QpDiscountListItems.DISCOUNT_LIST_ITEM_ID = QpPricingTermsVl.PARENT_ENTITY_KEY_COLUMN1
AND QpPricingTermsVl.PRICING_RULE_TYPE_CODE = 'ATTRIBUTE_PRICING'
AND QpPricingTermsVl.ATTRIBUTE_PRICING_MATRIX_ID = QpMatrixRulesE0.DYNAMIC_MATRIX_ID
AND QpMatrixRulesE0.DYNAMIC_MATRIX_ID = RESULT1.DYNAMIC_MATRIX_ID(+)
AND QpMatrixRulesE0.DYNAMIC_MATRIX_ID = RESULT2.DYNAMIC_MATRIX_ID(+)
AND QpMatrixRulesE0.DYNAMIC_MATRIX_ID = RESULT3.DYNAMIC_MATRIX_ID(+)
AND QpDiscountListsTl.LANGUAGE = USERENV('LANG')
ORDER BY QpDiscountListsTl.NAME
,RES_ITEM_LEVEL
,RES_DISCOUNT_LINES_NAME
,QpPricingTermsVl.NAME