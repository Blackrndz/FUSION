/* ****************************************************************************
 * $Revision:  $:
 * $Author: Nasrullah Dusenmahamad $:
 * $Date: 2018-03-20  $:
 * $HeadURL: $:
 * $Id: Configure Exception Sets - Exception  $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

--RSC_PREREQUISITE_OBJECTS=IRC_GEO_LEVEL_MAPPINGS

SELECT geosE0.GEOGRAPHY_NAME RES_COUNTRY_NAME
,geosE0.GEOGRAPHY_CODE RES_COUNTRY_CODE
,(SELECT GEOGRAPHY_TYPE_NAME
    FROM HZ_GEOGRAPHY_TYPES_VL
    WHERE GEOGRAPHY_TYPE = lv1E0.GEOGRAPHY_TYPE
    ) RES_LEVEL_1
,(SELECT GEOGRAPHY_TYPE_NAME
    FROM HZ_GEOGRAPHY_TYPES_VL
    WHERE GEOGRAPHY_TYPE = lv2E0.GEOGRAPHY_TYPE
    ) RES_LEVEL_2
,geomapsE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,geomapsE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,geomapsE0.CREATED_BY  RSC_CREATED_BY
,geomapsE0.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID
   
FROM IRC_GEO_LEVEL_MAPPINGS geomapsE0
,(SELECT GEOGRAPHY_NAME
    ,GEOGRAPHY_CODE
    ,COUNTRY_CODE
    FROM HZ_GEOGRAPHIES
    WHERE GEOGRAPHY_TYPE = 'COUNTRY'
    ) geosE0
,HZ_GEO_STRUCTURE_LEVELS lv1E0
,HZ_GEO_STRUCTURE_LEVELS lv2E0
WHERE geomapsE0.COUNTRY_CODE = geosE0.COUNTRY_CODE
AND geomapsE0.COUNTRY_CODE = lv1E0.COUNTRY_CODE(+)
AND geomapsE0.GEO_LEVEL2_COLUMN_NAME = lv1E0.GEOGRAPHY_ELEMENT_COLUMN(+)
AND geomapsE0.COUNTRY_CODE = lv2E0.COUNTRY_CODE(+)
AND geomapsE0.GEO_LEVEL3_COLUMN_NAME = lv2E0.GEOGRAPHY_ELEMENT_COLUMN(+)
ORDER BY geosE0.GEOGRAPHY_NAME