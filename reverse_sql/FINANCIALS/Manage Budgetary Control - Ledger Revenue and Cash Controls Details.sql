/* ****************************************************************************
 * $Revision$:
 * $Author$:
 * $Date$:
 * $HeadURL$:
 * $Id$:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

--RSC_PREREQUISITE_OBJECTS=XCC_CONTROL_BUDGETS

SELECT (SELECT NAME FROM GL_LEDGERS WHERE LEDGER_ID = xccBCEBUE0.LEDGER_ID) RES_LEDGER_NAME
,(SELECT BU_NAME
	FROM FUN_ALL_BUSINESS_UNITS_V
	WHERE BU_ID = xccBCEBUE0.BUSINESS_UNIT_ID 
	) RES_BUSINESS_UNIT_NAME
,'Yes' RES_LEDGER_ENABLE_CASH_CONTROL
,xccBCECASHACCE0.ACCOUNT_SEGMENT_VALUE RES_LEDGER_VALUE
,(SELECT DESCRIPTION FROM FND_VS_VALUES_VL 
	WHERE VALUE_SET_ID = xccSEGVALE0.VALUE_SET_ID AND VALUE = xccBCECASHACCE0.ACCOUNT_SEGMENT_VALUE )RES_LEDGER_DESCRIPTION
,DECODE(xccBCECASHACCE0.ENABLED_FLAG,'Y','Yes','No') RES_LEDGER_ENABLED

,xccBCELEDE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,xccBCELEDE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,xccBCELEDE0.CREATED_BY RSC_CREATED_BY
,xccBCELEDE0.CREATION_DATE RSC_CREATION_DATE
,xccBCELEDE0.LEDGER_ID RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,xccBCEBUE0.BUSINESS_UNIT_ID RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID
   
FROM XCC_BCE_LEDGERS xccBCELEDE0
,XCC_BCE_BUSINESS_UNITS xccBCEBUE0
,XCC_CONTROL_BUDGETS conBUDE0
,XCC_BCE_CASH_ACCOUNTS  xccBCECASHACCE0
,XCC_SEG_NOT_BUDGETED_SEG_VAL xccSEGVALE0
WHERE xccBCELEDE0.LEDGER_ID = xccBCEBUE0.LEDGER_ID
AND xccBCEBUE0.LEDGER_ID = xccBCECASHACCE0.LEDGER_ID
AND xccBCEBUE0.LEDGER_ID = conBUDE0.LEDGER_ID
AND xccBCELEDE0.LEDGER_ID = xccSEGVALE0.LEDGER_ID
AND xccBCECASHACCE0.ACCOUNT_SEGMENT_COLUMN_NAME  = xccSEGVALE0.SOURCE_SEGMENT_COLUMN_NAME
AND conBUDE0.FV_TYPE_CODE LIKE 'ORA_CASH'
AND SYSDATE BETWEEN conBUDE0.START_DATE AND conBUDE0.END_DATE
ORDER BY 1,2,xccBCECASHACCE0.ACCOUNT_SEGMENT_VALUE