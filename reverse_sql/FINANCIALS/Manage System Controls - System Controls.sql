/* ****************************************************************************
 * $Revision: 79608 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2022-11-09 18:13:03 +0700 (Wed, 09 Nov 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20System%20Controls%20-%20System%20Controls.sql $:
 * $Id: Manage System Controls - System Controls.sql 79608 2022-11-09 11:13:03Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
--RSC_PREREQUISITE_OBJECTS=FA_SYSTEM_CONTROLS

SELECT QRSLT.COMPANY_NAME RES_ENTERPRISE_NAME
,TO_CHAR(QRSLT.DATE_PLACED_IN_SERVICE,'DD-Mon-YYYY') RES_OLDEST_DATE_PLACED_IN_SERV
,(SELECT name
	FROM FND_KF_STR_INSTANCES_VL STRUCTUREINSTANCE
	WHERE STRUCTUREINSTANCE.APPLICATION_ID      = 140
	AND StructureInstance.STRUCTURE_INSTANCE_NUMBER = QRSLT.CATEGORY_FLEX_STRUCTURE
	) RES_CATEGORY_FLEXFIELD
,(SELECT name
	FROM FND_KF_STR_INSTANCES_VL STRUCTUREINSTANCE
	WHERE STRUCTUREINSTANCE.APPLICATION_ID      = 140
	AND STRUCTUREINSTANCE.STRUCTURE_INSTANCE_NUMBER = QRSLT.LOCATION_FLEX_STRUCTURE
	) RES_LOCATION_FLEXFIELD
,(SELECT name
	FROM FND_KF_STR_INSTANCES_VL STRUCTUREINSTANCE
	WHERE STRUCTUREINSTANCE.APPLICATION_ID      = 140
	AND STRUCTUREINSTANCE.STRUCTURE_INSTANCE_NUMBER = QRSLT.ASSET_KEY_FLEX_STRUCTURE
	) RES_ASSET_KEY_FLEXFIELD
,QRSLT.INITIAL_ASSET_ID RES_STARTING_ASSET_NUMBER
,QRSLT.TRANS_LAST_ASSET_ID RES_LAST_ASSET_NUMBER_USED
,DECODE(QRSLT.PREVENT_USER_ASSET_NUMBER_FLAG,'Y','Yes','No') RES_PREVENT_USER_ENTERED_ASSET
,QRSLT.LAST_UPDATED_BY AS RSC_LAST_UPDATED_BY
,QRSLT.LAST_UPDATE_DATE AS RSC_LAST_UPDATE_DATE
,QRSLT.CREATED_BY  RSC_CREATED_BY
,QRSLT.CREATION_DATE  RSC_CREATION_DATE
, null RSC_LEDGER_ID
, null RSC_CHART_OF_ACCOUNTS_ID
, null RSC_BUSINESS_UNIT_ID
, null RSC_LEGAL_ENTITY_ID
, null RSC_ORGANIZATION_ID
, null RSC_BUSINESS_GROUP_ID
, NULL RSC_ENTERPRISE_ID
, NULL RSC_COUNTRY_ID
    
FROM
	(SELECT SystemControlEO.COMPANY_NAME
	,SystemControlEO.DATE_PLACED_IN_SERVICE
	,SystemControlEO.CATEGORY_FLEX_STRUCTURE
	,SystemControlEO.LOCATION_FLEX_STRUCTURE
	,SystemControlEO.ASSET_KEY_FLEX_STRUCTURE
	,SystemControlEO.INITIAL_ASSET_ID
	,(SELECT ASSET_NUMBER
		FROM FA_ADDITIONS_B
		WHERE ASSET_ID = (SELECT MAX(ASSET_ID) FROM FA_ADDITIONS_B)
		) AS TRANS_LAST_ASSET_ID
	,SystemControlEO.PREVENT_USER_ASSET_NUMBER_FLAG
	,SystemControlEO.CREATED_BY	
	,SystemControlEO.CREATION_DATE	
	,SystemControlEO.LAST_UPDATE_DATE
	,SystemControlEO.LAST_UPDATED_BY
	,SystemControlEO.USE_CUSTOM_ASSET_NUMBERS_FLAG
	from FA_SYSTEM_CONTROLS SYSTEMCONTROLEO
	) QRSLT
order by QRSLT.COMPANY_NAME