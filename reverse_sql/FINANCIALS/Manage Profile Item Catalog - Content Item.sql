/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Profile%20Item%20Catalog%20-%20Content%20Item.sql $:
 * $Id: Manage Profile Item Catalog - Content Item.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

-- RSC_PREREQUISITE_OBJECTS=HRT_CONTENT_TP_VALUESETS_VL
 
 /*<RSC_PRE_STEPS_LARGE_COLUMN_POSITION>12</RSC_PRE_STEPS_LARGE_COLUMN_POSITION>
	
-- The column position that using special data type.
 <RSC_PRE_STEPS_LARGE_COLUMN_TYPE>LONG</RSC_PRE_STEPS_LARGE_COLUMN_TYPE>

-- Specify what type of the data.
*/
 
 
 
SELECT  (SELECT CONTENT_TYPE_NAME FROM HRT_CONTENT_TYPES_VL WHERE CONTENT_TYPE_ID = hrtCONTPVALUESETEO.CONTENT_TYPE_ID) RES_TEMPLATE_NAME
,hrtCONTPVALUESETEO.VALUE_SET_NAME RES_ITEM_CATALOG_NAME
,hrtCONTENTITEMEO.CONTENT_ITEM_CODE RES_ITEM_CODE
,hrtCONTENTITEMEO.NAME RES_ITEM_NAME
,TO_CHAR(hrtCONTENTITEMEO.DATE_FROM,'DD-Mon-YYYY') RES_FROM_DATE
,TO_CHAR(hrtCONTENTITEMEO.DATE_TO,'DD-Mon-YYYY') RES_TO_DATE
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = hrtCONTENTITEMEO.CONTENT_SUPPLIER_CODE
			AND LOOKUP_TYPE = 'HRT_CONTENT_SUPP_CODE' AND LANGUAGE = USERENV('LANG')
			AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))) RES_SUPPLIER

--COMPETENCIES
,(SELECT RATING_NAME FROM HRT_RATING_MODELS_VL
		WHERE RATING_MODEL_ID = hrtCONTENTITEMEO.RATING_MODEL_ID) RES_RATING_MODEL
,hrtCONTENTITEMEO.ITEM_DESCRIPTION RES_DESCRIPTION
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Competencies'
	THEN
		hrtCONTENTITEMEO.ITEM_TEXT_TL_1 
	ELSE NULL END) RES_COMPETENCY_ALIAS
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Competencies'
	THEN (SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = hrtCONTENTITEMEO.ITEM_TEXT_3 
			AND LOOKUP_TYPE = 'HRT_VALIDITY_PERIOD' AND LANGUAGE = USERENV('LANG')
			AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD')))
	ELSE NULL END) RES_RENEWAL_PERIOD_UNITS 
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Competencies'
	THEN (SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = hrtCONTENTITEMEO.ITEM_TEXT_4 
			AND LOOKUP_TYPE = 'HRT_SATISFACTION_METHOD' AND LANGUAGE = USERENV('LANG')
			AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD')))
	ELSE NULL END) RES_SATISFACTION_METHOD 
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Competencies'
	THEN (SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = hrtCONTENTITEMEO.ITEM_TEXT_5 
			AND LOOKUP_TYPE = 'HRT_COMPETENCY_CATEGORY' AND LANGUAGE = USERENV('LANG')
			AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD')))
	ELSE NULL END) RES_CATEGORY 
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Competencies' 
	THEN (SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = hrtCONTENTITEMEO.ITEM_TEXT_2 
			AND LOOKUP_TYPE = 'HRT_COMPETENCY_EVAL_TYPE' AND LANGUAGE = USERENV('LANG')
			AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD')))
	ELSE NULL END)  RES_EVALUATION_METHOD 
,(CASE WHEN CTN.CONTENT_TYPE_NAME IN ('Competencies')
	THEN DECODE(hrtCONTENTITEMEO.ITEM_TEXT_1,'Y','Yes','No') 
	ELSE NULL END) RES_CERTIFICATION_REQUIRED
,hrtCONTENTITEMEO.ITEM_NUMBER_1 RES_RENEWAL_PERIOD_FREQUENCY
,(CASE WHEN CTN.CONTENT_TYPE_NAME IN ('Memberships','Degrees','Education Levels','Honors and Awards','Languages','Licenses and Certifications','Projects')
		THEN hrtCONTENTITEMEO.ITEM_TEXT_TL_1
	  WHEN CTN.CONTENT_TYPE_NAME = 'Competencies'
		THEN hrtCONTENTITEMEO.ITEM_TEXT_TL_2
	  ELSE NULL END) RES_SHORT_DESCRIPTION
,hrtCONTENTITEMEO.ITEM_TEXT_TL_6 RES_BEHAVIORAL_INDICATOR
,hrtCONTENTITEMEO.ITEM_DESCRLONG RES_LONG_DESCRIPTION


--DEGREES
--,hrtCONTENTITEMEO.ITEM_DESCRIPTION RES_DESCRIPTION
--,RES_SHORT_DESCRIPTION
,(CASE WHEN CTN.CONTENT_TYPE_NAME IN 'Degrees'
	THEN (SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = hrtCONTENTITEMEO.ITEM_TEXT_3 
			AND LOOKUP_TYPE = 'HRT_EDUCATION_LEVEL' AND LANGUAGE = USERENV('LANG')
			AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD')))
	ELSE NULL END) RES_EDUCATION_LEVEL
,NULL RES_FIELD_OF_STUDY
,hrtCONTENTITEMEO.ITEM_TEXT_8 RES_TYPE_OF_STUDY
,hrtCONTENTITEMEO.ITEM_NUMBER_2	 RES_RANK
,hrtCONTENTITEMEO.ITEM_NUMBER_3 RES_MONTHS_OF_EDUCATION
,hrtCONTENTITEMEO.ITEM_NUMBER_5 RES_YEARS_OF_EDUCATION
,(SELECT GEOGRAPHY_NAME FROM HZ_GEOGRAPHIES WHERE GEOGRAPHY_ID =  hrtCONTENTITEMEO.COUNTRY_ID) RES_COUNTRY

--Establishment
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Establishment'
	THEN hrtCONTENTITEMEO.ITEM_TEXT_TL_1 
	ELSE NULL END) RES_LOCATION
,(SELECT GEOGRAPHY_NAME FROM HZ_GEOGRAPHIES WHERE GEOGRAPHY_ID =  hrtCONTENTITEMEO.STATE_PROVINCE_ID) RES_STATE

--Licenses and Certifications
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Licenses and Certifications'
	THEN DECODE(hrtCONTENTITEMEO.ITEM_TEXT_2,'Y','Yes','No')
	ELSE NULL END) RES_RENEWAL_REQUIRED
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Licenses and Certifications'
	THEN (SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = hrtCONTENTITEMEO.ITEM_TEXT_1
			AND LOOKUP_TYPE = 'HRT_VALIDITY_PERIOD' AND LANGUAGE = USERENV('LANG')
			AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD')))
	ELSE NULL END) RES_RENEWAL_PERIOD 
,hrtCONTENTITEMEO.ITEM_NUMBER_1	 RES_RENEWAL_LENGTH


--Projects
,(CASE WHEN CTN.CONTENT_TYPE_NAME = 'Projects'
	THEN (SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = hrtCONTENTITEMEO.ITEM_TEXT_1
			AND LOOKUP_TYPE = 'ORA_HRT_PROJ_TYPES' AND LANGUAGE = USERENV('LANG')
			AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD')))
	ELSE NULL END) RES_PROJECT_TYPE



,hrtCONTENTITEMEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,hrtCONTENTITEMEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,hrtCONTENTITEMEO.CREATED_BY RSC_CREATED_BY
,hrtCONTENTITEMEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM HRT_CONTENT_TP_VALUESETS_VL hrtCONTPVALUESETEO 
,HRT_CONTENT_ITEMS_VL hrtCONTENTITEMEO
,HRT_CONTENT_TYPES_VL CTN
WHERE hrtCONTPVALUESETEO.CONTENT_VALUE_SET_ID = hrtCONTENTITEMEO.CONTENT_VALUE_SET_ID 
AND hrtCONTPVALUESETEO.CONTENT_TYPE_ID = hrtCONTENTITEMEO.CONTENT_TYPE_ID 
AND CTN.CONTENT_TYPE_ID = hrtCONTENTITEMEO.CONTENT_TYPE_ID
ORDER BY RES_TEMPLATE_NAME,hrtCONTPVALUESETEO.VALUE_SET_NAME

