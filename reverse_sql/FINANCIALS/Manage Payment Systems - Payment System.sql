/* ****************************************************************************
 * $Revision:  $:
 * $Author: Nasrullah Dusenmahamad $:
 * $Date: 2017-04-25 $:
 * $HeadURL: $:
 * $Id: Manage Lot Grades - Lot Grades.sql  $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 

SELECT PaymentSystemsE0.NAME RES_PAYMENT_SYSTEM_NAME
,PaymentSystemsE0.SUFFIX RES_PAYMENT_SYSTEM_CODE
,(SELECT MEANING 
	FROM FND_LOOKUPS
	WHERE LOOKUP_TYPE = 'IBY_BEP_TYPE'
	AND LOOKUP_CODE = PaymentSystemsE0.BEP_TYPE
	) RES_PROCESSING_MODEL
,BankE0.BANK_NAME RES_BANK_NAME
,BankE0.BANK_NUMBER RES_BANK_NUMBER
,BankE0.HOME_COUNTRY RES_BANK_COUNTRY
,(SELECT DESCRIPTION 
	FROM FND_LANGUAGES_TL
	WHERE LANGUAGE = USERENV('LANG')
	AND LANGUAGE_CODE = PaymentSystemsE0.NLS_LANGUAGE
	) RES_NETWORK_COMMUNICATION_CHAR
,PaymentSystemsE0.BASEURL RES_TRANSMISSION_SERVLET_BASE_
,PaymentSystemsE0.ADMINURL RES_ADMINISTRATIVE_URL
,TO_CHAR(PaymentSystemsE0.START_DATE,'DD-Mon-YYYY') RES_FROM_DATE
,DECODE(Extract(YEAR FROM PaymentSystemsE0.END_DATE),'4712',NULL,TO_CHAR(PaymentSystemsE0.END_DATE,'DD-Mon-YYYY')) RES_TO_DATE
,(CASE
	WHEN EXISTS (SELECT 1 FROM IBY_PMTSCHEMES WHERE PMTSCHEMENAME = 'SSL' AND BEPID = PaymentSystemsE0.BEPID) THEN
		'Yes'
	ELSE
		'No'
	END) RES_CREDIT_CARD
,(CASE
	WHEN EXISTS (SELECT 1 FROM IBY_PMTSCHEMES WHERE PMTSCHEMENAME = 'BANKACCOUNT' AND BEPID = PaymentSystemsE0.BEPID) THEN
		'Yes'
	ELSE
		'No'
	END) RES_ELECTRONIC_FUNDS_TRANSFER
,(CASE
	WHEN EXISTS (SELECT 1 FROM IBY_PMTSCHEMES WHERE PMTSCHEMENAME = 'PINLESSDEBITCARD' AND BEPID = PaymentSystemsE0.BEPID) THEN
		'Yes'
	ELSE
		'No'
	END) RES_DEBIT_CARD
,(CASE
	WHEN EXISTS (SELECT 1 FROM IBY_PMTSCHEMES WHERE PMTSCHEMENAME = 'BANKPAYMENT' AND BEPID = PaymentSystemsE0.BEPID) THEN
		'Yes'
	ELSE
		'No'
	END) RES_ELECTRONIC_FUNDS_TRANSFER_
,(CASE
	WHEN EXISTS (SELECT 1 FROM IBY_PMTSCHEMES WHERE PMTSCHEMENAME = 'TOKENIZATION' AND BEPID = PaymentSystemsE0.BEPID) THEN
		'Yes'
	ELSE
		'No'
	END) RES_CREDIT_CARD_TOKENIZATION
,PaymentSystemsE0.LEADTIME RES_BANK_ACCOUNT_LEAD_DAYS
,PaymentSystemsE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,PaymentSystemsE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,PaymentSystemsE0.CREATED_BY RSC_CREATED_BY
,PaymentSystemsE0.CREATION_DATE RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM IBY_BEPINFO PaymentSystemsE0
,CE_BANKS_V BankE0
WHERE PaymentSystemsE0.BANK_ID = BankE0.BANK_PARTY_ID(+)
ORDER BY PaymentSystemsE0.NAME