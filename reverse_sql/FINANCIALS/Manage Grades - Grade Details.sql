/* ****************************************************************************
 * $Revision:  $:
 * $Author: Nasrullah Dusenmahamad $:
 * $Date: 2018-03-20  $:
 * $HeadURL: $:
 * $Id: Configure Exception Sets - Exception  $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 

SELECT TO_CHAR(gradesE0.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,DECODE(TO_CHAR(gradesE0.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(gradesE0.EFFECTIVE_END_DATE,'DD-Mon-YYYY')) RES_EFFECTIVE_END_DATE
,setsE0.SET_CODE RES_GRADE_SET_CODE
,setsE0.SET_NAME RES_GRADE_SET_NAME
,gradesE0.NAME RES_NAME
,gradesE0.GRADE_CODE RES_CODE
,(SELECT MEANING
	FROM FND_LOOKUP_VALUES 
	WHERE LOOKUP_TYPE = 'ACTIVE_INACTIVE'
	AND LOOKUP_CODE = gradesE0.ACTIVE_STATUS
	AND LANGUAGE = USERENV('LANG')
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('4712-12-31','YYYY-MM-DD'))
	) RES_STATUS
,(SELECT ACTION_REASON
	FROM PER_ACTION_OCCURRENCES actOccE0
	,PER_ACTION_REASONS_VL actReasonsE0
	WHERE actOccE0.ACTION_REASON_ID = actReasonsE0.ACTION_REASON_ID
	AND actOccE0.ACTION_OCCURRENCE_ID = gradesE0.ACTION_OCCURRENCE_ID
	) RES_ACTION_REASON
,gradeLegsE0.INFORMATION1 RES_GRADE_CODE_DESCRIPTION
,DECODE(gradeLegsE0.INFORMATION2,'Y','Yes','No') RES_INDUSTRIAL_GRADE
,DECODE(gradeLegsE0.INFORMATION3,'Y','Yes','No') RES_UNIFORMED_GRADE
,gradeLegsE0.INFORMATION4 RES_PAYPOINT_CODE
,gradesE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,gradesE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,gradesE0.CREATED_BY RSC_CREATED_BY
,gradesE0.CREATION_DATE RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,gradesE0.BUSINESS_GROUP_ID RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID
   
FROM PER_GRADES_F_VL gradesE0
,FND_SETID_SETS setsE0
,(SELECT * FROM PER_GRADE_LEG_F WHERE INFORMATION_CATEGORY = 'ORA_HRX_GB_PS_CSP_GRD') gradeLegsE0
WHERE gradesE0.SET_ID = setsE0.SET_ID
AND setsE0.LANGUAGE = USERENV('LANG')
AND gradesE0.GRADE_ID = gradeLegsE0.GRADE_ID(+)
AND gradesE0.EFFECTIVE_END_DATE BETWEEN gradeLegsE0.EFFECTIVE_START_DATE(+) AND gradeLegsE0.EFFECTIVE_END_DATE(+)
ORDER BY gradesE0.NAME
,gradesE0.GRADE_CODE
,gradesE0.EFFECTIVE_START_DATE