/* ****************************************************************************
* $Revision: 78229 $:
* $Author: pisan.jariyasettachok $:
* $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
* $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Financial%20Plan%20Types%20-%20Generation%20Options.sql $:
* $Id: Manage Financial Plan Types - Generation Options.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
* ****************************************************************************
* Description:
* ************************************************************************** */

SELECT 	pjoPlanTypeEO.NAME							RES_NAME
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE != 'FORECAST'
		THEN	(SELECT MEANING FROM FND_LOOKUPS
					WHERE LOOKUP_CODE = pjoPlanOptionEO.BUDGET_CREATION_METHOD
						AND LOOKUP_TYPE = 'PJO_BUDGET_CREATION_METHOD') 			
					END)	RES_BUDGET_CREATION_METHOD
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN	(SELECT MEANING FROM FND_LOOKUPS
					WHERE LOOKUP_CODE = pjoPlanOptionEO.ETC_METHOD_CODE
						AND LOOKUP_TYPE = 'PJF_ETC_METHOD')  						
					END)	RES_FORECAST_ETC_METHOD
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN	DECODE(pjoPlanOptionEO.ALLOW_FCST_AMT_CARRY_FLAG,'Y','Yes','No') 	
		END) RES_CARRY_FORWARD_UNUSED_AMOUN
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN	(SELECT MEANING FROM FND_LOOKUPS
					WHERE LOOKUP_CODE = pjoPlanOptionEO.GEN_ACT_AMTS_THRU_CODE
						AND LOOKUP_TYPE = 'PJO_ACT_AMT_THRU') 						
					END)	RES_ACTUAL_AMOUNTS_THROUGH_PER  
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN
			(SELECT MEANING FROM FND_LOOKUPS
				WHERE LOOKUP_CODE = pjoPlanOptionEO.GEN_SRC_CODE
					AND LOOKUP_TYPE = 'PJO_PLAN_TYPE_CODE') 		
				END)	RES_ETC_GENERATION_SOURCE
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE != 'FORECAST' AND pjoPlanOptionEO.PLANNED_FOR_CODE != 'REVENUE' 
		THEN
			(SELECT MEANING FROM FND_LOOKUPS
				WHERE LOOKUP_CODE = pjoPlanOptionEO.GEN_SRC_CODE
					AND LOOKUP_TYPE = 'PJO_PLAN_TYPE_CODE') 		
				END)	RES_GENERATION_SOURCE		
,(CASE
	WHEN pjoPlanOptionEO.GEN_SRC_CODE = 'PROJECT_PLAN' AND pjoPlanOptionEO.PLANNED_FOR_CODE != 'REVENUE' 
		THEN 'Project Plan'
	WHEN pjoPlanOptionEO.GEN_SRC_CODE != 'PROJECT_PLAN' AND pjoPlanOptionEO.PLANNED_FOR_CODE != 'REVENUE'
		THEN (SELECT NAME FROM PJO_PLAN_TYPES_VL
			WHERE PLAN_TYPE_ID = pjoPlanOptionEO.GEN_SRC_PLAN_TYPE_ID)
				END)	RES_SOURCE_PLAN_TYPE
,(CASE 
	WHEN pjoPlanOptionEO.GEN_SRC_CODE != 'PROJECT_PLAN' AND pjoPlanOptionEO.PLANNED_FOR_CODE != 'REVENUE' 
		THEN (SELECT MEANING FROM FND_LOOKUPS
				WHERE LOOKUP_CODE = pjoPlanOptionEO.GEN_SRC_PLAN_VER_CODE	
					AND LOOKUP_TYPE = 'PJO_FCST_PLAN_VERSION_CODE')	
	WHEN pjoPlanOptionEO.GEN_SRC_CODE = 'PROJECT_PLAN' AND pjoPlanOptionEO.PLANNED_FOR_CODE != 'REVENUE' 
		THEN (DECODE (pjoPlanOptionEO.GEN_SRC_PLAN_VER_CODE,'W','Working','B','Baseline'))
				END)	RES_SOURCE_PLAN_VERSION
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' AND pjoPlanOptionEO.PLANNED_FOR_CODE != 'REVENUE' THEN
		DECODE(pjoPlanOptionEO.ALLOW_NEG_ETC_FLAG,'Y','Yes','No')
	END) RES_ALLOW_NEGATIVE_ETC_CALCULA	
,(CASE
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' AND pjoPlanOptionEO.PLANNED_FOR_CODE != 'REVENUE' 
		THEN (DECODE(pjoPlanOptionEO.GEN_INCL_OPENCOMM_FLAG,'Y','Yes','No'))
		END)	RES_OPEN_COMMITMENTS
,DECODE(pjoPlanOptionEO.GEN_RET_MAN_LINE_FLAG,'Y','Yes','No') RES_RETAIN_MANUALLY_ADDED_BUDG  
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN (DECODE(pjoPlanOptionEO.GEN_RET_MAN_LINE_FLAG,'Y','Yes','No')) 
		END) RES_RETAIN_MANUALLY_ADDED_FORE
,DECODE(pjoPlanOptionEO.RET_OVER_RATES_FRM_SRC_FLAG,'Y','Yes','No')	RES_RETAIN_OVERRIDE_RATES_FROM
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' AND pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE'
		THEN	(SELECT MEANING FROM FND_LOOKUPS
					WHERE LOOKUP_CODE = pjoPlanOptionEO.ETC_METHOD_CODE
						AND LOOKUP_TYPE = 'PJF_ETC_METHOD')  						
					END)	RES_REVENUE_FORECAST_ETC_METHO
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE != 'COST' AND pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN (DECODE(pjoPlanOptionEO.ALLOW_FCST_AMT_CARRY_FLAG,'Y','Yes','No')) 	
		END)	RES_REVENUE_CARRY_FORWARD_UNUS
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' AND pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN (SELECT MEANING FROM FND_LOOKUPS
					WHERE LOOKUP_CODE = pjoPlanOptionEO.GEN_ACT_AMTS_THRU_CODE
						AND LOOKUP_TYPE = 'PJO_ACT_AMT_THRU') 	
		END)	RES_REVENUE_ACTUAL_AMOUNTS_THR
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' AND pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN (SELECT MEANING FROM FND_LOOKUPS
				WHERE LOOKUP_CODE = pjoPlanOptionEO.GEN_SRC_CODE
					AND LOOKUP_TYPE = 'PJO_PLAN_TYPE_CODE') 		 	
		END)	RES_REVENUE_ETC_GENERATION_SOU
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE'
		THEN (SELECT MEANING FROM FND_LOOKUPS
				WHERE LOOKUP_CODE = pjoPlanOptionEO.GEN_SRC_CODE
					AND LOOKUP_TYPE = 'PJO_PLAN_TYPE_CODE') 	
		END)	RES_REVENUE_GENERATION_SOURCE
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' AND pjoPlanOptionEO.GEN_SRC_CODE = 'PROJECT_PLAN'
		THEN 'Project Plan'
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' AND pjoPlanOptionEO.GEN_SRC_CODE != 'PROJECT_PLAN'
		THEN (SELECT NAME FROM PJO_PLAN_TYPES_VL
			WHERE PLAN_TYPE_ID = pjoPlanOptionEO.GEN_SRC_PLAN_TYPE_ID)
		END)	RES_REVENUE_SOURCE_PLAN_TYPE		
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' AND pjoPlanOptionEO.GEN_SRC_CODE != 'PROJECT_PLAN'
		THEN (SELECT MEANING FROM FND_LOOKUPS
				WHERE LOOKUP_CODE = pjoPlanOptionEO.GEN_SRC_PLAN_VER_CODE	
					AND LOOKUP_TYPE = 'PJO_PLAN_VERSION_CODE')	
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' AND pjoPlanOptionEO.GEN_SRC_CODE = 'PROJECT_PLAN'
		THEN DECODE (pjoPlanOptionEO.GEN_SRC_PLAN_VER_CODE,'W','Working','B','Baseline')
				END)	RES_REVENUE_SOURCE_PLAN_VERSIO
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' OR pjoPlanOptionEO.PLANNED_FOR_CODE ='COST_AND_REV_TOGETHER'
		THEN (SELECT MEANING FROM FND_LOOKUPS
				WHERE LOOKUP_CODE = pjoPlanOptionEO.REV_CLASSIFICATION_METHOD
					AND LOOKUP_TYPE = 'PJO_REV_CLASSIFICATION_METHOD') 	
		END)	RES_REVENUE_GENERATION_METHOD
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' AND pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' THEN
		DECODE(pjoPlanOptionEO.ALLOW_NEG_ETC_FLAG,'Y','Yes','No') 
	END) RES_REVENUE_ALLOW_NEGATIVE_ETC
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' AND pjoPlanTypeEO.PLAN_CLASS_CODE = 'BUDGET'
		THEN DECODE(pjoPlanOptionEO.GEN_RET_MAN_LINE_FLAG,'Y','Yes','No') 
		END)	RES_REVENUE_RETAIN_MANUALLY_AD
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE' AND pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST'
		THEN DECODE(pjoPlanOptionEO.GEN_RET_MAN_LINE_FLAG,'Y','Yes','No') 
		END)	RES_REVENUE_RETAIN_MANUALLY__0
,(CASE
	WHEN pjoPlanOptionEO.PLANNED_FOR_CODE = 'REVENUE'
		THEN	DECODE(pjoPlanOptionEO.RET_OVER_RATES_FRM_SRC_FLAG,'Y','Yes','No')	
		END)	RES_REVENUE_RETAIN_OVERRIDE_RA
,pjoPlanTypeEO.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,pjoPlanTypeEO.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,pjoPlanTypeEO.CREATED_BY  RSC_CREATED_BY
,pjoPlanTypeEO.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM PJO_PLAN_TYPES_VL pjoPlanTypeEO
,PJO_PLANNING_OPTIONS pjoPlanOptionEO
WHERE pjoPlanTypeEO.PLAN_TYPE_CODE = 'FINANCIAL_PLAN'
AND pjoPlanTypeEO.PLAN_TYPE_ID = pjoPlanOptionEO.PLAN_TYPE_ID
AND pjoPlanOptionEO.PLAN_OPTION_LEVEL_CODE = 'PLAN_TYPE'
AND pjoPlanOptionEO.PROJECT_ID = 0
AND pjoPlanTypeEO.PLAN_OPTION_CODE != 'COST_AND_REV_SEP'

UNION

SELECT 	pjoPlanTypeEO.NAME RES_NAME
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE != 'FORECAST' THEN	
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionCostEO.BUDGET_CREATION_METHOD
			AND LOOKUP_TYPE = 'PJO_BUDGET_CREATION_METHOD') 			
	END) RES_BUDGET_CREATION_METHOD
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN	
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionCostEO.ETC_METHOD_CODE
			AND LOOKUP_TYPE = 'PJF_ETC_METHOD')  						
	END) RES_FORECAST_ETC_METHOD
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN	
		DECODE(pjoPlanOptionCostEO.ALLOW_FCST_AMT_CARRY_FLAG,'Y','Yes','No') 	
	END) RES_CARRY_FORWARD_UNUSED_AMOUN
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN	
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionCostEO.GEN_ACT_AMTS_THRU_CODE
			AND LOOKUP_TYPE = 'PJO_ACT_AMT_THRU') 						
	END) RES_ACTUAL_AMOUNTS_THROUGH_PER  
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionCostEO.GEN_SRC_CODE
			AND LOOKUP_TYPE = 'PJO_PLAN_TYPE_CODE') 		
	END) RES_ETC_GENERATION_SOURCE
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE != 'FORECAST' THEN
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionCostEO.GEN_SRC_CODE
			AND LOOKUP_TYPE = 'PJO_PLAN_TYPE_CODE') 		
	END) RES_GENERATION_SOURCE		
,(CASE
	WHEN pjoPlanOptionCostEO.GEN_SRC_CODE = 'PROJECT_PLAN' THEN 
		'Project Plan'
	WHEN pjoPlanOptionCostEO.GEN_SRC_CODE != 'PROJECT_PLAN' THEN 
		(SELECT NAME 
			FROM PJO_PLAN_TYPES_VL
			WHERE PLAN_TYPE_ID = pjoPlanOptionCostEO.GEN_SRC_PLAN_TYPE_ID)
	END) RES_SOURCE_PLAN_TYPE
,(CASE 
	WHEN pjoPlanOptionCostEO.GEN_SRC_CODE != 'PROJECT_PLAN' THEN 
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionCostEO.GEN_SRC_PLAN_VER_CODE	
			AND LOOKUP_TYPE = 'PJO_FCST_PLAN_VERSION_CODE')	
	WHEN pjoPlanOptionCostEO.GEN_SRC_CODE = 'PROJECT_PLAN' THEN 
		DECODE (pjoPlanOptionCostEO.GEN_SRC_PLAN_VER_CODE,'W','Working','B','Baseline')
	END) RES_SOURCE_PLAN_VERSION 
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN 
		DECODE(pjoPlanOptionCostEO.ALLOW_NEG_ETC_FLAG,'Y','Yes','No')	
	END) RES_ALLOW_NEGATIVE_ETC_CALCULA	
,(CASE
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN 
		DECODE(pjoPlanOptionCostEO.GEN_INCL_OPENCOMM_FLAG,'Y','Yes','No')	
	END) RES_OPEN_COMMITMENTS
,DECODE(pjoPlanOptionCostEO.GEN_RET_MAN_LINE_FLAG,'Y','Yes','No') RES_RETAIN_MANUALLY_ADDED_BUDG  
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN 
		DECODE(pjoPlanOptionCostEO.GEN_RET_MAN_LINE_FLAG,'Y','Yes','No')
	END) RES_RETAIN_MANUALLY_ADDED_FORE
,DECODE(pjoPlanOptionCostEO.RET_OVER_RATES_FRM_SRC_FLAG,'Y','Yes','No')	RES_RETAIN_OVERRIDE_RATES_FROM

,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN	
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionRevEO.ETC_METHOD_CODE
			AND LOOKUP_TYPE = 'PJF_ETC_METHOD')  						
	END) RES_REVENUE_FORECAST_ETC_METHO
,(CASE
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN 
		DECODE(pjoPlanOptionRevEO.ALLOW_FCST_AMT_CARRY_FLAG,'Y','Yes','No')
	END) RES_REVENUE_CARRY_FORWARD_UNUS
,(CASE
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN 
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionRevEO.GEN_ACT_AMTS_THRU_CODE
			AND LOOKUP_TYPE = 'PJO_ACT_AMT_THRU') 	
		END) RES_REVENUE_ACTUAL_AMOUNTS_THR
,(CASE
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN 
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionRevEO.GEN_SRC_CODE
			AND LOOKUP_TYPE = 'PJO_PLAN_TYPE_CODE') 		 	
	END) RES_REVENUE_ETC_GENERATION_SOU
,(SELECT MEANING 
	FROM FND_LOOKUPS
	WHERE LOOKUP_CODE = pjoPlanOptionRevEO.GEN_SRC_CODE
	AND LOOKUP_TYPE = 'PJO_PLAN_TYPE_CODE'
	) RES_REVENUE_GENERATION_SOURCE
,(CASE
	WHEN pjoPlanOptionRevEO.GEN_SRC_CODE = 'PROJECT_PLAN' THEN 
		'Project Plan'
	WHEN pjoPlanOptionRevEO.GEN_SRC_CODE != 'PROJECT_PLAN' THEN 
		(SELECT NAME 
			FROM PJO_PLAN_TYPES_VL
			WHERE PLAN_TYPE_ID = pjoPlanOptionRevEO.GEN_SRC_PLAN_TYPE_ID)
	END) RES_REVENUE_SOURCE_PLAN_TYPE		
,(CASE
	WHEN pjoPlanOptionRevEO.GEN_SRC_CODE != 'PROJECT_PLAN' THEN 
		(SELECT MEANING 
			FROM FND_LOOKUPS
			WHERE LOOKUP_CODE = pjoPlanOptionRevEO.GEN_SRC_PLAN_VER_CODE	
			AND LOOKUP_TYPE = 'PJO_PLAN_VERSION_CODE')	
	WHEN pjoPlanOptionRevEO.GEN_SRC_CODE = 'PROJECT_PLAN' THEN 
		DECODE (pjoPlanOptionRevEO.GEN_SRC_PLAN_VER_CODE,'W','Working','B','Baseline')
	END) RES_REVENUE_SOURCE_PLAN_VERSIO
,(SELECT MEANING 
	FROM FND_LOOKUPS
	WHERE LOOKUP_CODE = pjoPlanOptionRevEO.REV_CLASSIFICATION_METHOD
	AND LOOKUP_TYPE = 'PJO_REV_CLASSIFICATION_METHOD'
	) RES_REVENUE_GENERATION_METHOD
,(CASE 
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN 
		DECODE(pjoPlanOptionRevEO.ALLOW_NEG_ETC_FLAG,'Y','Yes','No') 
	END) RES_REVENUE_ALLOW_NEGATIVE_ETC
,(CASE
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'BUDGET' THEN 
		DECODE(pjoPlanOptionRevEO.GEN_RET_MAN_LINE_FLAG,'Y','Yes','No') 
	END) RES_REVENUE_RETAIN_MANUALLY_AD
,(CASE
	WHEN pjoPlanTypeEO.PLAN_CLASS_CODE = 'FORECAST' THEN 
		DECODE(pjoPlanOptionRevEO.GEN_RET_MAN_LINE_FLAG,'Y','Yes','No') 
	END) RES_REVENUE_RETAIN_MANUALLY__0
,DECODE(pjoPlanOptionRevEO.RET_OVER_RATES_FRM_SRC_FLAG,'Y','Yes','No') RES_REVENUE_RETAIN_OVERRIDE_RA
,pjoPlanTypeEO.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,pjoPlanTypeEO.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,pjoPlanTypeEO.CREATED_BY  RSC_CREATED_BY
,pjoPlanTypeEO.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM PJO_PLAN_TYPES_VL pjoPlanTypeEO
,(SELECT * 
	FROM PJO_PLANNING_OPTIONS 
	WHERE PLANNED_FOR_CODE = 'COST'
	AND PLAN_OPTION_LEVEL_CODE = 'PLAN_TYPE'
	AND PROJECT_ID = 0
	) pjoPlanOptionCostEO
,(SELECT * 
	FROM PJO_PLANNING_OPTIONS 
	WHERE PLANNED_FOR_CODE = 'REVENUE'
	AND PLAN_OPTION_LEVEL_CODE = 'PLAN_TYPE'
	AND PROJECT_ID = 0
	) pjoPlanOptionRevEO
WHERE pjoPlanTypeEO.PLAN_TYPE_CODE = 'FINANCIAL_PLAN'
AND pjoPlanTypeEO.PLAN_TYPE_ID = pjoPlanOptionCostEO.PLAN_TYPE_ID
AND pjoPlanTypeEO.PLAN_TYPE_ID = pjoPlanOptionRevEO.PLAN_TYPE_ID

AND pjoPlanTypeEO.PLAN_OPTION_CODE = 'COST_AND_REV_SEP'

ORDER BY 1