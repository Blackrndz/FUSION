/* ****************************************************************************
* $Revision:  $:
* $Author: Nasrullah Dusenmahamad $:
* $Date: 2017-03-17  $:
* $HeadURL: $:
* $Id: Manage Category Descriptive Flexfields - Context Segments $:
* ****************************************************************************
* Description:
* ************************************************************************** */

-- RSC_PREREQUISITE_OBJECTS=BEN_LER_F

SELECT lifeEventsE0.NAME RES_NAME
,TO_CHAR(lifeEventsE0.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,DECODE(TO_CHAR(lifeEventsE0.EFFECTIVE_END_DATE ,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(lifeEventsE0.EFFECTIVE_END_DATE ,'DD-Mon-YYYY')) RES_EFFECTIVE_END_DATE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_LER_TYP'
    AND LOOKUP_CODE = lifeEventsE0.TYP_CD
    ) RES_TYPE
,lifeEventsE0.DESC_TXT RES_DESCRIPTION
,DECODE(lifeEventsE0.GLOBAL_FLAG,'Y','Yes','No') RES_GLOBAL
,DECODE(lifeEventsE0.OVRIDG_LE_FLAG,'Y','Yes','No') RES_OVERRIDE
,lifeEventsE0.SHORT_NAME RES_SHORT_NAME
,lifeEventsE0.SHORT_CODE RES_SHORT_CODE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'ORA_BEN_COBRA_QUAL_TYP'
    AND LOOKUP_CODE = lifeEventsE0.COBRA_QUAL_CODE
    ) RES_CONTINUING_BENEFITS_TYPE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_LF_EVT_OPER'
    AND LOOKUP_CODE = lifeEventsE0.LF_EVT_OPER_CD 
	 ) RES_ABSENCE_EVENT
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_OCRD_DT_DET'
    AND LOOKUP_CODE = lifeEventsE0.OCRD_DT_DET_CD
    ) RES_OCCURRED_DATE_DETERMINATIO
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = lifeEventsE0.LER_EVAL_RL
    ) RES_EVALUATION_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_PTNL_LER_TRTMT'
    AND LOOKUP_CODE = lifeEventsE0.PTNL_LER_TRTMT_CD
    ) RES_TEMPORAL_DETECTION_RULE
,DECODE(lifeEventsE0.CK_RLTD_PER_ELIG_FLAG,'Y','Yes','No') RES_CHECK_RELATED_PERSON_ELIGI
,DECODE(lifeEventsE0.CONFIG_CHAR_1,'Y','Yes','No') RES_VISIBLE_ON_SELF_SERVICE_PA
,DECODE(lifeEventsE0.SELF_ASSIGNED_EVENT_FLAG,'Y','Yes','No') RES_SELF_ASSIGNED
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_LER_TMLNS_EVAL'
    AND LOOKUP_CODE = lifeEventsE0.TMLNS_EVAL_CD
    ) RES_TIMELINESS_EVALUATION
,lifeEventsE0.TMLNS_DYS_NUM RES_TIMELINESS_DAYS
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_LER_TMLNS_PERD'
    AND LOOKUP_CODE = lifeEventsE0.TMLNS_PERD_CD
    ) RES_TIMELINESS_PERIOD_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = lifeEventsE0.TMLNS_PERD_RL
    ) RES_TIMELINESS_PERIOD_FORMULA
,(CASE
    WHEN lifeEventsE0.SELF_ASSIGNED_EVENT_FLAG = 'Y' THEN
        (SELECT MEANING
            FROM FND_LOOKUP_VALUES
            WHERE LANGUAGE = USERENV('LANG')
            AND LOOKUP_TYPE = 'ORA_BEN_SLF_SVC_GRP'
            AND LOOKUP_CODE = lifeEventsE0.SLCTBL_SLF_SVC_CD)
    END) RES_SEELF_SERVICE_GROUPING
,(CASE
    WHEN lifeEventsE0.SELF_ASSIGNED_EVENT_FLAG = 'Y' THEN
        lifeEventsE0.INSTRUCTION_TEXT
    END) RES_LIFE_EVENT_INSTRUCTION_TEX
,(CASE
    WHEN lifeEventsE0.SELF_ASSIGNED_EVENT_FLAG = 'Y' THEN
        lifeEventsE0.CONFIG_NUM_1
    END) RES_PAST_EVENT_REPORTING_LIMIT
,lifeEventsE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,lifeEventsE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,lifeEventsE0.CREATED_BY RSC_CREATED_BY
,lifeEventsE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,lifeEventsE0.BUSINESS_GROUP_ID RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM BEN_LER_F lifeEventsE0
ORDER BY lifeEventsE0.NAME
,lifeEventsE0.EFFECTIVE_START_DATE