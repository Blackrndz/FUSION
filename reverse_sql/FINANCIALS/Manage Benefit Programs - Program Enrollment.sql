/* ****************************************************************************
 * $Revision: 78273 $:
 * $Author: tanawat.wongjan $:
 * $Date: 2022-04-12 17:31:46 +0700 (Tue, 12 Apr 2022) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Benefit%20Programs%20-%20Enrollment.sql $:
 * $Id: Manage Benefit Programs - Enrollment.sql 78273 2022-04-12 10:31:46Z tanawat.wongjan $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

SELECT RES_PROGRAM_NAME
,RES_EFFECTIVE_START_DATE
,RES_PROGRAM_HIERARCHY
,RES_PROGRAM_HIERARCHY_DESCRIPT
,RES_ENROLLMENT_METHOD
,RES_AUTOMATIC_FORMULA
,RES_DEFAULT_ENROLLMENT_RULE
,RES_DEFAULT_ENROLLMENT_FORMULA
,RES_POST_ELECTION_FORMULA
,RES_ASSIGN_ON_DEFAULT
,RES_SUM_PARTICIPANTS_INSURANCE
,RES_COORDINATE_COVERAGE_FOR_AL
,RES_SUBJECT_TO_SPOUSES_INSURAN
,RES_SUBJECT_TO_DEPENDENTS_INSU
,RES_ENROLLMENT_RULE
,RES_ENROLLMENT_FORMULA
,RES_SPOUSE_INSURANCE_COVERAGE_
,RES_DEPENDENTS_INSURANCE_COVER
,RES_INTERIM_RULE
,RES_INTERIM_FORMULA
,RES_UNSUSPEND_ENROLLMENT_RULE
,RES_UNSUSPEND_ENROLLMENT_FORMU
,RES_UNSUSPEND_RATE_RULE
,RES_UNSUSPEND_RATE_FORMULA
,RES_PLAN_LIMITATION_MINIMUM
,RES_PLAN_LIMITATION_MAXIMUM
,RES_COVERAGE_START_DATE
,RES_COVERAGE_START_FORMULA
,RES_PREVIOUS_COVERAGE_END_DATE
,RES_PREVIOUS_COVERAGE_END_FORM
,RES_RATE_START_DATE
,RES_RATE_START_FORMULA
,RES_PREVIOUS_RATE_END_DATE
,RES_PREVIOUS_RATE_END_FORMULA
,RES_NO_MINIMUM
,RES_NO_MAXIMUM
,RES_UNIT_OF_MEASURE
,RES_NUMBER_OF_UNITS_IN_PERIOD
,RES_REQUIRED_PERIOD_OF_ENROLLM
,RES_ENROLLMENT_MAXIMUM
--,RES_EFFECTIVE_END_DATE

,RSC_LAST_UPDATED_BY
,RSC_LAST_UPDATE_DATE
,RSC_CREATED_BY
,RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,RSC_COUNTRY_ID
	
FROM 
(SELECT benPGMEO.NAME RES_PROGRAM_NAME
,benPGMEO.NAME RES_PROGRAM_HIERARCHY
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_MTHD'
    AND LOOKUP_CODE = benPGMEO.ENRT_MTHD_CD
    ) RES_ENROLLMENT_METHOD
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPGMEO.AUTO_ENRT_MTHD_RL
    ) RES_AUTOMATIC_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT'
    AND LOOKUP_CODE = benPGMEO.ENRT_CD
    ) RES_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPGMEO.ENRT_RL
    ) RES_ENROLLMENT_FORMULA
,MX_SPS_PCT_PRTT_LF_AMT RES_SPOUSE_INSURANCE_COVERAGE_
,MX_DPNT_PCT_PRTT_LF_AMT RES_DEPENDENTS_INSURANCE_COVER
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_CVG_STRT'
    AND LOOKUP_CODE = benPGMEO.ENRT_CVG_STRT_DT_CD
    ) RES_COVERAGE_START_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPGMEO.ENRT_CVG_STRT_DT_RL
    ) RES_COVERAGE_START_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_CVG_END'
    AND LOOKUP_CODE = benPGMEO.ENRT_CVG_END_DT_CD
    ) RES_PREVIOUS_COVERAGE_END_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPGMEO.ENRT_CVG_END_DT_RL
    ) RES_PREVIOUS_COVERAGE_END_FORM
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_STRT'
    AND LOOKUP_CODE = benPGMEO.RT_STRT_DT_CD
    ) RES_RATE_START_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPGMEO.RT_STRT_DT_RL
    ) RES_RATE_START_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_END'
    AND LOOKUP_CODE = benPGMEO.RT_END_DT_CD
    ) RES_PREVIOUS_RATE_END_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPGMEO.RT_END_DT_RL
    ) RES_PREVIOUS_RATE_END_FORMULA
,TO_CHAR(benPGMEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,DECODE(TO_CHAR(benPGMEO.EFFECTIVE_END_DATE ,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(benPGMEO.EFFECTIVE_END_DATE ,'DD-Mon-YYYY')) RES_EFFECTIVE_END_DATE
,NULL RES_DEFAULT_ENROLLMENT_RULE
,NULL RES_DEFAULT_ENROLLMENT_FORMULA
,NULL RES_POST_ELECTION_FORMULA
,NULL RES_INTERIM_RULE
,NULL RES_INTERIM_FORMULA
,NULL RES_UNSUSPEND_ENROLLMENT_RULE
,NULL RES_UNSUSPEND_ENROLLMENT_FORMU
,NULL RES_UNSUSPEND_RATE_RULE
,NULL RES_UNSUSPEND_RATE_FORMULA
,NULL RES_ENROLLMENT_MAXIMUM
,NULL RES_SUM_PARTICIPANTS_INSURANCE
,NULL RES_COORDINATE_COVERAGE_FOR_AL
,NULL RES_SUBJECT_TO_SPOUSES_INSURAN
,NULL RES_SUBJECT_TO_DEPENDENTS_INSU
,NULL RES_NO_MINIMUM
,NULL RES_NO_MAXIMUM
,NULL RES_PLAN_LIMITATION_MINIMUM
,NULL RES_PLAN_LIMITATION_MAXIMUM
,NULL RES_UNIT_OF_MEASURE
,NULL RES_NUMBER_OF_UNITS_IN_PERIOD
,NULL RES_REQUIRED_PERIOD_OF_ENROLLM
,NULL RES_ASSIGN_ON_DEFAULT
,'Programs' RES_PROGRAM_HIERARCHY_DESCRIPT
,'1' RES_SEQUENCE_0

,benPGMEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,benPGMEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,benPGMEO.CREATED_BY RSC_CREATED_BY
,benPGMEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,benPGMEO.LEGISLATION_CODE RSC_COUNTRY_ID
	
	
FROM BEN_PGM_F benPGMEO
WHERE SYSDATE BETWEEN benPGMEO.EFFECTIVE_START_DATE AND NVL(benPGMEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))

UNION

SELECT benPGMEO.NAME RES_PROGRAM_NAME
,benPLT.NAME RES_PROGRAM_HIERARCHY
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_MTHD'
    AND LOOKUP_CODE = benPT.ENRT_MTHD_CD
    ) RES_ENROLLMENT_METHOD
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.AUTO_ENRT_MTHD_RL
    ) RES_AUTOMATIC_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT'
    AND LOOKUP_CODE = benPT.ENRT_CD
    ) RES_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.ENRT_RL
    ) RES_ENROLLMENT_FORMULA
,benPGMEO.MX_SPS_PCT_PRTT_LF_AMT RES_SPOUSE_INSURANCE_COVERAGE_
,benPGMEO.MX_DPNT_PCT_PRTT_LF_AMT RES_DEPENDENTS_INSURANCE_COVER
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_CVG_STRT'
    AND LOOKUP_CODE = benPT.ENRT_CVG_STRT_DT_CD
    ) RES_COVERAGE_START_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.ENRT_CVG_STRT_DT_RL
    ) RES_COVERAGE_START_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_CVG_END'
    AND LOOKUP_CODE = benPT.ENRT_CVG_END_DT_CD
    ) RES_PREVIOUS_COVERAGE_END_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.ENRT_CVG_END_DT_RL
    ) RES_PREVIOUS_COVERAGE_END_FORM
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_STRT'
    AND LOOKUP_CODE = benPT.RT_STRT_DT_CD
    ) RES_RATE_START_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.RT_STRT_DT_RL
    ) RES_RATE_START_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_END'
    AND LOOKUP_CODE = benPT.RT_END_DT_CD
    ) RES_PREVIOUS_RATE_END_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.RT_END_DT_RL
    ) RES_PREVIOUS_RATE_END_FORMULA
,TO_CHAR(benPT.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,DECODE(TO_CHAR(benPT.EFFECTIVE_END_DATE ,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(benPT.EFFECTIVE_END_DATE ,'DD-Mon-YYYY')) RES_EFFECTIVE_END_DATE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_DFLT_ENRT'
    AND LOOKUP_CODE = benPT.DFLT_ENRT_CD) RES_DEFAULT_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.DFLT_ENRT_DET_RL) RES_DEFAULT_ENROLLMENT_FORMULA
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.POSTELCN_EDIT_RL) RES_POST_ELECTION_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_DFLT_TO_ASN_PNDG_CTFN'
    AND LOOKUP_CODE = benPT.DFLT_TO_ASN_PNDG_CTFN_CD) RES_INTERIM_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.DFLT_TO_ASN_PNDG_CTFN_RL) RES_INTERIM_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_UNSSPND_ENRT'
    AND LOOKUP_CODE = benPT.UNSSPND_ENRT_CD) RES_UNSUSPEND_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.UNSSPND_ENRT_RL) RES_UNSUSPEND_ENROLLMENT_FORMU
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_UNSSPND_ENRT'
    AND LOOKUP_CODE = benPT.UNSSPND_RT_CD) RES_UNSUSPEND_RATE_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.UNSSPND_RT_RL) RES_UNSUSPEND_RATE_FORMULA
,benPT.MX_CVG_ALWD_AMT RES_ENROLLMENT_MAXIMUM
,DECODE(benPT.USE_TO_SUM_EE_LF_INS_FLAG,'Y','Yes','No') RES_SUM_PARTICIPANTS_INSURANCE
,DECODE(benPT.COORD_CVG_FOR_ALL_PLS_FLAG,'Y','Yes','No') RES_COORDINATE_COVERAGE_FOR_AL
,DECODE(benPT.SBJ_TO_SPS_LF_INS_MX_FLAG,'Y','Yes','No') RES_SUBJECT_TO_SPOUSES_INSURAN
,DECODE(benPT.SBJ_TO_DPNT_LF_INS_MX_FLAG,'Y','Yes','No') RES_SUBJECT_TO_DEPENDENTS_INSU
,DECODE(benPT.NO_MN_PL_TYP_OVERID_FLAG,'Y','Yes','No') RES_NO_MINIMUM
,DECODE(benPT.NO_MX_PL_TYP_OVRID_FLAG,'Y','Yes','No') RES_NO_MAXIMUM
,benPT.MN_ENRD_RQD_OVRID_NUM RES_PLAN_LIMITATION_MINIMUM
,benPT.MX_ENRD_ALWD_OVRID_NUM RES_PLAN_LIMITATION_MAXIMUM
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RQD_PERD_ENRT_NENRT_TM_UOM'
    AND LOOKUP_CODE = benPT.RQD_PERD_ENRT_NENRT_TM_UOM) RES_UNIT_OF_MEASURE
,benPT.RQD_PERD_ENRT_NENRT_VAL RES_NUMBER_OF_UNITS_IN_PERIOD
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPT.RQD_PERD_ENRT_NENRT_RL) RES_REQUIRED_PERIOD_OF_ENROLLM
,NULL RES_ASSIGN_ON_DEFAULT
,'Plan Type' RES_PROGRAM_HIERARCHY_DESCRIPT
,'2' RES_SEQUENCE_0

,benPT.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,benPT.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,benPT.CREATED_BY RSC_CREATED_BY
,benPT.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,benPGMEO.LEGISLATION_CODE RSC_COUNTRY_ID
	
	
FROM BEN_PGM_F benPGMEO
,BEN_PTIP_F benPT
,BEN_PL_TYP_F benPLT
WHERE benPGMEO.PGM_ID = benPT.PGM_ID
AND benPT.PL_TYP_ID = benPLT.PL_TYP_ID
AND SYSDATE BETWEEN benPGMEO.EFFECTIVE_START_DATE AND NVL(benPGMEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPT.EFFECTIVE_START_DATE AND NVL(benPT.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPLT.EFFECTIVE_START_DATE AND NVL(benPLT.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))


UNION

SELECT benPGMEO.NAME RES_PROGRAM_NAME
,benPL.NAME RES_PROGRAM_HIERARCHY
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_MTHD'
    AND LOOKUP_CODE = benPLIP.ENRT_MTHD_CD
    ) RES_ENROLLMENT_METHOD
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.AUTO_ENRT_MTHD_RL
    ) RES_AUTOMATIC_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT'
    AND LOOKUP_CODE = benPLIP.ENRT_CD
    ) RES_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.ENRT_RL
    ) RES_ENROLLMENT_FORMULA
,benPGMEO.MX_SPS_PCT_PRTT_LF_AMT RES_SPOUSE_INSURANCE_COVERAGE_
,benPGMEO.MX_DPNT_PCT_PRTT_LF_AMT RES_DEPENDENTS_INSURANCE_COVER
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_CVG_STRT'
    AND LOOKUP_CODE = benPLIP.ENRT_CVG_STRT_DT_CD
    ) RES_COVERAGE_START_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.ENRT_CVG_STRT_DT_RL
    ) RES_COVERAGE_START_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_ENRT_CVG_END'
    AND LOOKUP_CODE = benPLIP.ENRT_CVG_END_DT_CD
    ) RES_PREVIOUS_COVERAGE_END_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.ENRT_CVG_END_DT_RL
    ) RES_PREVIOUS_COVERAGE_END_FORM
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_STRT'
    AND LOOKUP_CODE = benPLIP.RT_STRT_DT_CD
    ) RES_RATE_START_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.RT_STRT_DT_RL
    ) RES_RATE_START_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_RT_END'
    AND LOOKUP_CODE = benPLIP.RT_END_DT_CD
    ) RES_PREVIOUS_RATE_END_DATE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.RT_END_DT_RL
    ) RES_PREVIOUS_RATE_END_FORMULA
,TO_CHAR(benPLIP.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,DECODE(TO_CHAR(benPLIP.EFFECTIVE_END_DATE ,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(benPLIP.EFFECTIVE_END_DATE ,'DD-Mon-YYYY')) RES_EFFECTIVE_END_DATE
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_DFLT_ENRT'
    AND LOOKUP_CODE = benPLIP.DFLT_ENRT_CD) RES_DEFAULT_ENROLLMENT_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.DFLT_ENRT_DET_RL) RES_DEFAULT_ENROLLMENT_FORMULA
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.POSTELCN_EDIT_RL) RES_POST_ELECTION_FORMULA
,(SELECT MEANING
    FROM FND_LOOKUP_VALUES
    WHERE LANGUAGE = USERENV('LANG')
    AND LOOKUP_TYPE = 'BEN_DFLT_TO_ASN_PNDG_CTFN'
    AND LOOKUP_CODE = benPLIP.DFLT_TO_ASN_PNDG_CTFN_CD) RES_INTERIM_RULE
,(SELECT FORMULA_NAME
    FROM FF_FORMULAS_TL
    WHERE LANGUAGE = USERENV('LANG')
    AND FORMULA_ID = benPLIP.DFLT_TO_ASN_PNDG_CTFN_RL) RES_INTERIM_FORMULA
,NULL RES_UNSUSPEND_ENROLLMENT_RULE
,NULL RES_UNSUSPEND_ENROLLMENT_FORMU
,NULL RES_UNSUSPEND_RATE_RULE
,NULL RES_UNSUSPEND_RATE_FORMULA
,benPLIP.MX_CVG_ALWD_AMT RES_ENROLLMENT_MAXIMUM
,NULL RES_SUM_PARTICIPANTS_INSURANCE
,NULL RES_COORDINATE_COVERAGE_FOR_AL
,NULL RES_SUBJECT_TO_SPOUSES_INSURAN
,NULL RES_SUBJECT_TO_DEPENDENTS_INSU
,NULL RES_NO_MINIMUM
,NULL RES_NO_MAXIMUM
,NULL RES_PLAN_LIMITATION_MINIMUM
,NULL RES_PLAN_LIMITATION_MAXIMUM
,NULL RES_UNIT_OF_MEASURE
,NULL RES_NUMBER_OF_UNITS_IN_PERIOD
,NULL RES_REQUIRED_PERIOD_OF_ENROLLM
,DECODE(benPLIP.DFLT_FLAG,'Y','Yes','No') RES_ASSIGN_ON_DEFAULT
,'Plan' RES_PROGRAM_HIERARCHY_DESCRIPT
,'3' RES_SEQUENCE_0

,benPLIP.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,benPLIP.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,benPLIP.CREATED_BY RSC_CREATED_BY
,benPLIP.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,benPGMEO.LEGISLATION_CODE RSC_COUNTRY_ID
	
	
FROM BEN_PGM_F benPGMEO
,BEN_PLIP_F benPLIP
,BEN_PL_F benPL
WHERE benPGMEO.PGM_ID = benPLIP.PGM_ID
AND benPLIP.PL_ID = benPL.PL_ID
AND SYSDATE BETWEEN benPGMEO.EFFECTIVE_START_DATE AND NVL(benPGMEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPLIP.EFFECTIVE_START_DATE AND NVL(benPLIP.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPL.EFFECTIVE_START_DATE AND NVL(benPL.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))

ORDER BY RES_PROGRAM_NAME,RES_SEQUENCE_0,RES_PROGRAM_HIERARCHY)
