 /* ****************************************************************************
 * $Revision: 48884 $:
 * $Author: dhara.pithadiya $:
 * $Date: 2015-08-18 14:24:02 +0700 (Tue, 18 Aug 2015) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/reverse_sql/FINANCIALS/Manage%20Transaction%20Types%20-%20Manage%20Transaction%20Types.sql $:
 * $Id: Manage Transaction Types - Manage Transaction Types.sql 48884 2015-08-18 07:24:02Z dhara.pithadiya $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */


SELECT planTypesE0.NAME RES_NAME
,buE0.BU_NAME RES_BUSINESS_UNIT
,DECODE(rateSchedulsE0.USE_PLANNING_RATES_FLAG,'Y','Yes','No') RES_USE_PLANNING_RATES
,(CASE
	WHEN rateSchedulsE0.USE_PLANNING_RATES_FLAG = 'N' THEN
		(SELECT RATE_SCHEDULE_NAME
			FROM PJF_RATE_SCHEDULES_TL
			WHERE LANGUAGE = USERENV('LANG')
			AND RATE_SCHEDULE_ID = rateSchedulsE0.RES_CLASS_RAW_COST_SCH_ID)
	END) RES_RESOURCE_CLASS_RAW_COST_RA
,(CASE
	WHEN rateSchedulsE0.USE_PLANNING_RATES_FLAG = 'Y' THEN
		(SELECT RATE_SCHEDULE_NAME
			FROM PJF_RATE_SCHEDULES_TL
			WHERE LANGUAGE = USERENV('LANG')
			AND RATE_SCHEDULE_ID = rateSchedulsE0.COST_EMP_RATE_SCH_ID)
	END) RES_PERSON
,(CASE
	WHEN rateSchedulsE0.USE_PLANNING_RATES_FLAG = 'Y' THEN
		(SELECT RATE_SCHEDULE_NAME
			FROM PJF_RATE_SCHEDULES_TL
			WHERE LANGUAGE = USERENV('LANG')
			AND RATE_SCHEDULE_ID = rateSchedulsE0.COST_JOB_RATE_SCH_ID)
	END) RES_JOB
,(CASE
	WHEN rateSchedulsE0.USE_PLANNING_RATES_FLAG = 'Y' THEN
		(SELECT RATE_SCHEDULE_NAME
			FROM PJF_RATE_SCHEDULES_TL
			WHERE LANGUAGE = USERENV('LANG')
			AND RATE_SCHEDULE_ID = rateSchedulsE0.COST_NON_LBR_RES_RATE_SCH_ID)
	END) RES_NONLABOR_RESOURCE
,(CASE
	WHEN rateSchedulsE0.USE_PLANNING_RATES_FLAG = 'Y' THEN
		(SELECT RATE_SCHEDULE_NAME
			FROM PJF_RATE_SCHEDULES_TL
			WHERE LANGUAGE = USERENV('LANG')
			AND RATE_SCHEDULE_ID = rateSchedulsE0.RES_CLASS_RAW_COST_SCH_ID)
	END) RES_RESOURCE_CLASS
,(CASE
	WHEN rateSchedulsE0.USE_PLANNING_RATES_FLAG = 'Y' THEN
		(SELECT IND_SCH_NAME
			FROM PJF_IND_RATE_SCH_TL
			WHERE LANGUAGE = USERENV('LANG')
			AND IND_RATE_SCH_ID = rateSchedulsE0.COST_BRDND_RATE_SCH_ID)
	END) RES_BURDEN_SCHEDULE
,rateSchedulsE0.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,rateSchedulsE0.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,rateSchedulsE0.CREATED_BY  RSC_CREATED_BY
,rateSchedulsE0.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,rateSchedulsE0.BU_ID RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM PJO_PLAN_TYPES_VL planTypesE0
,PJO_PLANNING_OPTIONS planOptionsE0
,PJO_PLAN_TYPE_RATE_SCHS rateSchedulsE0
,FUN_ALL_BUSINESS_UNITS_V buE0
WHERE planTypesE0.PLAN_TYPE_CODE = 'PROJECT_PLAN'
AND planTypesE0.PLAN_TYPE_ID = planOptionsE0.PLAN_TYPE_ID
AND planOptionsE0.PROJECT_ID = 0
AND planTypesE0.PLAN_TYPE_ID = rateSchedulsE0.PLAN_TYPE_ID
AND rateSchedulsE0.BU_ID = buE0.BU_ID
ORDER BY planTypesE0.NAME
,buE0.BU_NAME