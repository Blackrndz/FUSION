/* ****************************************************************************
 * $Revision: 54943 $:
 * $Author: paul.wakefield $:
 * $Date: 2016-05-04 13:45:23 +0700 (Wed, 04 May 2016) $:
 * $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13.19/trunk/core/reverse_sql/FINANCIALS/Manage%20Trading%20Community%20Person%20Lookups%20-%20Standard%20Lookup%20Type.sql $:
 * $Id: Manage Trading Community Person Lookups - Standard Lookup Type.sql 54943 2016-05-04 06:45:23Z paul.wakefield $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
SELECT DISTINCT benPLEO.NAME RES_PLAN_NAME
,benPGMEO.NAME RES_PROGRAM_NAME
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = benPGMEO.PGM_TYP_CD 
	AND LANGUAGE = USERENV('LANG') AND LOOKUP_TYPE = 'BEN_PGM_TYP'
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_PROGRAM_TYPE
,benPGMEO.PGM_DESC RES_DESCRIPTION
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = benPLIPEO.PLIP_STAT_CD 
	AND LANGUAGE = USERENV('LANG') AND LOOKUP_TYPE = 'BEN_STAT'
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_ATTACHMENT_STATUS
,TO_CHAR(benPLIPEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,TO_CHAR(benPLIPEO.EFFECTIVE_END_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_END_DATE
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = benPGMEO.PGM_STAT_CD 
	AND LANGUAGE = USERENV('LANG') AND LOOKUP_TYPE = 'BEN_STAT'
	AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_STATUS
,benPLIPEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,benPLIPEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,benPLIPEO.CREATED_BY RSC_CREATED_BY
,benPLIPEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,benPLEO.LEGISLATION_CODE RSC_COUNTRY_ID

FROM BEN_PL_F benPLEO
,BEN_PLIP_F benPLIPEO
,BEN_PGM_F benPGMEO
,BEN_PL_TYP_F benPLTYPEO
WHERE benPLEO.PL_TYP_ID = benPLTYPEO.PL_TYP_ID 
AND benPLEO.PL_ID = benPLIPEO.PL_ID
AND benPLIPEO.PGM_ID = benPGMEO.PGM_ID
AND benPLEO.INVK_FLX_CR_PL_FLAG = 'Y'
AND SYSDATE BETWEEN benPLEO.EFFECTIVE_START_DATE AND NVL(benPLEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPLIPEO.EFFECTIVE_START_DATE AND NVL(benPLIPEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND SYSDATE BETWEEN benPGMEO.EFFECTIVE_START_DATE AND NVL(benPGMEO.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
ORDER BY RES_PLAN_NAME,RES_PROGRAM_NAME 
