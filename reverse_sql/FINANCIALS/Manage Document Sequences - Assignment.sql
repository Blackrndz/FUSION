/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Document%20Sequences%20-%20Assignment.sql $:
 * $Id: Manage Document Sequences - Assignment.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */


SELECT DOCUMENTSEQUENCESEO.NAME RES_DOCUMENT_SEQUENCE_NAME
,null /*DOCSEQUENCEASSIGNMENTSEO.CATEGORY_CODE*/ RES_CATEGORY
,DOCSEQUENCECATEGORIESPEO.NAME RES_DOCUMENT_SEQUENCE_CATEGORY
,ApplicationPEO.APPLICATION_NAME RES_APPLICATION
,LOOKUPPEO.MEANING  RES_METHOD
,TO_CHAR(DOCSEQUENCEASSIGNMENTSEO.START_DATE,'DD-Mon-YYYY') RES_START_DATE
,TO_CHAR(DOCSEQUENCEASSIGNMENTSEO.END_DATE,'DD-Mon-YYYY') RES_END_DATE
,(CASE DOCUMENTSEQUENCESEO.DETERMINANT_TYPE 
		WHEN 'LEDGER' THEN
			DETERMINANTVALUELEDGEREO.NAME			
		WHEN 'BU' THEN
		   DETERMINANTVALUEBUEO.NAME
		WHEN 'LE' THEN   		  
		  DETERMINANTVALUELEGALEO.NAME
		ELSE
		  NULL
	END )	   RES_VALUE
,DeterminantValueLegalEO.LEGAL_ENTITY_IDENTIFIER RES_LEGAL_ENTITY_IDENTIFIER
,DocSequenceAssignmentsEO.LAST_UPDATED_BY   RSC_LAST_UPDATED_BY
,DocSequenceAssignmentsEO.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,DocSequenceAssignmentsEO.CREATED_BY RSC_CREATED_BY
,DocSequenceAssignmentsEO.CREATION_DATE RSC_CREATION_DATE
,(CASE DOCUMENTSEQUENCESEO.DETERMINANT_TYPE 
	WHEN 'LEDGER' THEN
		DocSequenceAssignmentsEO.DETERMINANT_VALUE
	END) RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,(CASE DOCUMENTSEQUENCESEO.DETERMINANT_TYPE 
	WHEN 'BU' THEN
		DocSequenceAssignmentsEO.DETERMINANT_VALUE
	END) RSC_BUSINESS_UNIT_ID
,(CASE DOCUMENTSEQUENCESEO.DETERMINANT_TYPE 
	WHEN 'LE' THEN
		DocSequenceAssignmentsEO.DETERMINANT_VALUE
	END) RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM FND_DOCUMENT_SEQUENCES DocumentSequencesEO
,FND_DOC_SEQUENCE_ASSIGNMENTS DocSequenceAssignmentsEO
,FND_DOC_SEQUENCE_CATEGORIES DocSequenceCategoriesPEO
,HR_ALL_ORGANIZATION_UNITS_F_VL DeterminantValueBUEO
,GL_LEDGERS_PUBLIC_V DeterminantValueLedgerEO
,XLE_FIRSTPARTY_INFORMATION_V DETERMINANTVALUELEGALEO
,FND_LOOKUPS LOOKUPPEO
,FND_APPLICATION_VL APPLICATIONPEO
WHERE  DocumentSequencesEO.DOC_SEQUENCE_ID  =  DocSequenceAssignmentsEO.DOC_SEQUENCE_ID
and DocSequenceAssignmentsEO.APPLICATION_ID  = DocSequenceCategoriesPEO.APPLICATION_ID
AND DocSequenceAssignmentsEO.APPLICATION_ID = APPLICATIONPEO.APPLICATION_ID
AND DocSequenceAssignmentsEO.CATEGORY_CODE     = DocSequenceCategoriesPEO.CODE
and DOCSEQUENCEASSIGNMENTSEO.DETERMINANT_VALUE = DETERMINANTVALUEBUEO.ORGANIZATION_ID(+)
AND(sysdate BETWEEN DeterminantValueBUEO.EFFECTIVE_START_DATE(+) AND DeterminantValueBUEO.EFFECTIVE_END_DATE(+))
AND DocSequenceAssignmentsEO.DETERMINANT_VALUE = DeterminantValueLedgerEO.LEDGER_ID(+)
AND DOCSEQUENCEASSIGNMENTSEO.DETERMINANT_VALUE = DETERMINANTVALUELEGALEO.LEGAL_ENTITY_ID(+)
AND LOOKUPPEO.LOOKUP_TYPE(+) = 'FND_DOCSEQ_ASSIGN_METHOD'
AND DOCSEQUENCEASSIGNMENTSEO.METHOD_CODE = LOOKUPPEO.LOOKUP_CODE(+)
Order by DOCUMENTSEQUENCESEO.NAME,DocSequenceAssignmentsEO.DOC_SEQUENCE_ASSIGNMENT_ID