/* ****************************************************************************
* $Revision: 59117 $:
* $Author: nasrullah.dusenmahamad $:
* $Date: 2016-10-21 11:10:58 +0700 (Fri, 21 Oct 2016) $:
* $HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/reverse_sql/FINANCIALS/Manage%20Key%20Flexfields%20-%20Segment%20Labels.sql $:
* $Id: Manage Key Flexfields - Segment Labels.sql 59117 2016-10-21 04:10:58Z nasrullah.dusenmahamad $:
* ****************************************************************************
* Description:
* ************************************************************************** */


WITH GEO AS (
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT1 GEO_VALUE
	,1 SEQ
	,'GEOGRAPHY_ELEMENT1' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT2 GEO_VALUE
	,2 SEQ
	,'GEOGRAPHY_ELEMENT2' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT3 GEO_VALUE
	,3 SEQ
	,'GEOGRAPHY_ELEMENT3' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT4 GEO_VALUE
	,4 SEQ
	,'GEOGRAPHY_ELEMENT4' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT5 GEO_VALUE
	,5 SEQ
	,'GEOGRAPHY_ELEMENT5' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT6 GEO_VALUE
	,6 SEQ
	,'GEOGRAPHY_ELEMENT6' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT7 GEO_VALUE
	,7 SEQ
	,'GEOGRAPHY_ELEMENT7' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT8 GEO_VALUE
	,8 SEQ
	,'GEOGRAPHY_ELEMENT8' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT9 GEO_VALUE
	,9 SEQ
	,'GEOGRAPHY_ELEMENT9' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
	
	UNION 
	
	SELECT GEOGRAPHY_ID
	,GEOGRAPHY_ELEMENT10 GEO_VALUE
	,10 SEQ
	,'GEOGRAPHY_ELEMENT10' GEOGRAPHY_ELEMENT_COLUMN 
	,COUNTRY_CODE
	FROM HZ_GEOGRAPHIES
)
SELECT RES_ZONE_TYPE
,RES_SELECT_BOUNDARY
,RES_GEOGRAPHY_NAME
,RES_GEOGRAPHY_VALUE
,RES_ZONE_CREATION_ALLOWED
,RSC_LAST_UPDATED_BY
,RSC_LAST_UPDATE_DATE
,RSC_CREATED_BY
,RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM (SELECT ShippingZonesE0.GEOGRAPHY_TYPE_NAME RES_ZONE_TYPE
	,(CASE
		WHEN ShippingZonesE0.LIMITED_BY_GEOGRAPHY_ID IS NULL THEN 
			'World'
		ELSE
			'Bounded by country'
		END) RES_SELECT_BOUNDARY
	,(CASE
		WHEN GEOGRAPHY_ELEMENT_COLUMN = 'GEOGRAPHY_ELEMENT1' THEN
			'Country'
		ELSE
			(SELECT GeoTypesE0.GEOGRAPHY_TYPE_NAME
				FROM HZ_GEO_STRUCTURE_LEVELS GeoStrcLvE0
				,HZ_GEOGRAPHY_TYPES_VL GeoTypesE0
				WHERE GeoStrcLvE0.GEOGRAPHY_TYPE = GeoTypesE0.GEOGRAPHY_TYPE
				AND GeoStrcLvE0.COUNTRY_CODE = GEO.COUNTRY_CODE
				AND GeoStrcLvE0.GEOGRAPHY_ELEMENT_COLUMN = GEO.GEOGRAPHY_ELEMENT_COLUMN)
		END) RES_GEOGRAPHY_NAME
	,GEO.GEO_VALUE RES_GEOGRAPHY_VALUE
	,'' RES_ZONE_CREATION_ALLOWED
	,ShippingZonesE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
	,ShippingZonesE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
	,ShippingZonesE0.CREATED_BY RSC_CREATED_BY
	,ShippingZonesE0.CREATION_DATE RSC_CREATION_DATE
	,GEO.SEQ
	FROM HZ_GEOGRAPHY_TYPES_VL ShippingZonesE0
	,GEO
	WHERE ShippingZonesE0.GEOGRAPHY_USE = 'SHIPPING'
	AND ShippingZonesE0.LIMITED_BY_GEOGRAPHY_ID IS NOT NULL
	AND ShippingZonesE0.LIMITED_BY_GEOGRAPHY_ID = GEO.GEOGRAPHY_ID(+))
WHERE RES_GEOGRAPHY_NAME IS NOT NULL
ORDER BY RES_ZONE_TYPE
,SEQ