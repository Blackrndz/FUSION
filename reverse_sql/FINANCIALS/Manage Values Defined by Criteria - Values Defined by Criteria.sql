/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Values%20Defined%20by%20Criteria%20-%20Values%20Defined%20by%20Criteria.sql $:
 * $Id: Manage Values Defined by Criteria - Values Defined by Criteria.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */ 

 -- RSC_PREREQUISITE_OBJECTS=PAY_VALUE_DEFINITIONS_F
 -- RSC_PREREQUISITE_OBJECTS=PAY_VALUE_DEFINITIONS_TL
 
SELECT  payVALUESDEFINITLEO.NAME RES_NAME
,TO_CHAR(payVALUESDEFINIEO.EFFECTIVE_START_DATE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,NVL((SELECT NAME FROM PER_LEGISLATIVE_DATA_GROUPS_VL 
	WHERE LEGISLATIVE_DATA_GROUP_ID =  payVALUESDEFINIEO.LEGISLATIVE_DATA_GROUP_ID),(SELECT NAME FROM PER_LEGISLATIVE_DATA_GROUPS_VL WHERE LEGISLATION_CODE = payVALUESDEFINIEO.LEGISLATION_CODE AND ROWNUM = 1)) RES_LEGISLATIVE_DATA_GROUP 
,(
	CASE
		WHEN EXISTS (SELECT NULL
			FROM PAY_VALUE_DEFINITIONS_F WHERE VALUE_GROUP_ID = payVALUESDEFINIEO.VALUE_GROUP_ID AND MODULE_ID IS NOT NULL
			)
		THEN 'Use existing value definition group'
		ELSE 'Create new value definition group'
	END) RES_USE_OR_CREATE_VALUE_DEFINI
,(SELECT NAME FROM PAY_VALUE_GROUPS_VL WHERE VALUE_GROUP_ID = payVALUESDEFINIEO.VALUE_GROUP_ID) RES_VALUE_DEFINITION_GROUP
,(SELECT NAME FROM PAY_CALC_TYPES_VL WHERE CALC_TYPE_ID = payVALUESDEFINIEO.DEFAULT_CALC_TYPE_ID ) RES_DEFAULT_CALCULATION_TYPE 
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_CODE = payVALUESDEFINIEO.PERIODICITY_TYPE
		AND LOOKUP_TYPE = 'ORA_PAY_VBYC_PERIOD_OR_UNIT' AND LANGUAGE = USERENV('LANG')
		AND SYSDATE BETWEEN START_DATE_ACTIVE AND NVL(END_DATE_ACTIVE ,TO_DATE('31-12-4712','DD-MM-YYYY'))) RES_PERIOD_OR_UNIT

,payVALUESDEFINIEO.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,payVALUESDEFINIEO.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,payVALUESDEFINIEO.CREATED_BY RSC_CREATED_BY
,payVALUESDEFINIEO.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM PAY_VALUE_DEFINITIONS_F payVALUESDEFINIEO
,PAY_VALUE_DEFINITIONS_TL payVALUESDEFINITLEO
WHERE payVALUESDEFINIEO.CALC_TYPE_ID = (SELECT CALC_TYPE_ID FROM PAY_CALC_TYPES_VL WHERE NAME LIKE 'Value By Criteria' )
AND payVALUESDEFINIEO.VALUE_DEFN_ID  = payVALUESDEFINITLEO.VALUE_DEFN_ID 
AND payVALUESDEFINITLEO.LANGUAGE = USERENV('LANG')
AND payVALUESDEFINIEO.PARENT_VALUE_DEFN_ID IS NULL
--AND SYSDATE BETWEEN payVALUESDEFINIEO.EFFECTIVE_START_DATE AND NVL(payVALUESDEFINIEO.EFFECTIVE_END_DATE ,TO_DATE('31-12-4712','DD-MM-YYYY')) 
ORDER BY RES_NAME
