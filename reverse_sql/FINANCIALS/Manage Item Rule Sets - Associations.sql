/* ****************************************************************************
 * $Revision:  $:
 * $Author: Nasrullah Dusenmahamad $:
 * $Date: 2018-07-04 $:
 * $HeadURL:$:
 * $Id: Manage Bank Branch Addresses - Botswana.sql $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

-- RSC_PREREQUISITE_OBJECTS=EGO_RL_BLEND_RULE_SET_ASSOCS

SELECT ruleSetsE0.RULE_SET_DISPLAY_NAME RES_DISPLAY_NAME
,ruleSetsE0.RULE_SET_NAME RES_INTERNAL_NAME
,(CASE
	WHEN ruleSetsE0.ASSOCIATION_TYPE = 'AG' THEN --Attribute Group
		ruleSetsE0.ASSOCIATION_PK2
	WHEN ruleSetsE0.ASSOCIATION_TYPE = 'CT' THEN --Change Order Type
		(SELECT TYPE_NAME
			FROM EGO_CHANGE_TYPES_VL
			WHERE TO_CHAR(CHANGE_TYPE_ID) = ruleSetsE0.ASSOCIATION_PK1)
	WHEN ruleSetsE0.ASSOCIATION_TYPE = 'ICC' THEN --Item Class
		(SELECT ITEM_CLASS_NAME
			FROM EGP_ITEM_CLASSES_VL
			WHERE TO_CHAR(ITEM_CLASS_ID) = ruleSetsE0.ASSOCIATION_PK1)
	WHEN ruleSetsE0.ASSOCIATION_TYPE = 'NIR' THEN --New Item Request
		(SELECT TYPE_NAME
			FROM EGO_CHANGE_TYPES_VL
			WHERE  TO_CHAR(CHANGE_TYPE_ID) = ruleSetsE0.ASSOCIATION_PK1)
	END) RES_ASSOCIATION_NAME
,'' RES_DESCRIPTION
,blendAccE0.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,blendAccE0.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,blendAccE0.CREATED_BY RSC_CREATED_BY
,blendAccE0.CREATION_DATE RSC_CREATION_DATE
,NULL RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM EGO_RL_RULE_SETS_VL ruleSetsE0
,EGO_RL_BLEND_RULE_SET_ASSOCS blendAccE0
WHERE ruleSetsE0.RULE_SET_ID = blendAccE0.RULE_SET_ID
AND ruleSetsE0.RULE_SET_TYPE = 'ORA_BLENDING'
ORDER BY ruleSetsE0.RULE_SET_DISPLAY_NAME
,RES_ASSOCIATION_NAME