/* ****************************************************************************
 * $Revision: 53782 $:
 * $Author: nasrullah.dusenmahamad $:
 * $Date: 2016-03-31 18:00:16 +0700 (Tue, 22 Mar 2016) $:
 * $HeadURL: $:
 * $Id: Manage Applications Core Value Sets - Manage Applications Core Value Sets.sql 53782 2016-03-22 11:00:16Z nasrullah.dusenmahamad $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- FIELD_TO_APPLY_FUNCTION=RES_TAX_EXPENSE/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_INTERIM_TAX/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_TAX_RECOVERABLE_ACCOUNT/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_TAX_LIABILITY_ACCOUNT/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_FINANCE_CHARGE_TAX_LIABILI/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_NONRECOVERABLE_TAX_ACCOUNT/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_NONRECOVERABLE_TAX_ACCOU_0/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_NONRECOVERABLE_TAX_ACCOU_1/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_EXPENSE_AND_REVENUE_ACCOUN/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_EXPENSE_AND_REVENUE_ACCO_2/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_EXPENSE_AND_REVENUE_ACCO_3/get_code_combination
-- FIELD_TO_APPLY_FUNCTION=RES_EXPENSE_AND_REVENUE_ACCO_4/get_code_combination

 
SELECT HEAD.TAX_REGIME_CODE RES_TAX_REGIME_CODE
,HEAD.PARTY_NAME RES_CONFIGURATION_OWNER
,HEAD.TAX RES_TAX
,HEAD.TAX_FULL_NAME RES_TAX_NAME
,Detail.LEDGER_NAME RES_LEDGER
,Detail.NAME RES_BUSINESS_UNIT
,Detail.NON_REC_ACCOUNT_CCID RES_TAX_EXPENSE
,Detail.INTERIM_TAX_CCID RES_INTERIM_TAX
,Detail.TAX_ACCOUNT_CCID RES_TAX_RECOVERABLE_ACCOUNT
,Detail.TAX_LIAB_ACCT_CCID RES_TAX_LIABILITY_ACCOUNT
,Detail.FINCHRG_NON_REC_TAX_CCID RES_FINANCE_CHARGE_TAX_LIABILI
,Detail.EDISC_NON_REC_TAX_CCID RES_NONRECOVERABLE_TAX_ACCOUNT
,Detail.ADJ_NON_REC_TAX_CCID RES_NONRECOVERABLE_TAX_ACCOU_0
,Detail.UNEDISC_NON_REC_TAX_CCID RES_NONRECOVERABLE_TAX_ACCOU_1
,Detail.EDISC_CCID RES_EXPENSE_AND_REVENUE_ACCOUN
,Detail.FINCHRG_CCID RES_EXPENSE_AND_REVENUE_ACCO_2
,Detail.ADJ_CCID RES_EXPENSE_AND_REVENUE_ACCO_3
,Detail.UNEDISC_CCID RES_EXPENSE_AND_REVENUE_ACCO_4
,Detail.LAST_UPDATED_BY RSC_LAST_UPDATED_BY
,Detail.LAST_UPDATE_DATE RSC_LAST_UPDATE_DATE
,Detail.CREATED_BY RSC_CREATED_BY
,Detail.CREATION_DATE RSC_CREATION_DATE
,Detail.LEDGER_ID RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,Detail.BU_ID RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM
	(SELECT TaxTLEO.TAX_REGIME_CODE
	,ZFPOMV.PARTY_NAME
	,TaxTLEO.TAX
	,TaxTLEO.TAX_FULL_NAME
	,TaxTLEO.tax_id
	,RegimeTLEO.REGIME_TYPE_FLAG
	FROM ZX_TAXES_VL TaxTLEO
	,ZX_FIRST_PARTY_ORGS_MOAC_V ZFPOMV
	,ZX_REGIMES_VL RegimeTLEO
	WHERE ZFPOMV.PARTY_TAX_PROFILE_ID                = TaxTLEO.CONTENT_OWNER_ID
	AND RegimeTLEO.TAX_REGIME_CODE                   = TaxTLEO.TAX_REGIME_CODE
	AND NVL(RegimeTLEO.REGIME_TYPE_FLAG,'I')         = 'I'
	) HEAD
,(SELECT ZA.TAX_ACCOUNT_ENTITY_CODE
	,ZA.TAX_ACCOUNT_CCID
	,ZA.INTERIM_TAX_CCID
	,ZA.NON_REC_ACCOUNT_CCID
	,ZA.FINCHRG_NON_REC_TAX_CCID
	,ZA.EDISC_NON_REC_TAX_CCID
	,ZA.ADJ_NON_REC_TAX_CCID
	,ZA.UNEDISC_NON_REC_TAX_CCID
	,ZA.EDISC_CCID
	,ZA.FINCHRG_CCID
	,ZA.ADJ_CCID
	,ZA.UNEDISC_CCID
	,ZA.CREATED_BY
	,ZA.CREATION_DATE
	,ZA.LAST_UPDATED_BY
	,ZA.LAST_UPDATE_DATE
	,ZA.LAST_UPDATE_LOGIN
	,ZA.TAX_ACCOUNT_ID
	,ZA.TAX_ACCOUNT_ENTITY_ID
	,ZA.LEDGER_ID
	,ZA.OBJECT_VERSION_NUMBER
	,ZA.INTERNAL_ORGANIZATION_ID
	,BusinessUnitPEO.BU_NAME AS NAME
	,GL.NAME                 AS LEDGER_NAME
	,ZA.TAX_LIAB_ACCT_CCID
	,BusinessUnitPEO.BU_ID
	FROM ZX_ACCOUNTS ZA
	,GL_LEDGERS GL
	,FND_ID_FLEX_STRUCTURES FIFS
	,FUN_ALL_BUSINESS_UNITS_V BusinessUnitPEO
	WHERE GL.LEDGER_ID (+)        = ZA.LEDGER_ID
	AND FIFS.APPLICATION_ID (+)   = 101
	AND FIFS.ID_FLEX_CODE (+)     = 'GL#'
	AND FIFS.ID_FLEX_NUM          = GL.CHART_OF_ACCOUNTS_ID
	AND BusinessUnitPEO.BU_ID (+) = ZA.INTERNAL_ORGANIZATION_ID
	) Detail
WHERE HEAD.tax_id = Detail.tax_account_entity_id
ORDER BY Head.TAX_REGIME_CODE
,Head.TAX