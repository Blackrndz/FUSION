/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Transaction%20Sources%20-%20Manage%20Transaction%20Sources.sql $:
 * $Id: Manage Transaction Sources - Manage Transaction Sources.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */



SELECT QRSLT.TRANSACTION_SOURCE_SET RES_TRANSACTION_SOURCE_SET,
QRSLT.NAME2 RES_LEGAL_ENTITY,
QRSLT.LEGAL_ENTITY_IDENTIFIER RES_LEGAL_ENTITY_IDENTIFIER ,
QRSLT.NAME RES_NAME,
QRSLT.DESCRIPTION RES_DESCRIPTION,
QRSLT.MEANING1 RES_TYPE,
QRSLT.STATUS_MEANING RES_ACTIVE,
TO_CHAR(QRSLT.START_DATE,'DD-Mon-YYYY') RES_FROM_DATE,
TO_CHAR(QRSLT.END_DATE,'DD-Mon-YYYY')  RES_TO_DATE,
DECODE(QRSLT.AUTO_TRX_NUMBERING_FLAG,'Y','Yes','No') RES_AUTOMATIC_TRANSACTION_NUMB,
QRSLT.LAST_BATCH_NUM RES_LAST_TRANSACTION_NUMBER,
QRSLT.MEANING2 RES_RECEIPT_HANDLING_FOR_CREDI,
DECODE(QRSLT.COPY_DOC_NUMBER_FLAG,'Y','Yes','No') RES_COPY_DOCUMENT_NUMBER_TO_TR ,
DECODE(QRSLT.ALLOW_DUPLICATE_TRX_NUM_FLAG,'Y','Yes','No')  RES_ALLOW_DUPLICATE_TRANSACTIO,
DECODE(QRSLT.COPY_INV_TIDFF_TO_CM_FLAG,'Y','Yes','No') RES_COPY_TRANSACTION_INFORMATI,
DECODE(QRSLT.DEFAULT_REFERENCE,NULL,NULL,(FUSION.ARPT_SQL_FUNC_UTIL.GET_LOOKUP_MEANING('PA_CODE',QRSLT.DEFAULT_REFERENCE))) RES_REFERENCE_FIELD_DEFAULT_VA,
QRSLT.STANDARD_TRANSACTION_TYPE RES_STANDARD_TRANSACTION_TYPE,
DECODE(QRSLT.CM_BATCH_SOURCE_SEQ_ID,null,null,(select name from FUSION.RA_BATCH_SOURCES_ALL RABATCHSOURCESALL where RABATCHSOURCESALL.BATCH_SOURCE_SEQ_ID = QRSLT.CM_BATCH_SOURCE_SEQ_ID)) RES_CREDIT_TRANSACTION_SOURCE,
Decode(QRSLT.MEANING1,'Manual',null,DECODE(QRSLT.INVALID_LINES_RULE,NULL,NULL,(FUSION.ARPT_SQL_FUNC_UTIL.GET_LOOKUP_MEANING('CRE/REJ',QRSLT.INVALID_LINES_RULE)))) RES_INVALID_LINE,
QRSLT.GL_DATE_PERIOD_RULE RES_ACCOUNTING_DATE_IN_A_CLOSE,
QRSLT.GROUPING_RULE RES_GROUPING_RULE,
DECODE(QRSLT.MEANING1,'Manual',null,DECODE(QRSLT.CREATE_CLEARING_FLAG,'Y','Yes','No')) RES_CREATE_CLEARING,
Decode(QRSLT.MEANING1,'Manual',null,DECODE(QRSLT.ALLOW_SALES_CREDIT_FLAG,'Y','Yes','No')) RES_ALLOW_SALES_CREDITS,
QRSLT.SALESPERSON_RULE RES_SALESPERSON,
QRSLT.SALES_CREDIT_TYPE_RULE RES_SALES_CREDIT_TYPE,
QRSLT.SALES_CREDIT_RULE RES_SALES_CREDIT,
QRSLT.BILL_CUSTOMER_RULE RES_BILL_TO_CUSTOMER,
QRSLT.BILL_ADDRESS_RULE RES_BILL_TO_ADDRESS,
QRSLT.BILL_CONTACT_RULE RES_BILL_TO_CONTACT,
QRSLT.SHIP_CUSTOMER_RULE RES_SHIP_TO_CUSTOMER,
QRSLT.SHIP_ADDRESS_RULE RES_SHIP_TO_ADDRESS,
QRSLT.SHIP_CONTACT_RULE RES_SHIP_TO_CONTACT,
QRSLT.SOLD_CUSTOMER_RULE RES_SOLD_TO_CUSTOMER,
QRSLT.RECEIPT_METHOD_RULE RES_PAYMENT_METHOD_RULE,
QRSLT.CUSTOMER_BANK_ACCOUNT_RULE RES_CUSTOMER_BANK_ACCOUNT,
QRSLT.INVOICING_RULE_RULE RES_INVOICING_RULE,
QRSLT.ACCOUNTING_RULE_RULE RES_RULE,
QRSLT.ACCOUNTING_FLEXFIELD_RULE RES_ACCOUNTING_FLEXFIELD,
Decode(QRSLT.MEANING1,'Manual',null,DECODE(QRSLT.DERIVE_DATE_FLAG,'Y','Yes','No')) RES_DERIVE_DATE,
QRSLT.TERM_RULE RES_PAYMENT_TERMS,
QRSLT.REV_ACC_ALLOCATION_RULE RES_REVENUE_ACCOUNT_ALLOCATION,
QRSLT.CUST_TRX_TYPE_RULE RES_TRANSACTION_TYPE,
QRSLT.MEMO_REASON_RULE RES_MEMO_REASON,
QRSLT.MEMO_LINE_RULE RES_MEMO_LINE_RULE,
QRSLT.INVENTORY_ITEM_RULE RES_INVENTORY_ITEM,
QRSLT.UNIT_OF_MEASURE_RULE RES_UNIT_OF_MEASURE,
QRSLT.FOB_POINT_RULE RES_FOB_POINT,
QRSLT.SHIP_VIA_RULE RES_FREIGHT_CARRIER,
QRSLT.RELATED_DOCUMENT_RULE RES_RELATED_DOCUMENT,
Decode(QRSLT.MEANING1,'Manual',null,decode(QRSLT.BM_ENDPOINT_KEY_NAME,'Y','Yes','No')) RES_ORACLE_CPQ_CLOUD_INTEGRATI ,
null RES_DEFINE_ENDPOINT_POLICY_URL ,
null RES_DEFINE_ENDPOINT_POLICY_SEC ,
null RES_DEFINE_ENDPOINT_POLICY_USE ,
null RES_DEFINE_ENDPOINT_POLICY_PAS ,
null RES_DEFINE_ENDPOINT_POLICY_KEY 
,QRSLT.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,QRSLT.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,QRSLT.CREATED_BY  RSC_CREATED_BY
,QRSLT.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,QRSLT.LEGAL_ENTITY_ID RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

from (SELECT 
  RaBatchSourcesAll.ACCOUNTING_FLEXFIELD_RULE,
  RaBatchSourcesAll.ACCOUNTING_RULE_RULE,
  RaBatchSourcesAll.AGREEMENT_RULE,
  RaBatchSourcesAll.ALLOW_SALES_CREDIT_FLAG,
  RaBatchSourcesAll.AUTO_BATCH_NUMBERING_FLAG,
  RaBatchSourcesAll.BATCH_SOURCE_ID,
  RaBatchSourcesAll.BATCH_SOURCE_SEQ_ID,
  RaBatchSourcesAll.BILL_ADDRESS_RULE,
  RaBatchSourcesAll.BILL_CONTACT_RULE,
  RaBatchSourcesAll.BILL_CUSTOMER_RULE,
  RaBatchSourcesAll.CM_BATCH_SOURCE_SEQ_ID,
  RaBatchSourcesAll.CREATE_CLEARING_FLAG,
  RaBatchSourcesAll.CUST_TRX_TYPE_RULE,
  RaBatchSourcesAll.CUSTOMER_BANK_ACCOUNT_RULE,
  RaBatchSourcesAll.DEFAULT_INV_TRX_TYPE_SEQ_ID,
  RaBatchSourcesAll.DERIVE_DATE_FLAG,
  RaBatchSourcesAll.FOB_POINT_RULE,
  RaBatchSourcesAll.GL_DATE_PERIOD_RULE,
  RaBatchSourcesAll.NAME,
  RaBatchSourcesAll.DESCRIPTION,
  RaBatchSourcesAll.SET_ID,
  (SELECT SET_NAME
  FROM FUSION.FND_SETID_SETS_VL SetIdSetPEO
  WHERE SetIdSetPEO.SET_ID = RaBatchSourcesAll.SET_ID
  )                      AS TRANSACTION_SOURCE_SET,
  XleEntityProfiles.NAME AS NAME2,
  XleEntityProfiles.LEGAL_ENTITY_IDENTIFIER ,
  RaBatchSourcesAll.STATUS,
  RaBatchSourcesAll.START_DATE,
  RaBatchSourcesAll.END_DATE,
  RaBatchSourcesAll.BATCH_SOURCE_TYPE,
  RaBatchSourcesAll.AUTO_TRX_NUMBERING_FLAG,
  RaBatchSourcesAll.COPY_DOC_NUMBER_FLAG,
  RaBatchSourcesAll.ALLOW_DUPLICATE_TRX_NUM_FLAG,
  RaBatchSourcesAll.COPY_INV_TIDFF_TO_CM_FLAG,
  RaBatchSourcesAll.RECEIPT_HANDLING_OPTION,
  RaBatchSourcesAll.DEFAULT_REFERENCE,
  RaBatchSourcesAll.DEFAULT_INV_TRX_TYPE,
  RaBatchSourcesAll.CREDIT_MEMO_BATCH_SOURCE_ID,
  RaBatchSourcesAll.GLOBAL_ATTRIBUTE9,
  RaBatchSourcesAll.GLOBAL_ATTRIBUTE_CATEGORY,
  RaBatchSourcesAll.GROUPING_RULE_ID,
  RaBatchSourcesAll.INVALID_LINES_RULE,
  RaBatchSourcesAll.INVALID_TAX_RATE_RULE,
  RaBatchSourcesAll.INVENTORY_ITEM_RULE,
  RaBatchSourcesAll.INVOICING_RULE_RULE,
  RaBatchSourcesAll.LAST_BATCH_NUM,
  RaBatchSourcesAll.LAST_UPDATE_DATE,
  RaBatchSourcesAll.LAST_UPDATE_LOGIN,
  RaBatchSourcesAll.LAST_UPDATED_BY,
  RaBatchSourcesAll.CREATED_BY,
  RaBatchSourcesAll.CREATION_DATE,
  RaBatchSourcesAll.MEMO_LINE_RULE,
  RaBatchSourcesAll.MEMO_REASON_RULE,
  RaBatchSourcesAll.OBJECT_VERSION_NUMBER,
  RaBatchSourcesAll.RECEIPT_METHOD_RULE,
  RaBatchSourcesAll.RELATED_DOCUMENT_RULE,
  RaBatchSourcesAll.REV_ACC_ALLOCATION_RULE,
  RaBatchSourcesAll.SALES_CREDIT_RULE,
  RaBatchSourcesAll.SALES_CREDIT_TYPE_RULE,
  RaBatchSourcesAll.SALES_TERRITORY_RULE,
  RaBatchSourcesAll.SALESPERSON_RULE,
  RaBatchSourcesAll.SHIP_ADDRESS_RULE,
  RaBatchSourcesAll.SHIP_CONTACT_RULE,
  RaBatchSourcesAll.SHIP_CUSTOMER_RULE,
  RaBatchSourcesAll.SHIP_VIA_RULE,
  RaBatchSourcesAll.SOLD_CUSTOMER_RULE,
  RaBatchSourcesAll.TERM_RULE,
  RaBatchSourcesAll.UNIT_OF_MEASURE_RULE,
  RaBatchSourcesAll.LEGAL_ENTITY_ID,
  ArLookupPEO1.MEANING,
  ArLookupPEO.MEANING AS MEANING1,
  ArLookupPEO.LOOKUP_TYPE,
  ArLookupPEO.LOOKUP_CODE,
  ArLookupPEO1.LOOKUP_TYPE                        AS LOOKUP_TYPE1,
  ArLookupPEO1.LOOKUP_CODE                        AS LOOKUP_CODE1,
  DECODE(ArLookupPEO1.lookup_code,'A','Yes','No') AS STATUS_MEANING,
  ArLookupPEO2.MEANING                            AS MEANING2,
  ArLookupPEO2.LOOKUP_TYPE                        AS LOOKUP_TYPE2,
  ArLookupPEO2.LOOKUP_CODE                        AS LOOKUP_CODE2,
  XleEntityProfiles.LEGAL_ENTITY_ID               AS LEGAL_ENTITY_ID1,
  (SELECT NAME
  FROM FUSION.RA_CUST_TRX_TYPES_ALL RaCustTrxTypesAll
  WHERE RaCustTrxTypesAll.cust_trx_type_seq_id = RaBatchSourcesAll.DEFAULT_INV_TRX_TYPE_SEQ_ID
  ) AS STANDARD_TRANSACTION_TYPE ,
  RAGROUPINGRULES.name GROUPING_RULE ,
  RaBatchSourcesAll.BM_ENDPOINT_KEY_NAME
FROM FUSION.RA_BATCH_SOURCES_ALL RaBatchSourcesAll,
  FUSION.AR_LOOKUPS ARLOOKUPPEO,
  FUSION.AR_LOOKUPS ARLOOKUPPEO1,
  FUSION.AR_LOOKUPS ARLOOKUPPEO2,
  FUSION.XLE_ENTITY_PROFILES XLEENTITYPROFILES ,
  FUSION.RA_GROUPING_RULES RaGroupingRules
WHERE ArLookupPEO.LOOKUP_TYPE            = 'BATCH_SOURCE'
AND ArLookupPEO.LOOKUP_CODE(+)           = RaBatchSourcesAll.BATCH_SOURCE_TYPE
AND ArLookupPEO1.LOOKUP_TYPE             = 'MOSR_STATUS'
AND ArLookupPEO1.LOOKUP_CODE(+)          = RaBatchSourcesAll.STATUS
AND ArLookupPEO2.LOOKUP_TYPE(+)          = 'AR_RECEIPT_HANDLING_OPTIONS'
AND ArLookupPEO2.LOOKUP_CODE(+)          = RaBatchSourcesAll.RECEIPT_HANDLING_OPTION
AND XLEENTITYPROFILES.LEGAL_ENTITY_ID(+) = RABATCHSOURCESALL.LEGAL_ENTITY_ID
and RaGroupingRules.GROUPING_RULE_ID(+)  = RABATCHSOURCESALL.GROUPING_RULE_ID
) QRSLT
order by RES_TRANSACTION_SOURCE_SET,RES_LEGAL_ENTITY,RES_NAME