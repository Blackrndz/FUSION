/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Manage%20Asset%20Keys%20-%20Asset%20Keys.sql $:
 * $Id: Manage Asset Keys - Asset Keys.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */
 
-- syntax: APPLICATION_ID##RES##KFF_CODE
-- KFF_LOGIC_TO_APPLY=140##RES##KEY#
-- KFF_PREFIX_ALIAS=RES_ASSET_KEY
-- KFF_COLUMN_NAME=SEGMENT

-- IMPORTANT: 
-- - the order of segments must start from 1 to ...

select QRSLT.SEGMENT1  RES_ASSET_KEY1
,QRSLT.SEGMENT2  RES_ASSET_KEY2
,QRSLT.SEGMENT3  RES_ASSET_KEY3
,QRSLT.SEGMENT4  RES_ASSET_KEY4
,QRSLT.SEGMENT5  RES_ASSET_KEY5
,QRSLT.SEGMENT6  RES_ASSET_KEY6
,QRSLT.SEGMENT7  RES_ASSET_KEY7
,QRSLT.SEGMENT8  RES_ASSET_KEY8
,QRSLT.SEGMENT9  RES_ASSET_KEY9
,QRSLT.SEGMENT10  RES_ASSET_KEY10
,TO_CHAR(QRSLT.START_DATE_ACTIVE,'DD-Mon-YYYY') RES_EFFECTIVE_START_DATE
,TO_CHAR(QRSLT.END_DATE_ACTIVE,'DD-Mon-YYYY') RES_EFFECTIVE_END_DATE
,decode(QRSLT.ENABLED_FLAG,'Y','Yes','No') RES_ENABLED
,QRSLT.STRUCTURE_INSTANCE_NUMBER RSC_EXTRA_COLUMN1
,QRSLT.LAST_UPDATED_BY  RSC_LAST_UPDATED_BY
,QRSLT.LAST_UPDATE_DATE  RSC_LAST_UPDATE_DATE
,QRSLT.CREATED_BY  RSC_CREATED_BY
,QRSLT.CREATION_DATE  RSC_CREATION_DATE
,null RSC_LEDGER_ID
,null RSC_CHART_OF_ACCOUNTS_ID
,null RSC_BUSINESS_UNIT_ID
,null RSC_LEGAL_ENTITY_ID
,null RSC_ORGANIZATION_ID
,null RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

from 
(SELECT AssetKeyEO.CODE_COMBINATION_ID
,AssetKeyEO.START_DATE_ACTIVE
,AssetKeyEO.END_DATE_ACTIVE
,AssetKeyEO.ENABLED_FLAG
,AssetKeyEO.SEGMENT1
,AssetKeyEO.SEGMENT2
,AssetKeyEO.SEGMENT3
,AssetKeyEO.SEGMENT4
,AssetKeyEO.SEGMENT5
,AssetKeyEO.SEGMENT6
,AssetKeyEO.SEGMENT7
,AssetKeyEO.SEGMENT8
,AssetKeyEO.SEGMENT9
,AssetKeyEO.SEGMENT10
,AssetKeyEO.SUMMARY_FLAG
,AssetKeyEO.LAST_UPDATE_DATE
,AssetKeyEO.LAST_UPDATED_BY
,AssetKeyEO.LAST_UPDATE_LOGIN
,AssetKeyEO.OBJECT_VERSION_NUMBER
,AssetKeyEO.CREATED_BY
,AssetKeyEO.CREATION_DATE
,AssetKeyEO.STRUCTURE_INSTANCE_NUMBER
FROM FA_ASSET_KEYWORDS AssetKeyEO
WHERE(((AssetKeyEO.CODE_COMBINATION_ID IS NOT NULL)
AND(EXISTS
	(SELECT 1
	FROM FA_ASSET_KEYWORDS FlexfieldDataEONQ1
	,FND_KF_STR_INSTANCES_VL KFFStructInstanceNQ1
	WHERE((KFFStructInstanceNQ1.APPLICATION_ID         = 140)
	AND(KFFStructInstanceNQ1.KEY_FLEXFIELD_CODE        = 'KEY#')
	and(FLEXFIELDDATAEONQ1.STRUCTURE_INSTANCE_NUMBER   = KFFSTRUCTINSTANCENQ1.STRUCTURE_INSTANCE_NUMBER))	
	AND(AssetKeyEO.STRUCTURE_INSTANCE_NUMBER           = FlexfieldDataEONQ1.STRUCTURE_INSTANCE_NUMBER
	and ASSETKEYEO.CODE_COMBINATION_ID                 = FLEXFIELDDATAEONQ1.CODE_COMBINATION_ID)
	))))
order by ASSETKEYEO.CODE_COMBINATION_ID
) QRSLT