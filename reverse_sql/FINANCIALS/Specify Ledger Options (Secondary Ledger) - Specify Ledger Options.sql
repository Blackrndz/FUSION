/* ****************************************************************************
 * $Revision: 78229 $:
 * $Author: pisan.jariyasettachok $:
 * $Date: 2022-04-07 14:37:05 +0700 (Thu, 07 Apr 2022) $:
 * $HeadURL: https://svn03.rapid4cloud.com/svn/a/dev/rapidesuite/controldata/FUSION_11.1.13/trunk/core/reverse_sql/FINANCIALS/Specify%20Ledger%20Options%20(Secondary%20Ledger)%20-%20Specify%20Ledger%20Options.sql $:
 * $Id: Specify Ledger Options (Secondary Ledger) - Specify Ledger Options.sql 78229 2022-04-07 07:37:05Z pisan.jariyasettachok $:
 * ****************************************************************************
 * Description:
 * ************************************************************************** */

 -- FIELD_TO_APPLY_FUNCTION=RES_RETAINED_EARNINGS_ACCOUNT/GET_CODE_COMBINATION
 -- FIELD_TO_APPLY_FUNCTION=RES_CUMULATIVE_TRANSLATION_ADJ/GET_CODE_COMBINATION
 -- FIELD_TO_APPLY_FUNCTION=RES_DEFAULT_SUSPENSE_ACCOUNT/GET_CODE_COMBINATION
 -- FIELD_TO_APPLY_FUNCTION=RES_ROUNDING_ACCOUNT/GET_CODE_COMBINATION
 -- FIELD_TO_APPLY_FUNCTION=RES_ENTERED_CURRENCY_BALANCING/GET_CODE_COMBINATION
 -- FIELD_TO_APPLY_FUNCTION=RES_NET_INCOME_ACCOUNT/GET_CODE_COMBINATION
 
 --RSC_PREREQUISITE_OBJECTS=GL_LEDGERS

SELECT GL2.name RES_PRIMARY_Ledger
, gl.NAME RES_SECONDARY_LEDGER
, gl.DESCRIPTION RES_DESCRIPTION
, DECODE(gl.currency_code,NULL,NULL,(SELECT CURRENCY_CODE||' - '||NAME
	FROM FND_CURRENCIES_VL
	WHERE CURRENCY_CODE = gl.currency_code
	)) RES_CURRENCY
, KeyFlexfieldStructureInstanc1.NAME RES_CHART_OF_ACCOUNTS
, GlCalendars.USER_PERIOD_SET_NAME RES_ACCOUNTING_CALENDAR
, gl.first_ledger_period_name RES_FIRST_OPENED_PERIOD
, gl.future_enterable_periods_limit RES_NUMBER_OF_FUTURE_ENTERABLE
, xlaamv.NAME RES_ACCOUNTING_METHOD
, LanguagePEO.DESCRIPTION RES_JOURNAL_LANGUAGE
, gl.RET_EARN_CODE_COMBINATION_ID RES_RETAINED_EARNINGS_ACCOUNT
, gl.CUM_TRANS_CODE_COMBINATION_ID RES_CUMULATIVE_TRANSLATION_ADJ
, DECODE(gl.NET_CLOSING_BAL_FLAG,'Y','Yes','No') RES_NET_CLOSING_BALANCE_JOURNA
, GlDailyConversionTypes.USER_CONVERSION_TYPE RES_DEFAULT_PERIOD_END_RATE_TY
, GlDailyConversionTypesPrdAvg.USER_CONVERSION_TYPE RES_DEFAULT_PERIOD_AVERAGE_RAT
, DECODE(GL.SUSPENSE_ALLOWED_FLAG,'Y','Yes','No') RES_ENABLE_SUSPENSE_GENERAL_LE
, DECODE(GL.SLA_BAL_BY_LEDGER_CURR_FLAG,'Y','Yes','No') RES_ENABLE_SUSPENSE_SUBLEDGER_
, sa.code_combination_id RES_DEFAULT_SUSPENSE_ACCOUNT
, gl.ROUNDING_CODE_COMBINATION_ID RES_ROUNDING_ACCOUNT
, gl.SLA_ENTERED_CUR_BAL_SUS_CCID RES_ENTERED_CURRENCY_BALANCING
, GL.THRESHOLD_AMOUNT RES_BALANCING_THRESHOLD_PERCEN
, GL.MINIMUM_THRESHOLD_AMOUNT RES_BALANCING_THRESHOLD_AMOUNT
, DECODE(gl.BALANCE_MJE_BY_CURRENCY_FLAG,'Y','Yes','No') RES_REQUIRE_MANUALLY_ENTERED_J
, DECODE(gl.ENABLE_JE_APPROVAL_FLAG,'Y','Yes','No') RES_ENABLE_JOURNAL_APPROVAL
, DECODE(gl.PRIOR_PRD_NOTIFICATION_FLAG,'Y','Yes','No') RES_NOTIFY_WHEN_PRIOR_PERIOD_J
, DECODE(gl.POP_UP_STAT_ACCOUNT_FLAG,'Y','Yes','No') RES_ALLOW_MIXED_STATISTICAL_AN
, DECODE(gl.VALIDATE_JOURNAL_REF_DATE,'Y','Yes','No') RES_VALIDATE_REFERENCE_DATE
, DECODE(gl.ENABLE_RECONCILIATION_FLAG,'Y','Yes','No') RES_ENABLE_CLEARING_ACCOUNTS_R
, DECODE(gl.ENABLE_RECONCILIATION_FLAG,'Y','Yes','No') RES_ENABLE_RECONCILIATION
, DECODE(gl.JRNLS_GROUP_BY_DATE_FLAG,'Y','Yes','No') RES_SEPARATE_JOURNALS_BY_ACCOU
, DECODE(gl.ALLOW_INTERCOMPANY_POST_FLAG,'Y','Yes','No') RES_ENABLE_INTERCOMPANY_ACCOUN
, AutorevCriteriaSetPEO.CRITERIA_SET_NAME RES_JOURNAL_REVERSAL_CRITERIA_
, DECODE(gl.AUTOREV_AFTER_OPEN_PRD_FLAG,'Y','Yes','No') RES_RUN_AUTOREVERSE_AFTER_OPEN
, DECODE(gl.AUTOMATE_SEC_JRNL_REV_FLAG,'Y','Yes','No') RES_SYNCHRONIZE_REVERSALS_BETW
, DECODE(gl.ENABLE_AVERAGE_BALANCES_FLAG,'Y','Yes','No') RES_ENABLE_AVERAGE_BALANCES
, gl.NET_INCOME_CODE_COMBINATION_ID RES_NET_INCOME_ACCOUNT
, TransactionCalendarPEO.NAME RES_TRANSACTION_CALENDAR
, DECODE(GL.SEQUENCING_MODE_CODE,'L','Ledger','LE','Legal entity','N','No sequencing',DECODE(GL2.SEQUENCING_MODE_CODE,
	'L','Ledger','LE','Legal entity','N','No sequencing')) RES_SEQUENCING_BY
, DECODE(gl2.AP_DOC_SEQUENCING_OPTION_FLAG,'Y','Yes','No') RES_ENFORCE_DOCUMENT_SEQUENCIN
, DECODE(gl2.AR_DOC_SEQUENCING_OPTION_FLAG,'Y','Yes','No') RES_ENFORCE_DOCUMENT_SEQUENC_0
, DECODE(gl2.ENF_SEQ_DATE_CORRELATION_CODE,'Y','Yes','No') RES_ENFORCE_CHRONOLOGICAL_ORDE
, DECODE(gl2.ENF_SEQ_DATE_CORRELATION_CODE,'Y','Yes','R','Yes','No') RES_ENFORCE_CHRONOLOGICAL_OR_1
, DECODE(gl.ENABLE_REVAL_SS_TRACK_FLAG,'Y','Yes','No') RES_TRACK_REVALUATION_GAIN_OR_
, DECODE(gl.SINGLE_CURRENCY_JOURNAL_FLAG,'Y','Yes','R','Yes','No') RES_LIMIT_A_JOURNAL_TO_A_SINGL

, gl.LAST_UPDATED_BY  AS RSC_LAST_UPDATED_BY
, gl.last_update_date AS RSC_LAST_UPDATE_DATE
,gl.CREATED_BY RSC_CREATED_BY
,gl.CREATION_DATE RSC_CREATION_DATE
,GL2.LEDGER_ID RSC_LEDGER_ID
,NULL RSC_CHART_OF_ACCOUNTS_ID
,NULL RSC_BUSINESS_UNIT_ID
,NULL RSC_LEGAL_ENTITY_ID
,NULL RSC_ORGANIZATION_ID
,NULL RSC_BUSINESS_GROUP_ID
,NULL RSC_ENTERPRISE_ID
,NULL RSC_COUNTRY_ID

FROM FUSION.GL_LEDGER_CONFIG_DETAILS glcd1
, FUSION.GL_LEDGER_CONFIGURATIONS glc
, FUSION.GL_LEDGERS GL
, FUSION.GL_LEDGERS gl2
, FUSION.FND_KF_STR_INSTANCES_VL KeyFlexfieldStructureInstanc1
, FUSION.GL_CALENDARS GlCalendars
, FUSION.XLA_ACCTG_METHODS_VL XLAAMV
, FUSION.GL_LEDGER_RELATIONSHIPS RelationshipEO
, FUSION.FND_LANGUAGES_VL LanguagePEO
, FUSION.GL_DAILY_CONVERSION_TYPES GlDailyConversionTypes
, FUSION.GL_DAILY_CONVERSION_TYPES GlDailyConversionTypesPrdAvg
, FUSION.GL_AUTOREV_CRITERIA_SETS AutorevCriteriaSetPEO
, FUSION.GL_TRANSACTION_CALENDAR TransactionCalendarPEO
, FUSION.GL_SUSPENSE_ACCOUNTS SA
WHERE glcd1.OBJECT_TYPE_CODE                         = 'SECONDARY'
AND glcd1.SETUP_STEP_CODE                            = 'NONE'
AND glcd1.CONFIGURATION_ID                           = glc.CONFIGURATION_ID
AND gl.CONFIGURATION_ID                              = glc.CONFIGURATION_ID
AND gl.LEDGER_ID                                     = glcd1.OBJECT_ID
AND gl.CHART_OF_ACCOUNTS_ID                          = KeyFlexfieldStructureInstanc1.STRUCTURE_INSTANCE_NUMBER
AND KeyFlexfieldStructureInstanc1.APPLICATION_ID     = 101
AND KeyFlexfieldStructureInstanc1.KEY_FLEXFIELD_CODE = 'GL#'
AND gl.PERIOD_SET_NAME                               = GlCalendars.PERIOD_SET_NAME
AND GL.ACCOUNTED_PERIOD_TYPE                         = GLCALENDARS.PERIOD_TYPE
AND GL.LEDGER_ID                                     = RELATIONSHIPEO.TARGET_LEDGER_ID
AND GL2.LEDGER_ID                                    = RELATIONSHIPEO.PRIMARY_LEDGER_ID
AND GL2.LEDGER_CATEGORY_CODE                         = 'PRIMARY'
AND RELATIONSHIPEO.target_ledger_category_code       = 'SECONDARY'
AND GL.SLA_ACCOUNTING_METHOD_CODE                    = XLAAMV.ACCOUNTING_METHOD_CODE(+)
AND GL.SLA_ACCOUNTING_METHOD_TYPE                    = XLAAMV.ACCOUNTING_METHOD_TYPE_CODE(+)
AND gl.SLA_DESCRIPTION_LANGUAGE                      = LanguagePEO.LANGUAGE_CODE(+)
AND(Gl.PERIOD_END_RATE_TYPE                          = GlDailyConversionTypes.CONVERSION_TYPE (+))
AND(Gl.PERIOD_AVERAGE_RATE_TYPE                      = GlDailyConversionTypesPrdAvg.CONVERSION_TYPE (+))
AND(Gl.CRITERIA_SET_ID                               = AutorevCriteriaSetPEO.CRITERIA_SET_ID(+))
AND(gl.TRANSACTION_CALENDAR_ID                       = TransactionCalendarPEO.TRANSACTION_CALENDAR_ID(+))
AND(gl.LEDGER_ID                                     = sa.LEDGER_ID(+)
AND sa.je_source_name(+)                             = 'Other'
AND sa.je_category_name(+)                           = 'Other')
AND(NVL(gl.RET_EARN_CODE_COMBINATION_ID, - 1)        > 0)
ORDER BY RES_PRIMARY_LEDGER
,RES_SECONDARY_LEDGER