<?xml version="1.0"?>
<navigation xmlns="http://navigation0005.configurator.erapidsuite.com" xmlns:xsd="http://xsdutility.configurator.erapidsuite.com">
	<name>Manage Expense Report Templates (Expense Types Policy)</name>
	<svn>
		<xsd:revision>$Revision: $:</xsd:revision>
		<xsd:author>$Author: $:</xsd:author>
		<xsd:date>$Date: $:</xsd:date>
		<xsd:headURL>$HeadURL: $:</xsd:headURL>
		<xsd:id>$Id:  $:</xsd:id>
	</svn>
	<description/>
	<type>FUSION</type>
	<engine_type>SELENIUM</engine_type>
	<modules/>
	<mapper_use_type>UNDEFINED</mapper_use_type>
	<validate_parent_child_relationships_for_mapped_data>true</validate_parent_child_relationships_for_mapped_data>
	<fusionNavigation hasScope="false" isBatchingBasedOnRootInventoryUniqueRecords="true" taskName="Manage Expense Report Templates" isBatchingAllowed="false" applicationKey="APPLICATION_HOME_PAGE">
		<dependencies>
			<navigation name="Manage Chart of Accounts Structures (Deploy)"/>
			<navigation name="SegmentValues"/>
			<navigation name="Manage Create Business Unit"/>
			<navigation name="Manage Expenditure Types"/>
			<navigation name="Manage Policies by Expense Category (Miscellaneous)"/>
			<navigation name="Manage Policies by Expense Category (Rates Miscellaneous)"/>
			<navigation name="Manage Policies by Expense Category (Mileage)"/>
			<navigation name="Manage Policies by Expense Category (Rates Mileage)"/>
			<navigation name="Manage Policies by Expense Category (Accommodations)"/>
			<navigation name="Manage Policies by Expense Category (Rates Accommodations)"/>
			<navigation name="Manage Policies by Expense Category (Car Rental)"/>
			<navigation name="Manage Policies by Expense Category (Rates Car Rental)"/>
			<navigation name="Manage Policies by Expense Category (Entertainment)"/>
			<navigation name="Manage Policies by Expense Category (Rates Entertainment)"/>
			<navigation name="Manage Policies by Expense Category (Meals)"/>
			<navigation name="Manage Policies by Expense Category (Rates Meals)"/>
			<navigation name="Manage Policies by Expense Category (Airfare)"/>
			<navigation name="Manage Policies by Expense Category (Rates Airfare)"/>
			<navigation name="Manage Policies by Expense Category (Activate)"/>
			<navigation name="Manage Expense Report Templates"/>
			<navigation name="Manage Expense Report Templates (Expense Types)"/>
		</dependencies>
		<parameters>
			<parameter name="MAIN_1_REPEAT" value="Manage Expense Report Templates - Expense Report Templates"/>
			<parameter name="MAIN_2_REPEAT" value="Manage Expense Report Templates - Expense Types"/>
			<parameter name="MAIN_8_REPEAT" value="Manage Expense Report Templates - Expense Types (Expense Policy)"/>
			<parameter name="MAIN_9_REPEAT" value="Manage Expense Report Templates - Expense Types (Attendees Policy)"/>
			<parameter name="MAIN_10_REPEAT" value="Manage Expense Report Templates - Expense Types (Preferred Merchant)"/>
			<parameter name="MAIN_12_REPEAT" value="Manage Expense Report Templates - Expense Types (Preferred Agency)"/>
			<parameter name="MAIN_13_REPEAT" value="Manage Expense Report Templates - Expense Types (Passenger)"/>
		</parameters>
		<block name="FAKE_INV">
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_1_REPEAT" columnName="Business Unit"/>']</findElement>
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_2_REPEAT" columnName="Business Unit"/>']</findElement>
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Business Unit"/>']</findElement>
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_9_REPEAT" columnName="Business Unit"/>']</findElement>
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Business Unit"/>']</findElement>
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_12_REPEAT" columnName="Business Unit"/>']</findElement>
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_13_REPEAT" columnName="Business Unit"/>']</findElement>		
		</block>
		<!-- Utility -->
		<block name="TAB_POLICIES">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">//a[contains(@class,'Disabled')][text()='Policies']</findElement>
				</if>
				<then>
					<error message="Tab 'Policies' Cannot be update"/>
				</then>
				<else>
					<findElement by="xpath">//a[text()='Policies']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
			<executeBlock name="Wait_for_Policies" isRepeatUntilBreak="true"/>
		</block>
		<block name="Wait_for_Policies">
			<IfThenElse>
				<if>
					<findElement by="xpath" isSkipCheckDomError="true">(//div[contains(@title,'Policy')])[1]</findElement>
				</if>
				<then>
					<break/>
				</then>
				<else>
					<pause durationInSecs="1"/>
				</else>
			</IfThenElse>
		</block>
		<block name="EXPAND_EXPENSE_POLICY">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Expense Policy']</findElement>
				</if>
				<then>
					<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_EXPAND">
						<parameters>
							<parameter name="XPATH" value="//a[@title='Expand Expense Policy']/../../../../../.."/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="EXPAND_ATTENDEES_POLICY">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Attendees Policy']</findElement>
				</if>
				<then>
					<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_EXPAND">
						<parameters>
							<parameter name="XPATH" value="//a[@title='Expand Attendees Policy']/../../../../../.."/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="EXPAND_PREFERRED_AGNCY">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Preferred Agency']</findElement>
				</if>
				<then>
					<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_EXPAND">
						<parameters>
							<parameter name="XPATH" value="//a[@title='Expand Preferred Agency']/../../../../../.."/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="EXPAND_PREFERRED_MERCHANT">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Preferred Merchant']</findElement>
				</if>
				<then>
					<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_EXPAND">
						<parameters>
							<parameter name="XPATH" value="//a[@title='Expand Preferred Merchant']/../../../../../.."/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="EXPAND_PASSENGER">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Passenger']</findElement>
				</if>
				<then>
					<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_EXPAND">
						<parameters>
							<parameter name="XPATH" value="//a[@title='Expand Passenger']/../../../../../.."/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="Collapse">
			<!--Expense Policy -->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Expense Policy']</findElement>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//a[@title='Collapse Expense Policy']</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">//a[@title='Collapse Expense Policy']</findElement>
							<click waitForPageToFinishRendering="true"/>
						</then>
						<else/>
					</IfThenElse>
				</then>
				<else/>
			</IfThenElse>
			<!--Attendees Policy -->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Attendees Policy']</findElement>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//a[@title='Collapse Attendees Policy']</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">//a[@title='Collapse Attendees Policy']</findElement>
							<click waitForPageToFinishRendering="true"/>
						</then>
						<else/>
					</IfThenElse>
				</then>
				<else/>
			</IfThenElse>
			<!--Preferred Agency -->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Preferred Agency']</findElement>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//a[@title='Collapse Preferred Agency']</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">//a[@title='Collapse Preferred Agency']</findElement>
							<click waitForPageToFinishRendering="true"/>
						</then>
						<else/>
					</IfThenElse>
				</then>
				<else/>
			</IfThenElse>
			<!--Preferred Merchant -->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Preferred Merchant']</findElement>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//a[@title='Collapse Preferred Merchant']</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//a[@title='Collapse Preferred Merchant']</findElement>
							<click waitForPageToFinishRendering="true"/>
						</then>
						<else/>
					</IfThenElse>
				</then>
				<else/>
			</IfThenElse>
			<!--Passenger -->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Passenger']</findElement>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//a[@title='Collapse Passenger']</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">//a[@title='Collapse Passenger']</findElement>
							<click waitForPageToFinishRendering="true"/>
						</then>
						<else/>
					</IfThenElse>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<!-- MAIN_8_REPEAT -->
		<!-- Expense Policy -->
		<block name="SELECT_EXPENSE_POLICIES">
			<IfThenElse>
				<if>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement by="xpath">TEMPLATE_2_FIND_ROW</findElement>
						</if>
						<then>
							<findElement by="xpath">TEMPLATE_2_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<IfThenElse>
								<if>
									<findElement isDisplayed="true" by="xpath">TEMPLATE_FIRST_ROW</findElement>
								</if>
								<then>
									<findElement isDisplayed="true" by="xpath">TEMPLATE_FIRST_ROW</findElement>
									<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</then>
								<else/>
							</IfThenElse>
							<IfThenElse>
								<if>
									<findElement by="xpath">//a[@title='Collapse Expense Policy']/../../../../../..//table[@summary='Policies']/../../../..//div[@title='Add Row']</findElement>
								</if>
								<then>
									<findElement by="xpath">//a[@title='Collapse Expense Policy']/../../../../../..//table[@summary='Policies']/../../../..//div[@title='Add Row']</findElement>
									<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</then>
								<else>
									<findElement by="xpath">//a[@title='Collapse Expense Policy']/../../../../../..//table[@summary='Expense Policy']/../../../..//div[@title='Add Row']</findElement>
									<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</else>
							</IfThenElse>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
			<executeBlock name="EXPENSE_POLICIES_DETAILS"/>
		</block>
		<block name="EXPENSE_POLICIES_DETAILS">
			<IfThenElse>
				<if>
					<findElement by="xpath">//table[@summary='Policies']</findElement>
				</if>
				<then>
					<!-- Policy Name -->
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//table[@summary='Policies']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../..//a[contains(@title,'Policy Name') or contains(@title,'Name')]</findElement>
						</if>
						<then>
							<executeBlock navigationName="TemplateLOV" name="TEMPLATE_LOV">
								<parameters>
									<parameter name="XPATH" value="//table[@summary='Policies']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../.."/>
									<parameter name="INV_NAME" value="MAIN_8_REPEAT"/>
									<parameter name="COL_NAME" value="Policy Name"/>
									<parameter name="SEARCH_1" value="Policy Name"/>
								</parameters>
							</executeBlock>
							<!--<findElement isSkipCheckDomError="true" by="xpath">//div[@title='Expense Policy']/../../../../../../..//tr[contains(@class,'Select')]//td[number(//span[text()='Start Date']/../../@_d_index)]</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>-->
						</then>
						<else>
							<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
								<parameters>
									<parameter name="XPATH" value="//table[@summary='Policies']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../.."/>
									<parameter name="INV_NAME" value="MAIN_8_REPEAT"/>
									<parameter name="COL_NAME" value="Policy Name"/>
								</parameters>
							</executeBlock> 
							<!--<findElement isSkipCheckDomError="true" by="xpath">//div[@title='Expense Policy']/../../../../../../..//tr[contains(@class,'Select')]//td[number(//span[text()='Start Date']/../../@_d_index)]</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>-->
						</else>
					</IfThenElse>
					<!-- Start Date -->
					<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
						<parameters>
							<parameter name="XPATH" value="//table[@summary='Policies']//tr[contains(@class,'Select')]//tr//*[text()='Start Date']/../.."/>
							<parameter name="INV_NAME" value="MAIN_8_REPEAT"/>
							<parameter name="COL_NAME" value="Start Date"/>
						</parameters>
					</executeBlock>
					<findElement by="xpath">(//table[@summary='Policies']//tr[contains(@class,'Selected')]//td)[1]</findElement>
					<click waitForPageToFinishRendering="true"/>
					<pause durationInSecs="2"/>
					<!-- End Date -->
					<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
						<parameters>
							<parameter name="XPATH" value="//table[@summary='Policies']//tr[contains(@class,'Select')]//tr//*[text()='End Date']/../.."/>
							<parameter name="INV_NAME" value="MAIN_8_REPEAT"/>
							<parameter name="COL_NAME" value="End Date"/>
						</parameters>
					</executeBlock>
				</then>
				<else>
					<!-- Policy Name -->
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../..//a[contains(@title,'Policy Name') or contains(@title,'Name')]</findElement>
						</if>
						<then>
							<executeBlock navigationName="TemplateLOV" name="TEMPLATE_LOV">
								<parameters>
									<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../.."/>
									<parameter name="INV_NAME" value="MAIN_8_REPEAT"/>
									<parameter name="COL_NAME" value="Policy Name"/>
									<parameter name="SEARCH_1" value="Policy Name"/>
								</parameters>
							</executeBlock>
							<!--<findElement isSkipCheckDomError="true" by="xpath">//div[@title='Expense Policy']/../../../../../../..//tr[contains(@class,'Select')]//td[number(//span[text()='Start Date']/../../@_d_index)]</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>-->
						</then>
						<else>
							<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
								<parameters>
									<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../.."/>
									<parameter name="INV_NAME" value="MAIN_8_REPEAT"/>
									<parameter name="COL_NAME" value="Policy Name"/>
								</parameters>
							</executeBlock> 
							<!--<findElement isSkipCheckDomError="true" by="xpath">//div[@title='Expense Policy']/../../../../../../..//tr[contains(@class,'Select')]//td[number(//span[text()='Start Date']/../../@_d_index)]</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>-->
						</else>
					</IfThenElse>
					<!-- Start Date -->
					<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
						<parameters>
							<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='Start Date']/../.."/>
							<parameter name="INV_NAME" value="MAIN_8_REPEAT"/>
							<parameter name="COL_NAME" value="Start Date"/>
						</parameters>
					</executeBlock>
					<findElement by="xpath">(//table[@summary='Expense Policy']//tr[contains(@class,'Selected')]//td)[1]</findElement>
					<click waitForPageToFinishRendering="true"/>
					<pause durationInSecs="2"/>
					<!-- End Date -->
					<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
						<parameters>
							<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='End Date']/../.."/>
							<parameter name="INV_NAME" value="MAIN_8_REPEAT"/>
							<parameter name="COL_NAME" value="End Date"/>
						</parameters>
					</executeBlock>
				</else>
			</IfThenElse>
		</block>
		<block name="NEW_EXPENSE_POLICIES">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//a[@title='Collapse Expense Policy']/../../../../../..//table[@summary='Policies']/../../../..//div[@title='Add Row']</findElement>
				</if>
				<then>
					<executeBlock navigationName="TemplateCREATE_UPDATE" name="TEMPLATE_SPECIFY_ADD_ROW">
						<parameters>
							<parameter name="XPATH" value="//a[@title='Collapse Expense Policy']/../../../../../..//table[@summary='Policies']/../../../..//div[@title='Add Row']"/>
						</parameters>
					</executeBlock>
				</then>
				<else>
					<executeBlock navigationName="TemplateCREATE_UPDATE" name="TEMPLATE_SPECIFY_ADD_ROW">
						<parameters>
							<parameter name="XPATH" value="//a[@title='Collapse Expense Policy']/../../../../../..//table[@summary='Expense Policy']/../../../..//div[@title='Add Row']"/>
						</parameters>
					</executeBlock>
				</else>
			</IfThenElse>
		</block>
		<block name="UPDATE_EXPENSE_POLICIES">
			<!--<IfThenElse>
				<if>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW/../../../../../td[1]</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement by="xpath">TEMPLATE_2_FIND_ROW</findElement>
						</if>
						<then>
							<findElement by="xpath">TEMPLATE_2_FIND_ROW/../../../../../td[1]</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<IfThenElse>
								<if>
									<findElement by="xpath">TEMPLATE_3_FIND_ROW</findElement>
								</if>
								<then>
									<findElement by="xpath">TEMPLATE_3_FIND_ROW/../../../../../td[1]</findElement>
									<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</then>
								<else>
									<findElement by="xpath">TEMPLATE_4_FIND_ROW/../../../../../../../../td[1]</findElement>
									<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</else>
							</IfThenElse>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>-->
			<IfThenElse>
				<if>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW/../../../../../../../../td[1]</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<findElement by="xpath">TEMPLATE_2_FIND_ROW/../../../../../../../../td[1]</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</else>
			</IfThenElse>
		</block>
		<block name="UPDATE_POLICIES">
			<IfThenElse>
				<if>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<findElement by="xpath">TEMPLATE_2_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</else>
			</IfThenElse>
		</block>
		<!-- MAIN_9_REPEAT -->
		<!-- Attendees Policy -->
		<block name="SELECT_ATTENDEES_POLICIES">
			<IfThenElse>
				<if>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement by="xpath">TEMPLATE_1_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement by="xpath">TEMPLATE_2_FIND_ROW</findElement>
						</if>
						<then>
							<findElement by="xpath">TEMPLATE_2_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<IfThenElse>
								<if>
									<findElement isDisplayed="true" by="xpath">TEMPLATE_FIRST_ROW</findElement>
								</if>
								<then>
									<findElement isDisplayed="true" by="xpath">TEMPLATE_FIRST_ROW</findElement>
									<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</then>
								<else/>
							</IfThenElse>
							<findElement by="xpath">//a[@title='Collapse Attendees Policy']/../../../../../..//table[@summary='Expense Policy']/../../../..//div[@title='Add Row']</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
			<executeBlock name="ATTENDEES_POLICIES_DETAILS"/>
		</block>
		<block name="ATTENDEES_POLICIES_DETAILS">
			<!-- Policy Name -->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../..//a[contains(@title,'Policy Name') or contains(@title,'Name')]</findElement>
				</if>
				<then>
					<executeBlock navigationName="TemplateLOV" name="TEMPLATE_LOV">
						<parameters>
							<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../.."/>
							<parameter name="INV_NAME" value="MAIN_9_REPEAT"/>
							<parameter name="COL_NAME" value="Policy Name"/>
							<parameter name="SEARCH_1" value="Policy Name"/>
						</parameters>
					</executeBlock>
					<!--<findElement isSkipCheckDomError="true" by="xpath">//div[@title='Expense Policy']/../../../../../../..//tr[contains(@class,'Select')]//td[number(//span[text()='Start Date']/../../@_d_index)]</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>-->
				</then>
				<else>
					<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
						<parameters>
							<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='Policy Name' or text()='Name']/../.."/>
							<parameter name="INV_NAME" value="MAIN_9_REPEAT"/>
							<parameter name="COL_NAME" value="Policy Name"/>
						</parameters>
					</executeBlock> 
					<!--<findElement isSkipCheckDomError="true" by="xpath">//div[@title='Expense Policy']/../../../../../../..//tr[contains(@class,'Select')]//td[number(//span[text()='Start Date']/../../@_d_index)]</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>-->
				</else>
			</IfThenElse>
			<!-- Start Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='Start Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_9_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<findElement by="xpath">(//table[@summary='Expense Policy']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true"/>
			<pause durationInSecs="2"/>
			<!-- End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Select')]//tr//*[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_9_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="CREATE_ATTENDEES">
			<executeBlock navigationName="TemplateCREATE_UPDATE" name="TEMPLATE_ADD_ROW"/>
			<findElement by="xpath">//table[@summary='Expense Policy']//tr[contains(@class,'Selected')]//td[number(//span[text()='Policy Name']/../../@_d_index)]//select[not(@title)]</findElement>
			<select by="selectByVisibleText" isPageLoadingOnSelectValue="true">
				<valueKB inventoryName="MAIN_9_REPEAT" columnName="Policy Name"/>
			</select>
			<!--Policy Name -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Selected')]/../../../..//label[text()='Policy Name']/.."/>
					<parameter name="INV_NAME" value="MAIN_9_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Name"/>
				</parameters>
			</executeBlock>
			<!--Start Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Selected')]/../../../..//label[text()='Start Date']/.."/>
					<parameter name="INV_NAME" value="MAIN_9_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Selected')]/../../../..//label[text()='End Date']/.."/>
					<parameter name="INV_NAME" value="MAIN_9_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="UPDATE_ATTENDEES">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_3_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Expense Policy']//tr[contains(@class,'Selected')]//td[number(//span[text()='End Date']/../../@_d_index)]"/>
					<parameter name="INV_NAME" value="MAIN_9_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
		</block>
		<!-- MAIN_10_REPEAT -->
		<!-- Preferred Merchant -->
		<block name="SELECT_PREFERRED_MERCHANT">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<IfThenElse>
								<if>
									<findElement isDisplayed="true" by="xpath">TEMPLATE_3_FIND_ROW</findElement>
								</if>
								<then>
									<findElement isDisplayed="true" by="xpath">TEMPLATE_3_FIND_ROW</findElement>
									<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</then>
								<else>
									<executeBlock name="ADD_NEW_PREFERRED_MERCHANT" isRepeatUntilBreak="true"/>
								</else>
							</IfThenElse>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
			<executeBlock name="PREFERRED_MERCHANT_DETAILS"/>
		</block>
		<block name="ADD_NEW_PREFERRED_MERCHANT">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" by="xpath" isSkipCheckDomError="true">//label[text()='Preferred Merchant List']/..//select[not(@title)]</findElement>
				</if>
				<then>
					<break/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_FIRST_ROW</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_FIRST_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else/>
					</IfThenElse>
					<findElement highlightTurnedOff="true" by="xpath" isSkipCheckDomError="true">//a[@title='Collapse Preferred Merchant']/../../../../../..//table[@summary='Preferred Merchant']/../../../..//div[@title='Add Row']</findElement>
					<click waitForPageToFinishRendering="true"/>
					<IfThenElse>
						<if>
							<findElement by="xpath">//div[text()='Error']/../../../../../../..//span[contains(text(),'set the merchant name to Required.')]</findElement>
						</if>
						<then>
							<error message="Please check your data in Inventory name 'Manage Expense Report Templates - Expense Fields' column name 'Merchant Name' select to Required."/>
						</then>
						<else/>
					</IfThenElse>
				</else>
			</IfThenElse>
		</block>
		<block name="PREFERRED_MERCHANT_DETAILS">
			<!-- Preferred Merchant List -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Preferred Merchant List']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Preferred Merchant List"/>
				</parameters>
			</executeBlock>
			<!--Start Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Start Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<!--Policy Enforcement -->
			<executeBlock name="Merchant_Policy_Enforcement" isRepeatUntilBreak="true"/>
			<!-- <executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Enforcement"/>
				</parameters>
			</executeBlock> -->
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<pause durationInSecs="2"/>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<pause durationInSecs="2"/>
			<!--Display Warning to User-->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//td[6]"/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="Merchant_Policy_Enforcement">
			<IfThenElse>
				<if>
					<comparisons separator="AND">
						<comparison operator="NOT_EQUAL">
							<leftOperand>
								<valueKB inventoryName="MAIN_10_REPEAT" columnName="Policy Enforcement"/>
							</leftOperand>
							<rightOperand>
								<valueText></valueText>
							</rightOperand>
						</comparison>
					</comparisons>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" by="xpath" isSkipCheckDomError="true">//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../..//select[@title='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Policy Enforcement"/>']</findElement>
						</if>
						<then>
							<break/>
						</then>
						<else>
							<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
								<parameters>
									<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
									<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
									<parameter name="COL_NAME" value="Policy Enforcement"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="NEW_PREFERRED_MERCHANT">
			<executeBlock name="ADD_NEW_PREFERRED_MERCHANT" isRepeatUntilBreak="true"/>
			<!--Start Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Start Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
			<!--Policy Enforcement -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Enforcement"/>
				</parameters>
			</executeBlock>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//td[6]"/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
		</block>
		<block name="UPDATE_PREFERRED_MERCHANT">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_3_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<click waitForPageToFinishRendering="true"/>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
			<!--Policy Enforcement -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Enforcement"/>
				</parameters>
			</executeBlock>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<!--Display Warning to User -->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//td[6]"/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="CREATE_PREFERRED_MERCHANT">
			<!-- Start Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Start Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
			<!--Policy Enforcement -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Enforcement"/>
				</parameters>
			</executeBlock>
			<!-- <findElement by="xpath">SCROLLBAR_GENERIC_1_FIRST_ROW</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/> -->
			<!--Display Warning to User -->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//td[6]"/>
					<parameter name="INV_NAME" value="MAIN_10_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
			<!-- <findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Merchant']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/> -->
		</block>
		<!-- MAIN_12_REPEAT -->
		<!--Preferred Agency-->
		<block name="SELECT_PREFERRED_AGNCY">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<IfThenElse>
								<if>
									<findElement isDisplayed="true" by="xpath">TEMPLATE_FIRST_ROW</findElement>
								</if>
								<then>
									<findElement isDisplayed="true" by="xpath">TEMPLATE_FIRST_ROW</findElement>
									<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</then>
								<else/>
							</IfThenElse>
							<findElement highlightTurnedOff="true" by="xpath" isSkipCheckDomError="true">//a[@title='Collapse Preferred Agency']/../../../../../..//table[@summary='Preferred Agency']/../../../..//div[@title='Add Row']</findElement>
							<click waitForPageToFinishRendering="true"/>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
			<executeBlock name="PREFERRED_AGNCY_DETAILS"/>
		</block>
		<block name="PREFERRED_AGNCY_DETAILS">
			<!--Preferred Agency List -->
			<!-- <findElement by="xpath">//label[text()='Preferred Agency List']/..//select[not(@title)]</findElement>
			<select by="selectByVisibleText" isPageLoadingOnSelectValue="true">
				<valueKB inventoryName="MAIN_12_REPEAT" columnName="Preferred Agency List"/>
			</select> -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Preferred Agency List']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Preferred Agency List"/>
				</parameters>
			</executeBlock>
			<!--Start Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Start Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<!--Policy Enforcement -->
			<executeBlock name="Agency_Policy_Enforcement" isRepeatUntilBreak="true"/>
			<!-- <executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Enforcement"/>
				</parameters>
			</executeBlock> -->
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<pause durationInSecs="2"/>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<pause durationInSecs="2"/>
			<!--Display Warning to User -->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//td[6]"/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="Agency_Policy_Enforcement">
			<IfThenElse>
				<if>
					<comparisons separator="AND">
						<comparison operator="NOT_EQUAL">
							<leftOperand>
								<valueKB inventoryName="MAIN_12_REPEAT" columnName="Policy Enforcement"/>
							</leftOperand>
							<rightOperand>
								<valueText></valueText>
							</rightOperand>
						</comparison>
					</comparisons>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" by="xpath" isSkipCheckDomError="true">//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../..//select[@title='<valueKB inventoryName="MAIN_12_REPEAT" columnName="Policy Enforcement"/>']</findElement>
						</if>
						<then>
							<break/>
						</then>
						<else>
							<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
								<parameters>
									<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
									<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
									<parameter name="COL_NAME" value="Policy Enforcement"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="waiting..Agency_Policy_Enforcement">
			<IfThenElse>
				<if>
					<findElement isSkipCheckDomError="true" isDisplayed="true" by="xpath">//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/..//select[not(@title)]</findElement>
				</if>
				<then>
					<findElement isSkipCheckDomError="true" by="xpath">//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../..//select</findElement>
					<select by="selectByVisibleText" isPageLoadingOnSelectValue="true">
						<valueKB inventoryName="MAIN_12_REPEAT" columnName="Policy Enforcement"/>
					</select>
					<pause durationInSecs="1"/>
				</then>
				<else>
					<break/>
				</else>
			</IfThenElse>
		</block>
		<block name="CREATE_PREFERRED_AGNCY">
			<executeBlock navigationName="TemplateCREATE_UPDATE" name="TEMPLATE_ADD_ROW"/>
			<!--Preferred Agency List -->
			<findElement by="xpath">//label[text()='Preferred Agency List']/..//select[not(@title)]</findElement>
			<select by="selectByVisibleText" isPageLoadingOnSelectValue="true">
				<valueKB inventoryName="MAIN_12_REPEAT" columnName="Preferred Agency List"/>
			</select>
			<!--Start Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Start Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<!--Policy Enforcement -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Enforcement"/>
				</parameters>
			</executeBlock>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<!--Start Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Start Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<!--Display Warning to User -->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//td[6]"/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
			<!--Policy Enforcement -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Enforcement"/>
				</parameters>
			</executeBlock>
			<!--Display Warning to User -->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Display Warning to User']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="UPDATE_PREFERRED_AGNCY">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
				</if>
				<then>
					<findElement isDisplayed="true" by="xpath">TEMPLATE_1_FIND_ROW</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
						</if>
						<then>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_2_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<findElement isDisplayed="true" by="xpath">TEMPLATE_3_FIND_ROW</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<!--End Date -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
			<!--Policy Enforcement -->
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//label[text()='Policy Enforcement']/../.."/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Policy Enforcement"/>
				</parameters>
			</executeBlock>
			<executeBlock name="waiting..Agency_Policy_Enforcement" isRepeatUntilBreak="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">(//table[@summary='Preferred Agency']//tr[contains(@class,'Selected')]//td)[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<!--Display Warning to User -->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//tr[contains(@class,'Selected')]//td[6]"/>
					<parameter name="INV_NAME" value="MAIN_12_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
		</block>
		<!-- MAIN_13_REPEAT -->
		<!--Passenger -->
		<block name="PASSENGER">
			<!--Enforce passenger name to match name on expense report-->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//table[not(@style)]//label[text()='Enforce passenger name to match name on expense report']/.."/>
					<parameter name="INV_NAME" value="MAIN_13_REPEAT"/>
					<parameter name="COL_NAME" value="Enforce passenger name to match name on expense report"/>
				</parameters>
			</executeBlock>
			<!--Start Date-->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Start Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_13_REPEAT"/>
					<parameter name="COL_NAME" value="Start Date"/>
				</parameters>
			</executeBlock>
			<!--End Date-->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//label[text()='End Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_13_REPEAT"/>
					<parameter name="COL_NAME" value="End Date"/>
				</parameters>
			</executeBlock>
			<!-- Policy Enforcement -->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">//label[text()='Prevent report submission']</findElement>
				</if>
				<then>
					<executeBlock navigationName="TemplateRADIO" name="TEMPLATE_RADIO">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Prevent report submission']/../.."/>
							<parameter name="INV_NAME" value="MAIN_13_REPEAT"/>
							<parameter name="COL_NAME" value="Policy Enforcement"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Display Warning to User -->
			<executeBlock navigationName="TemplateCHECKBOX" name="TEMPLATE_CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Display Warning to User']/../.."/>
					<parameter name="INV_NAME" value="MAIN_13_REPEAT"/>
					<parameter name="COL_NAME" value="Display Warning to User"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="WARNING_2">
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">//div[text()='Warning']/../../../../../../../../../../../../..//span[text()='Y']/..</findElement>
				</if>
				<then>
					<findElement by="xpath">//div[text()='Warning']/../../../../../../../../../../../../..//span[text()='Y']/..</findElement>
					<click waitForPageToFinishRendering="true"/>
				</then>
				<else/>
			</IfThenElse>
		</block>
	
		<executeBlock name="GLOBAL_GO_TO_TASK"/>
		<repeat inventoryName="MAIN_1_REPEAT">
			<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SEARCH_EXPENSE_REPORT_TEMPLATES"/>
			<repeat inventoryName="MAIN_2_REPEAT">
				<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="TAB_EXPENSE_TYPES"/>
				<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SEARCH_UPDATE_EXPENSE_TYPES"/>
				<!--Expense Policy-->
				<repeat inventoryName="MAIN_8_REPEAT">
					<executeBlock name="TAB_POLICIES"/>
					<executeBlock name="Collapse"/>
					<executeBlock name="EXPAND_EXPENSE_POLICY"/>
					<IfThenElse>
						<if>
							<findElement by="xpath">//table[@summary='Policies']</findElement>
						</if>
						<then>
							<executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
								<parameters>
									<parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Policies']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Policies'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Policies']/../..//div[contains(@id,'scroller')]"/>
									<!--<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Policies' or @summary='Policies']//tr[td[number(//table[@summary='Policies' or @summary='Policies']/../..//th//span[text()='Policy Name' or text()='Name']/../../@_d_index)]//*[normalize-space(text())='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Policy Name"/>']]</parameter>
									<parameter name="TEMPLATE_2_FIND_ROW">//table[@summary='Policies' or @summary='Policies']//tr[td[number(//table[@summary='Policies' or @summary='Policies']/../..//th//span[text()='Policy Name' or text()='Name']/../../@_d_index)]//input[normalize-space(@value)='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Policy Name"/>']]</parameter>-->
									<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Policies']/../../../../../..//tr[td[1]//span//*[text()='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Policy Name"/>'] and td[3]//span//*[text()='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
									<parameter name="TEMPLATE_2_FIND_ROW">//table[@summary='Policies']/../../../../../..//tr[td[1]//span//select[@title='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Policy Name"/>'] and td[3]//span//*[@value='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
									<parameter name="TEMPLATE_CREATE" value="SELECT_EXPENSE_POLICIES"/>
									<parameter name="TEMPLATE_UPDATE" value="SELECT_EXPENSE_POLICIES"/>
								</parameters>
							</executeBlock>
						</then>
						<else>
							<executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
								<parameters>
									<parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Expense Policy']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Expense Policy'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Expense Policy']/../..//div[contains(@id,'scroller')]"/>
									<!--<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Policies' or @summary='Policies']//tr[td[number(//table[@summary='Policies' or @summary='Policies']/../..//th//span[text()='Policy Name' or text()='Name']/../../@_d_index)]//*[normalize-space(text())='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Policy Name"/>']]</parameter>
									<parameter name="TEMPLATE_2_FIND_ROW">//table[@summary='Policies' or @summary='Policies']//tr[td[number(//table[@summary='Policies' or @summary='Policies']/../..//th//span[text()='Policy Name' or text()='Name']/../../@_d_index)]//input[normalize-space(@value)='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Policy Name"/>']]</parameter>-->
									<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Expense Policy']/../../../../../..//tr[td[1]//span//*[text()='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Policy Name"/>'] and td[3]//span//*[text()='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
									<parameter name="TEMPLATE_2_FIND_ROW">//table[@summary='Expense Policy']/../../../../../..//tr[td[1]//span//select[@title='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Policy Name"/>'] and td[3]//span//*[@value='<valueKB inventoryName="MAIN_8_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
									<parameter name="TEMPLATE_CREATE" value="SELECT_EXPENSE_POLICIES"/>
									<parameter name="TEMPLATE_UPDATE" value="SELECT_EXPENSE_POLICIES"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
					<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE_EXPENSE_TYPE"/>
				</repeat>
				<!--Attendees Policy-->
				<repeat inventoryName="MAIN_9_REPEAT">
					<executeBlock name="TAB_POLICIES"/>
					<executeBlock name="Collapse"/>
					<executeBlock name="EXPAND_ATTENDEES_POLICY"/>
					<executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
						<parameters>
							<parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Expense Policy']/../..//div[contains(text(),'No data to display.')]"/>
							<parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Expense Policy']//tr[1]//td)[1]"/>
							<parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Expense Policy']/../..//div[contains(@id,'scroller')]"/>
							<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Expense Policy']//tr[td[1]//span//*[@title='<valueKB inventoryName="MAIN_9_REPEAT" columnName="Policy Name"/>'] and td[3]//span//input[@value='<valueKB inventoryName="MAIN_9_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
							<parameter name="TEMPLATE_2_FIND_ROW">//table[@summary='Expense Policy']//tr[td[1]//span[text()='<valueKB inventoryName="MAIN_9_REPEAT" columnName="Policy Name"/>'] and td[3]//span[text()='<valueKB inventoryName="MAIN_9_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
							<parameter name="TEMPLATE_CREATE" value="SELECT_ATTENDEES_POLICIES"/>
							<parameter name="TEMPLATE_UPDATE" value="SELECT_ATTENDEES_POLICIES"/>
						</parameters>
					</executeBlock>
					<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE_EXPENSE_TYPE"/>
					<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="WARING_EXPENSE_TYPE"/>
					<executeBlock name="WARNING_2"/>
				</repeat>
				<!--Preferred Merchant-->
				<repeat inventoryName="MAIN_10_REPEAT">
					<executeBlock name="TAB_POLICIES"/>
					<executeBlock name="Collapse"/>
					<executeBlock name="EXPAND_PREFERRED_MERCHANT"/>
					<executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
						<parameters>
							<parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Preferred Merchant']/../..//div[contains(text(),'No data to display.')]"/>
							<parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Preferred Merchant'][@_rowcount]//tr[1]//td)[1]"/>
							<parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Preferred Merchant']/../..//div[contains(@id,'scroller')]"/>
							<!-- <parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Preferred Merchant']//tr[td[number(//span[text()='Preferred Agency List']/../../@_d_index)]//span[text()='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Preferred Merchant List"/>'] and td[number(//span[text()='Start Date']/../../@_d_index)]//input[@value='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Start Date"/>']]/td[1]</parameter>
							<parameter name="TEMPLATE_2_FIND_ROW">//table[@summary='Preferred Merchant']//tr[td[number(//span[text()='Preferred Agency List']/../../@_d_index)]//span[text()='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Preferred Merchant List"/>'] and td[number(//span[text()='Start Date']/../../@_d_index)]//span[text()='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Start Date"/>']]/td[1]</parameter> -->
							<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Preferred Merchant']//tr[td[1]//span//*[@title='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Preferred Merchant List"/>'] and td[3]//span//*[@value='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
							<parameter name="TEMPLATE_2_FIND_ROW">//table[@summary='Preferred Merchant']//tr[td[1]//span[text()='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Preferred Merchant List"/>'] and td[3]//span[text()='<valueKB inventoryName="MAIN_10_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
							<parameter name="TEMPLATE_CREATE" value="SELECT_PREFERRED_MERCHANT"/>
							<parameter name="TEMPLATE_UPDATE" value="SELECT_PREFERRED_MERCHANT"/>
						</parameters>
					</executeBlock>
					<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE_EXPENSE_TYPE"/>
				</repeat>
				<!--Preferred Agency-->
				<repeat inventoryName="MAIN_12_REPEAT">
					<executeBlock name="TAB_POLICIES"/>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//*[text()='Preferred Agency']</findElement>
						</if>
						<then>
							<executeBlock name="Collapse"/>
							<executeBlock name="EXPAND_PREFERRED_AGNCY"/>
							<executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
								<parameters>
									<parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Preferred Agency']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Preferred Agency']//tr[1]//td)[1]"/>
									<parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Preferred Agency']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Preferred Agency']//tr[td[1]//span//*[@title='<valueKB inventoryName="MAIN_12_REPEAT" columnName="Preferred Agency List"/>'] and td[3]//span//*[@value='<valueKB inventoryName="MAIN_12_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
									<parameter name="TEMPLATE_2_FIND_ROW">//table[@summary='Preferred Agency']//tr[td[1]//span[text()='<valueKB inventoryName="MAIN_12_REPEAT" columnName="Preferred Agency List"/>'] and td[3]//span[text()='<valueKB inventoryName="MAIN_12_REPEAT" columnName="Start Date"/>']]/../../../../../td[1]</parameter>
									<parameter name="TEMPLATE_CREATE" value="SELECT_PREFERRED_AGNCY"/>
									<parameter name="TEMPLATE_UPDATE" value="SELECT_PREFERRED_AGNCY"/>
								</parameters>
							</executeBlock>
							<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE_EXPENSE_TYPE"/>
							<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="WARING_EXPENSE_TYPE"/>
							<executeBlock name="WARNING_2"/>
							<executeBlock name="Collapse"/>
						</then>
						<else>
							<error message="The 'Preferred Agency' doesn't exist."/>
						</else>
					</IfThenElse>
				</repeat>
				<!--Passenger-->
				<repeat inventoryName="MAIN_13_REPEAT">
					<executeBlock name="TAB_POLICIES"/>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//*[text()='Passenger']</findElement>
						</if>
						<then>
							<executeBlock name="Collapse"/>
							<executeBlock name="EXPAND_PASSENGER"/>
							<executeBlock name="PASSENGER"/>
							<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE_EXPENSE_TYPE"/>
							<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="WARING_EXPENSE_TYPE"/>
							<executeBlock name="WARNING_2"/>
							<executeBlock name="Collapse"/>
						</then>
						<else>
							<error message="The 'Passenger' doesn't exist."/>
						</else>
					</IfThenElse>
				</repeat>
				<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE_EXPENSE_TYPE"/>
				<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE_AND_CLOSE_EXPENSE_TYPE"/>
				<pause durationInSecs="2"/>
				<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="WARING_EXPENSE_TYPE"/>
				<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="WARING"/>
			</repeat>
			<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE"/>
			<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="SAVE_AND_CLOSE"/>
			<executeBlock navigationName="Manage Expense Report Templates (Expense Types)" name="WARING"/>
		</repeat>
	</fusionNavigation>
</navigation>