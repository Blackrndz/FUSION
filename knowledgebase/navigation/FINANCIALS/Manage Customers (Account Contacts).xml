<?xml version="1.0"?>
<navigation xmlns="http://navigation0005.configurator.erapidsuite.com" xmlns:xsd="http://xsdutility.configurator.erapidsuite.com">
    <name>Manage Customers (Account Contacts)</name>
    <svn>
        <xsd:revision>$Revision: $:</xsd:revision>
        <xsd:author>$Author: $:</xsd:author>
        <xsd:date>$Date: $:</xsd:date>
        <xsd:headURL>$HeadURL: $:</xsd:headURL>
        <xsd:id>$Id:  $:</xsd:id>
    </svn>
    <description/>
    <type>FUSION</type>
    <engine_type>SELENIUM</engine_type>
    <modules/>
    <mapper_use_type>UNDEFINED</mapper_use_type>
    <validate_parent_child_relationships_for_mapped_data>true</validate_parent_child_relationships_for_mapped_data>
    <fusionNavigation hasScope="false"
        isBatchingBasedOnRootInventoryUniqueRecords="true"
        taskName="Manage Customers" isBatchingAllowed="true" applicationKey="APPLICATION_HOME_PAGE">
        <parameters>
            <parameter name="REPEAT_1_MAIN" value="Manage Customers - Accounts"/>
            <parameter name="REPEAT_2_MAIN" value="Manage Customers - Account Contacts"/>
            <parameter name="REPEAT_3_MAIN" value="Manage Customers - Account Contact Points"/>
            <parameter name="REPEAT_4_MAIN" value="Manage Customers - Account Contact Responsibilities"/>
        </parameters>
        <block name="FAKE_KB">
            <findElement by="xpath">//a[text()='<valueKB inventoryName="REPEAT_1_MAIN" columnName="Customer Type"/>']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Customer Type"/>']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//a[text()='<valueKB inventoryName="REPEAT_3_MAIN" columnName="Customer Type"/>']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//a[text()='<valueKB inventoryName="REPEAT_4_MAIN" columnName="Customer Type"/>']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="Search...">
            <IfThenElse>
                <if>
                    <findElement isDisplayed="true" by="xpath">//div[contains(@class,'Expansion')]/..//a[text()='Search...']</findElement>
                </if>
                <then>
                    <pause durationInSecs="2"/>
                    <break/>
                </then>
                <else>
                    <pause durationInSecs="2"/>
                    <findElement isDisplayed="true" by="xpath" isSkipCheckDomError="true">//div[contains(@class,'Expansion')]/..//label[text()='Phone Country Code']/../..//a[contains(@title,'Search')]</findElement>
                    <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                </else>
            </IfThenElse>
        </block>
        <block name="Search">
            <executeBlock name="GLOBAL_EXPAND">
                <parameters>
                    <parameter name="XPATH" value="//div[3]//*[text()='Search']/../../.."/>
                </parameters>
            </executeBlock>		
            <findElement isDisplayed="true" by="xpath">//button[text()='Reset']</findElement>
            <click waitForPageToFinishRendering="true"/>		
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//label[text()='Customer Type']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_1_MAIN"/>
                    <parameter name="COL_NAME" value="Customer Type"/>
                </parameters>
            </executeBlock>
            <executeBlock name="GLOBAL_EXPAND">
                <parameters>
                    <parameter name="XPATH" value="//div[3]//*[text()='Search']/../../.."/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[3]//*[text()='Search']/../../../../../../..//label[text()='Registry ID']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_1_MAIN"/>
                    <parameter name="COL_NAME" value="Registry ID"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT_ENTER">
                <parameters>
                    <parameter name="XPATH" value="//div[3]//*[text()='Search']/../../../../../../..//label[text()='Account Number']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_1_MAIN"/>
                    <parameter name="COL_NAME" value="Account Number"/>
                </parameters>
            </executeBlock>
            <IfThenElse>
                <if>
                    <findElement by="xpath">//table[@summary='Accounts']//td[3]//a//span[text()='<valueKB inventoryName="REPEAT_1_MAIN" columnName="Account Number"/>']</findElement>
                </if>
                <then>
                    <findElement by="xpath">//table[@summary='Accounts']//td[3]//a//span[text()='<valueKB inventoryName="REPEAT_1_MAIN" columnName="Account Number"/>']</findElement>
                    <click waitForPageToFinishRendering="true"/>
                </then>
                <else>
                    <error message="This 'Account Number' doesn't exist."/>
                </else>
            </IfThenElse>
        </block>
        <block name="Search_Account_Contacts">
            <executeBlock name="TAB">
                <parameters>
                    <parameter name="TAB_NAME" value="Communication"/>
                </parameters>
            </executeBlock>
            <executeBlock name="BUTTON">
                <parameters>
                    <parameter name="BUTTON_NAME" value="Edit Contacts"/>
                </parameters>
            </executeBlock>
            <findElement by="xpath">//table[@summary='Account Contacts']/../../../..//a[text()='View']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//td[text()='Columns']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//td[text()='Show All']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>
									</leftOperand>
									<rightOperand>
										<valueText/>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_Contact"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Contact"/>
								</parameters>
							</executeBlock>
						</then>
						<else>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>'] and td[number(//th//span[text()='Job Title Code']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_Contact"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Contact"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
                </then>
                <else>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>
									</leftOperand>
									<rightOperand>
										<valueText/>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Last Name']/../../@_d_index)+1]//span[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>']  and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_Contact"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Contact"/>
								</parameters>
							</executeBlock>
						</then>
						<else>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Last Name']/../../@_d_index)+1]//span[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>']  and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>'] and td[number(//th//span[text()='Job Title Code']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_Contact"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Contact"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
                </else>
            </IfThenElse>
        </block>
        <block name="Create_Contact">
            <findElement by="xpath">//table[@summary='Account Contacts']/../../../..//img[@title='Create Contact']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <executeBlock name="Account_Contacts"/>
        </block>
        <block name="Update_Contact">
            <findElement by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW</findElement>
            <click waitForPageToFinishRendering="true"/>
            <executeBlock name="GLOBAL_SPECIFY_UPDATE">
                <parameters>
                    <parameter name="SPECIFY_XPATH" value="//table[@summary='Account Contacts']/../../../.."/>
                </parameters>
            </executeBlock>
            <executeBlock name="Account_Contacts"/>
        </block>
        <block name="Account_Contacts">
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Prefix']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="Prefix"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='First Name']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="First Name"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Last Name']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="Last Name"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Middle Name']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="Middle Name"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Suffix']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="Suffix"/>
                </parameters>
            </executeBlock>
			<executeBlock name="INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Contact Number']/../.."/>
					<parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
					<parameter name="COL_NAME" value="Contact Number"/>
				</parameters>
			</executeBlock>					
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Title']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="Title"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Job Title']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="Job Title"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Job Title Code']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="Job Title Code"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Role Type']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_2_MAIN"/>
                    <parameter name="COL_NAME" value="Role Type"/>
                </parameters>
            </executeBlock>
            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//span[text()='K']/..</findElement>
            <click waitForPageToFinishRendering="true"/>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_2_MAIN" columnName="Primary Contact"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <findElement by="xpath">//table[@summary='Account Contacts']/../../../..//a[text()='Actions']</findElement>
                    <click waitForPageToFinishRendering="true"/>
                    <IfThenElse>
                        <if>
                            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//tr[contains(@class,'Disabled')]//td[text()='Set Primary Contact']</findElement>
                        </if>
                        <then>
						<findElement by="xpath">//table[@summary='Account Contacts']/../../../..//a[text()='Actions']</findElement>
                    <click waitForPageToFinishRendering="true"/>
						</then>
                        <else>
                            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//td[text()='Set Primary Contact']</findElement>
                            <click waitForPageToFinishRendering="true"/>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="Search_Contact_Points">
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>Phone</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <executeBlock name="Concat_Phone"/>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>E-mail</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <executeBlock name="Concat_E-mail"/>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>Social network</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <executeBlock name="Concat_Social_network"/>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>Web</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <executeBlock name="Concat_Web"/>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="Concat_Phone">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
				<valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
				<valueKB inventoryName="REPEAT_3_MAIN" columnName="Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>			
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='+</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                    </setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='</setVariable>
                </else>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Area Code"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <IfThenElse>
                        <if>
                            <comparisons separator="AND">
                                <comparison operator="NOT_EQUAL">
                                    <leftOperand>
										<valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                                    </leftOperand>
                                    <rightOperand>
										<valueText/>
                                    </rightOperand>
                                </comparison>
                            </comparisons>
                        </if>
                        <then>
                            <setVariable name="VALUE_CONTACT" append="true"> (</setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Area Code"/>
                            </setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">)</setVariable>
                        </then>
                        <else>
                            <setVariable name="VALUE_CONTACT" append="true">(</setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Area Code"/>
                            </setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">)</setVariable>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone"/>
            </setVariable>
		
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Extension"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> x</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Extension"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
                </else>
            </IfThenElse>
            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_Phone"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Contact_Point"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Create_Phone">
            <executeBlock name="GLOBAL_SPECIFY_CREATE">
                <parameters>
                    <parameter name="SPECIFY_XPATH" value="//table[@summary='Contact Points']/../../../.."/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Contact Point Type']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Contact Point Type"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Type']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Type"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Purpose']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Purpose"/>
                </parameters>
            </executeBlock>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>""</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <IfThenElse>
                        <if>
                            <findElement highlightTurnedOff="true"
                                    by="xpath">//div[contains(@class,'Expansion')]/..//label[text()='Phone Country Code']/../..//a[contains(@title,'Search')]//input[@value='<valueKB
                                    inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>']</findElement>
                        </if>
                        <then/>
                        <else>
                            <IfThenElse>
                                <if>
                                    <findElement isDisplayed="true"
                                    isSkipCheckDomError="true" by="xpath">//div[contains(@class,'Expansion')]/..//label[text()='Phone Country Code']/../..//input[not(@disabled)]</findElement>
                                </if>
                                <then>
                                    <executeBlock name="Search..." isRepeatUntilBreak="true"/>
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    isDisplayed="true"
                                    isSkipCheckDomError="true"
                                    by="xpath">//div[contains(@class,'Expansion')]/..//a[text()='Search...']/..//tr//td[1][text()='<valueKB
                                    inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>']</findElement>
                                    </if>
                                    <then>
                                    <findElement
                                    isDisplayed="true"
                                    isSkipCheckDomError="true"
                                    by="xpath">//div[contains(@class,'Expansion')]/..//a[text()='Search...']/..//tr//td[1][text()='<valueKB
                                    inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>']</findElement>
                                    <click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                                    </then>
                                    <else>
                                    <findElement
                                    isDisplayed="true"
                                    isSkipCheckDomError="true" by="xpath">//div[contains(@class,'Expansion')]/..//a[text()='Search...']</findElement>
                                    <click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                                    <findElement
                                    isDisplayed="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Phone Country Code']/../..//input</findElement>
                                    <sendKeys isClear="true"
                                    isENTERKey="true" waitForPageToFinishRendering="true">
                                    <valueKB
                                    inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                                    </sendKeys>
                                    <findElement
                                    isDisplayed="true"
                                    isSkipCheckDomError="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//button[text()='Search']</findElement>
                                    <click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    isDisplayed="true"
                                    highlightTurnedOff="true"
                                    isSkipCheckDomError="true"
                                    by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//table[@_rowcount]/tbody//td[1][text()='<valueKB
                                    inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>']</findElement>
                                    </if>
                                    <then>
                                    <findElement
                                    isDisplayed="true"
                                    highlightTurnedOff="true"
                                    isSkipCheckDomError="true"
                                    by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//table[@_rowcount]/tbody//td[1][text()='<valueKB
                                    inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>']</findElement>
                                    <click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                                    </then>
                                    <else>
                                    <error message="No results found."/>
                                    </else>
                                    </IfThenElse>
                                    <findElement
                                    isDisplayed="true"
                                    isSkipCheckDomError="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//button[text()='OK']</findElement>
                                    <click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                                    </else>
                                    </IfThenElse>
                                </then>
                                <else/>
                            </IfThenElse>
                        </else>
                    </IfThenElse>
                </then>
                <else>
                    <IfThenElse>
                        <if>
                            <comparisons separator="AND">
                                <comparison operator="EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                </comparison>
                            </comparisons>
                        </if>
                        <then>
                            <IfThenElse>
                                <if>
                                    <findElement by="xpath">//div[contains(@class,'Expansion')]/..//label[text()='Phone Country Code']/../..//input[not(@disabled)]</findElement>
                                </if>
                                <then>
                                    <findElement by="xpath">//div[contains(@class,'Expansion')]/..//label[text()='Phone Country Code']/../..//input[not(@disabled)]</findElement>
                                    <sendKeys isClear="true" waitForPageToFinishRendering="true">
                                    <valueText>""</valueText>
                                    </sendKeys>
                                </then>
                                <else/>
                            </IfThenElse>
                        </then>
                        <else/>
                    </IfThenElse>
                </else>
            </IfThenElse>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Area Code']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Area Code"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Phone']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Phone"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Extension']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Extension"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='From Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="From Date"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='To Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="To Date"/>
                </parameters>
            </executeBlock>
            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//span[text()='K']/..</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="Update_Contact_Point">
            <findElement by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW</findElement>
            <click waitForPageToFinishRendering="true"/>
            <executeBlock name="GLOBAL_SPECIFY_UPDATE">
                <parameters>
                    <parameter name="SPECIFY_XPATH" value="//table[@summary='Contact Points']/../../../.."/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='To Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="To Date"/>
                </parameters>
            </executeBlock>
            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//span[text()='K']/..</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="Concat_E-mail">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
			<setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr</setVariable>
			
<!--			<setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
			<setVariable name="VALUE_CONTACT" append="true">
				<valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
			</setVariable>
			<setVariable name="VALUE_CONTACT" append="true">']</setVariable>
			<IfThenElse>
				<if>
					<comparisons separator="AND">
						<comparison operator="NOT_EQUAL">
							<leftOperand>
								<valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
							</leftOperand>
							<rightOperand>
								<valueText/>
							</rightOperand>
						</comparison>
					</comparisons>
				</if>
				<then>
					<setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
					<setVariable name="VALUE_CONTACT" append="true">
						<valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
					</setVariable>
					<setVariable name="VALUE_CONTACT" append="true">']</setVariable>
				</then>
				<else>
					<setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
				</else>
			</IfThenElse>-->
			
			<setVariable name="VALUE_CONTACT" append="true">//td[7]//a[text()='</setVariable>
			<setVariable name="VALUE_CONTACT" append="true">
				<valueKB inventoryName="REPEAT_3_MAIN" columnName="E-Mail"/>
			</setVariable>
			<setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_E-mail"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Contact_Point"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Create_E-mail">
            <executeBlock name="GLOBAL_SPECIFY_CREATE">
                <parameters>
                    <parameter name="SPECIFY_XPATH" value="//table[@summary='Contact Points']/../../../.."/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Contact Point Type']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Contact Point Type"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Purpose']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Purpose"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='E-Mail Format' or text()='Email Format']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="E-Mail Format"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='E-Mail' or text()='Email']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="E-Mail"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='From Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="From Date"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='To Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="To Date"/>
                </parameters>
            </executeBlock>
            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//span[text()='K']/..</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="Concat_Social_network">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Social Network"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="User ID"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Social Network"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_Social_Network"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Contact_Point"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Create_Social_Network">
            <executeBlock name="GLOBAL_SPECIFY_CREATE">
                <parameters>
                    <parameter name="SPECIFY_XPATH" value="//table[@summary='Contact Points']/../../../.."/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Contact Point Type']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Contact Point Type"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Purpose']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Purpose"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Social Network']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Social Network"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='User ID']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="User ID"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='From Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="From Date"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='To Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="To Date"/>
                </parameters>
            </executeBlock>
            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//span[text()='K']/..</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="Concat_Web">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true"> and td[7][contains(text(),'</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="URL"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">')]]</setVariable>
            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_Web"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Contact_Point"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Create_Web">
            <executeBlock name="GLOBAL_SPECIFY_CREATE">
                <parameters>
                    <parameter name="SPECIFY_XPATH" value="//table[@summary='Contact Points']/../../../.."/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Contact Point Type']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Contact Point Type"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Purpose']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Purpose"/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Protocol']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="Protocol"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='URL']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="URL"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='From Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="From Date"/>
                </parameters>
            </executeBlock>
            <executeBlock name="INPUT">
                <parameters>
                    <parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='To Date']/../.."/>
                    <parameter name="INV_NAME" value="REPEAT_3_MAIN"/>
                    <parameter name="COL_NAME" value="To Date"/>
                </parameters>
            </executeBlock>
            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//span[text()='K']/..</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="Click">
            <findElement by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="Search_Primary">
            <IfThenElse>
                <if>
                    <findElement by="xpath">//*[text()='Account Contacts']</findElement>
                </if>
                <then>
                    <executeBlock name="TAB">
                        <parameters>
                            <parameter name="TAB_NAME" value="Communication"/>
                        </parameters>
                    </executeBlock>
                    <executeBlock name="BUTTON">
                        <parameters>
                            <parameter name="BUTTON_NAME" value="Edit Contacts"/>
                        </parameters>
                    </executeBlock>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>
									</leftOperand>
									<rightOperand>
										<valueText/>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Click"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Click"/>
								</parameters>
							</executeBlock>
						</then>
						<else>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>'] and td[number(//th//span[text()='Job Title Code']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Click"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Click"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
                </then>
                <else>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>
									</leftOperand>
									<rightOperand>
										<valueText/>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Last Name']/../../@_d_index)+1]//span[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>']  and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Click"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Click"/>
								</parameters>
							</executeBlock>
						</then>
						<else>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Last Name']/../../@_d_index)+1]//span[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>']  and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>'] and td[number(//th//span[text()='Job Title Code']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Click"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Click"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
                </else>
            </IfThenElse>			
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>Phone</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <executeBlock name="Primary_Phone"/>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>E-mail</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <executeBlock name="Primary_E-mail"/>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>Social network</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <executeBlock name="Primary_Social_network"/>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText>Web</valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <executeBlock name="Primary_Web"/>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="Primary_Phone">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Type"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5]</setVariable>
                </else>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='+</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                    </setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='</setVariable>
                </else>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Area Code"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <IfThenElse>
                        <if>
                            <comparisons separator="AND">
                                <comparison operator="NOT_EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="REPEAT_3_MAIN" columnName="Phone Country Code"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                </comparison>
                            </comparisons>
                        </if>
                        <then>
                            <setVariable name="VALUE_CONTACT" append="true"> (</setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Area Code"/>
                            </setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">)</setVariable>
                        </then>
                        <else>
                            <setVariable name="VALUE_CONTACT" append="true">(</setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Area Code"/>
                            </setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">)</setVariable>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Phone"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"/>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Extension"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> x</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Extension"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
                </else>
            </IfThenElse>
            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Set_Primary"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Set_Primary"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Primary_E-mail">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true"> and td[7]//a[text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="E-Mail"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Set_Primary"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Set_Primary"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Primary_Social_network">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Social Network"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="User ID"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Social Network"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Set_Primary"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Set_Primary"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Primary_Web">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="REPEAT_3_MAIN" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true"> and td[7][contains(text(),'</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="REPEAT_3_MAIN" columnName="URL"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">')]]</setVariable>
            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Set_Primary"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Set_Primary"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Set_Primary">
            <findElement by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW</findElement>
            <click waitForPageToFinishRendering="true"/>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Primary"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="NOT_EQUAL">
									<leftOperand>
										<valueKB inventoryName="REPEAT_3_MAIN" columnName="Primary"/>
									</leftOperand>
									<rightOperand>
										<valueText>Yes</valueText>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<findElement by="xpath">//table[@summary='Contact Points']/../../../..//a[text()='Actions']</findElement>
							<click waitForPageToFinishRendering="true"/>
							<IfThenElse>
								<if>
									<findElement by="xpath">//div[contains(@class,'Expansion')]/..//tr[contains(@class,'Disabled')]//td[text()='Set Primary']</findElement>
								</if>
								<then>
								 <findElement by="xpath">//table[@summary='Contact Points']/../../../..//a[text()='Actions']</findElement>
							<click waitForPageToFinishRendering="true"/>
								</then>
								<else>
									<findElement by="xpath">//div[contains(@class,'Expansion')]/..//td[text()='Set Primary']</findElement>
									<click waitForPageToFinishRendering="true"/>
								</else>
							</IfThenElse>
						</then>
						<else/>
					</IfThenElse>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_3_MAIN" columnName="Primary by Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="NOT_EQUAL">
									<leftOperand>
										<valueKB inventoryName="REPEAT_3_MAIN" columnName="Primary by Purpose"/>
									</leftOperand>
									<rightOperand>
										<valueText>Yes</valueText>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<findElement by="xpath">//table[@summary='Contact Points']/../../../..//a[text()='Actions']</findElement>
							<click waitForPageToFinishRendering="true"/>
							<IfThenElse>
								<if>
									<findElement by="xpath">//div[contains(@class,'Expansion')]/..//tr[contains(@class,'Disabled')]//td[text()='Set Primary by Purpose']</findElement>
								</if>
								<then>
								<findElement by="xpath">//table[@summary='Contact Points']/../../../..//a[text()='Actions']</findElement>
							<click waitForPageToFinishRendering="true"/>
								</then>
								<else>
									<findElement by="xpath">//div[contains(@class,'Expansion')]/..//td[text()='Set Primary by Purpose']</findElement>
									<click waitForPageToFinishRendering="true"/>
								</else>
							</IfThenElse>
						</then>
						<else/>
					</IfThenElse>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="Search_Account_Contact_Responsibilities">
            <IfThenElse>
                <if>
                    <findElement by="xpath">//*[text()='Account Contacts']</findElement>
                </if>
                <then>
                    <executeBlock name="TAB">
                        <parameters>
                            <parameter name="TAB_NAME" value="Communication"/>
                        </parameters>
                    </executeBlock>
                    <executeBlock name="BUTTON">
                        <parameters>
                            <parameter name="BUTTON_NAME" value="Edit Contacts"/>
                        </parameters>
                    </executeBlock>
                </then>
                <else/>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>
									</leftOperand>
									<rightOperand>
										<valueText/>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Click"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Click"/>
								</parameters>
							</executeBlock>
						</then>
						<else>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>'] and td[number(//th//span[text()='Job Title Code']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Click"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Click"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
                </then>
                <else>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>
									</leftOperand>
									<rightOperand>
										<valueText/>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Last Name']/../../@_d_index)+1]//span[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>']  and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Click"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Click"/>
								</parameters>
							</executeBlock>
						</then>
						<else>
							<executeBlock name="SCROLLBAR">
								<parameters>
									<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contacts']/../..//div[contains(text(),'No data to display.')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contacts'][@_rowcount]//tr[1]//td)[1]"/>
									<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contacts']/../..//div[contains(@id,'scroller')]"/>
									<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contacts']//tr[td[number(//th//span[text()='First Name']/../../@_d_index)+1]//a[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="First Name"/>'] and td[number(//th//span[text()='Last Name']/../../@_d_index)+1]//span[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Last Name"/>']  and td[number(//th//span[text()='Contact Number']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Contact Number"/>'] and td[number(//th//span[text()='Job Title Code']/../../@_d_index)+1]/..//*[text()='<valueKB inventoryName="REPEAT_2_MAIN" columnName="Job Title Code"/>']]</parameter>
									<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Click"/>
									<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Click"/>
								</parameters>
							</executeBlock>
						</else>
					</IfThenElse>
                </else>
            </IfThenElse>			

            <executeBlock name="SCROLLBAR">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Account Contact Responsibilities']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Account Contact Responsibilities'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Account Contact Responsibilities']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Account Contact Responsibilities']//*[@title='<valueKB inventoryName="REPEAT_4_MAIN" columnName="Responsibility Type"/>']</parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="Create_Responsibilities"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="Update_Responsibilities"/>
                </parameters>
            </executeBlock>
        </block>
        <block name="Create_Responsibilities">
            <executeBlock name="GLOBAL_SPECIFY_ADD">
                <parameters>
                    <parameter name="SPECIFY_XPATH" value="//table[@summary='Account Contact Responsibilities']/../../../.."/>
                </parameters>
            </executeBlock>
            <executeBlock name="SELECT_KB">
                <parameters>
                    <parameter name="XPATH" value="//table[@summary='Account Contact Responsibilities']//tr[contains(@class,'Select')]"/>
                    <parameter name="INV_NAME" value="REPEAT_4_MAIN"/>
                    <parameter name="COL_NAME" value="Responsibility Type"/>
                </parameters>
            </executeBlock>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_4_MAIN" columnName="Primary Responsibility"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <findElement by="xpath">//table[@summary='Account Contact Responsibilities']/../../../..//a[text()='Actions']</findElement>
                    <click waitForPageToFinishRendering="true"/>
                    <IfThenElse>
                        <if>
                            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//tr[contains(@class,'Disabled')]//td[text()='Set Primary']</findElement>
                        </if>
                        <then>
						<findElement by="xpath">//table[@summary='Account Contact Responsibilities']/../../../..//a[text()='Actions']</findElement>
                    <click waitForPageToFinishRendering="true"/>
						</then>
                        <else>
                            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//td[text()='Set Primary']</findElement>
                            <click waitForPageToFinishRendering="true"/>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="Update_Responsibilities">
            <findElement by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW</findElement>
            <click waitForPageToFinishRendering="true"/>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="REPEAT_4_MAIN" columnName="Primary Responsibility"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <findElement by="xpath">//table[@summary='Account Contact Responsibilities']/../../../..//a[text()='Actions']</findElement>
                    <click waitForPageToFinishRendering="true"/>
                    <IfThenElse>
                        <if>
                            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//tr[contains(@class,'Disabled')]//td[text()='Set Primary']</findElement>
                        </if>
                        <then>
						<findElement by="xpath">//table[@summary='Account Contact Responsibilities']/../../../..//a[text()='Actions']</findElement>
                    <click waitForPageToFinishRendering="true"/>
						</then>
                        <else>
                            <findElement by="xpath">//div[contains(@class,'Expansion')]/..//td[text()='Set Primary']</findElement>
                            <click waitForPageToFinishRendering="true"/>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <executeBlock name="GLOBAL_GO_TO_TASK"/>
        <repeat inventoryName="REPEAT_1_MAIN">
            <executeBlock name="Search"/>
            <repeat inventoryName="REPEAT_2_MAIN">
                <executeBlock name="Search_Account_Contacts"/>
                <executeBlock name="GLOBAL_SAVE"/>
                <repeat inventoryName="REPEAT_3_MAIN">
                    <executeBlock name="Search_Contact_Points"/>
                    <executeBlock name="GLOBAL_SAVE"/>
                </repeat>
                <executeBlock name="GLOBAL_SAVE_AND_CLOSE"/>
                <repeat inventoryName="REPEAT_3_MAIN">
                    <IfThenElse>
                        <if>
                            <comparisons separator="OR">
                                <comparison operator="NOT_EQUAL">
                                    <leftOperand>
										<valueKB inventoryName="REPEAT_3_MAIN" columnName="Primary"/>
                                    </leftOperand>
                                    <rightOperand>
										<valueText/>
                                    </rightOperand>
                                </comparison>
                                <comparison operator="NOT_EQUAL">
                                    <leftOperand>
										<valueKB inventoryName="REPEAT_3_MAIN" columnName="Primary by Purpose"/>
                                    </leftOperand>
                                    <rightOperand>
										<valueText/>
                                    </rightOperand>
                                </comparison>
                            </comparisons>
                        </if>
                        <then>
                            <executeBlock name="Search_Primary"/>
                            <executeBlock name="GLOBAL_SAVE"/>
                        </then>
                        <else/>
                    </IfThenElse>
                </repeat>
                <repeat inventoryName="REPEAT_4_MAIN">
                    <executeBlock name="Search_Account_Contact_Responsibilities"/>
                    <executeBlock name="GLOBAL_SAVE"/>
                </repeat>
            </repeat>
            <executeBlock name="GLOBAL_SAVE_AND_CLOSE"/>
            <executeBlock name="GLOBAL_SAVE_AND_CLOSE"/>	
        </repeat>
    </fusionNavigation>
</navigation>
