<?xml version="1.0"?>
<navigation xmlns="http://navigation0005.configurator.erapidsuite.com" xmlns:xsd="http://xsdutility.configurator.erapidsuite.com">
    <name>Manage Supplier Spend Authorization Approvals</name>
    <svn>
        <xsd:revision>$Revision: 54999 $:</xsd:revision>
        <xsd:author>$Author: phermwit.seethong $:</xsd:author>
        <xsd:date>$Date: 2016-05-06 14:30:07 +0700 (Fri, 06 May 2016) $:</xsd:date>
        <xsd:headURL>$HeadURL: http://svn01.rapidesuite.com:999/svn/a/dev/rapidesuite/controldata/FUSION_11.1.9/trunk/core/knowledgebase/navigation/FINANCIALS/Establish%20Enterprise%20Structures%20(Barbados).xml $:</xsd:headURL>
        <xsd:id>$Id: Establish Enterprise Structures (Barbados).xml 54999 2016-05-06 07:30:07Z phermwit.seethong $:</xsd:id>
    </svn>
    <description/>
    <type>FUSION</type>
    <engine_type>SELENIUM</engine_type>
    <modules/>
    <mapper_use_type>UNDEFINED</mapper_use_type>
    <validate_parent_child_relationships_for_mapped_data>true</validate_parent_child_relationships_for_mapped_data>
    <fusionNavigation hasScope="false"
        isBatchingBasedOnRootInventoryUniqueRecords="true"
        taskName="Manage Supplier Spend Authorization Approvals"
        isBatchingAllowed="true" applicationKey="APPLICATION_HOME_PAGE">
        <dependencies>
			<navigation name="Manage Users"/>
            <navigation name="Manage Approval Groups"/>
        </dependencies>
        <parameters>
            <parameter name="MAIN_REPEAT_1" value="Manage Supplier Spend Authorization Approvals - Approval Rules"/>
            <parameter name="MAIN_REPEAT_2" value="Manage Supplier Spend Authorization Approvals - Rules"/>
            <parameter name="MAIN_REPEAT_3" value="Manage Supplier Spend Authorization Approvals - Condition"/>
            <parameter name="MAIN_REPEAT_4" value="Manage Supplier Spend Authorization Approvals - Condition Value"/>
            <parameter name="MAIN_REPEAT_5" value="Manage Supplier Spend Authorization Approvals - Actions"/>
        </parameters>
        <block name="SAVE_AND_CLOSE">
            <executeBlock name="GLOBAL_SAVE_AND_CLOSE"/>
        </block>
        <block name="SAVE">
            <executeBlock name="GLOBAL_SAVE"/>
        </block>
        <block name="ERROR_AFTER_SAVE">
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true" by="xpath">//div[text()='Error']</findElement>
                </if>
                <then>
                    <error message="Please check error on application"/>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="SCROLLBAR_GENERIC_TOP">
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true"
                        isDisplayed="true" by="xpath">((//table[@summary='Rules'][@_startrow='0']//tr)[1]//td)[1]</findElement>
                </if>
                <then>
                    <pause durationInSecs="1"/>
                    <break/>
                </then>
                <else>
                    <findElement highlightTurnedOff="true" by="xpath">SCROLLBAR_GENERIC_1_SCROLLER</findElement>
                    <scroll direction="TOP"/>
                    <pause durationInSecs="1"/>
                </else>
            </IfThenElse>
        </block>
        <block name="SCROLLBAR_DOWN">
            <findElement highlightTurnedOff="true" by="xpath">//table[@summary='Conditions']/../..//div[contains(@id,'scroller')]</findElement>
            <IfThenElse>
                <if>
                    <isEndOfScroll/>
                </if>
                <then>
                    <pause durationInSecs="1"/>
                    <break/>
                </then>
                <else>
                    <findElement highlightTurnedOff="true" by="xpath">//table[@summary='Conditions']/../..//div[contains(@id,'scroller')]</findElement>
                    <scroll direction="DOWN"/>
                    <pause durationInSecs="1"/>
                </else>
            </IfThenElse>
        </block>
        <block name="SCROLLBAR_GENERIC_DOWN">
            <IfThenElse>
                <if>
                    <findElement isDisplayed="true" by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW</findElement>
                </if>
                <then>
                    <executeBlock name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK"/>
                    <break/>
                </then>
                <else>
                    <findElement highlightTurnedOff="true" by="xpath">SCROLLBAR_GENERIC_1_SCROLLER</findElement>
                    <IfThenElse>
                        <if>
                            <isEndOfScroll/>
                        </if>
                        <then>
                            <executeBlock name="SCROLLBAR_GENERIC_1_CREATE_BLOCK"/>
                            <break/>
                        </then>
                        <else>
                            <findElement highlightTurnedOff="true" by="xpath">SCROLLBAR_GENERIC_1_SCROLLER</findElement>
                            <scroll direction="DOWN"/>
                            <pause durationInSecs="1"/>
                        </else>
                    </IfThenElse>
                </else>
            </IfThenElse>
        </block>
        <block name="SCROLLBAR_GENERIC_1">
            <!-- check if there is no data found returned after the search, if so then we create a new record if applicable -->
            <IfThenElse>
                <if>
                    <findElement by="xpath">SCROLLBAR_GENERIC_1_NO_DATA</findElement>
                </if>
                <then>
                    <executeBlock name="SCROLLBAR_GENERIC_1_CREATE_BLOCK"/>
                </then>
                <else>
                    <IfThenElse>
                        <if>
                            <evaluateXPATHBoolean>SCROLLBAR_GENERIC_1_COUNT_ROW</evaluateXPATHBoolean>
                        </if>
                        <then>
                            <!-- resetting the scollbar back to the Top because the form remembers where it was even when searching a new record -->
                            <executeBlock name="SCROLLBAR_GENERIC_TOP" isRepeatUntilBreak="true"/>
                            <findElement highlightTurnedOff="true" by="xpath">SCROLLBAR_GENERIC_1_SCROLLER</findElement>
                            <scroll direction="TOP"/>
                            <findElement by="xpath">SCROLLBAR_GENERIC_1_FIRST_ROW</findElement>
                            <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                            <executeBlock name="SCROLLBAR_GENERIC_DOWN" isRepeatUntilBreak="true"/>
                        </then>
                        <else>
                            <IfThenElse>
                                <if>
                                    <findElement isDisplayed="true" by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW</findElement>
                                </if>
                                <then>
                                    <executeBlock name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK"/>
                                </then>
                                <else>
                                    <executeBlock name="SCROLLBAR_GENERIC_1_CREATE_BLOCK"/>
                                </else>
                            </IfThenElse>
                            <break/>
                        </else>
                    </IfThenElse>
                </else>
            </IfThenElse>
        </block>
        <!-- APPROVAL RULE -->
        <block name="APPROVAL_RULE_EDIT">
            <findElement by="xpath">//a[text()='Actions']/../..//div</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//td[text()='Edit Rules']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="APPROVAL_RULE_ENABLE_DISABLE">
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_1" columnName="Enabled"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <IfThenElse>
                        <if>
                            <comparisons separator="AND">
                                <comparison operator="EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_1" columnName="Enabled"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Yes</valueText>
                                    </rightOperand>
                                </comparison>
                            </comparisons>
                        </if>
                        <then>
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true"
                                    by="xpath">//tr[td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_1"
                                    columnName="Stage"/>'] and td[2][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_1" columnName="Participant"/>'] and td[5]//img[not(@style)]]</findElement>
                                </if>
                                <then/>
                                <else>
                                    <findElement
                                    highlightTurnedOff="true"
                                    by="xpath">//tr[td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_1"
                                    columnName="Stage"/>'] and td[2][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_1" columnName="Participant"/>']]//td[1]</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <findElement by="xpath">//a[text()='Actions']/../..//div</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <findElement by="xpath">//td[text()='Enable']</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                </else>
                            </IfThenElse>
                        </then>
                        <else>
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true"
                                    by="xpath">//tr[td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_1"
                                    columnName="Stage"/>'] and td[2][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_1" columnName="Participant"/>'] and td[5]//img[not(@style)]]</findElement>
                                </if>
                                <then>
                                    <findElement
                                    highlightTurnedOff="true"
                                    by="xpath">//tr[td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_1"
                                    columnName="Stage"/>'] and td[2][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_1" columnName="Participant"/>']]//td[1]</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <findElement by="xpath">//a[text()='Actions']/../..//div</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <findElement by="xpath">//td[text()='Disable']</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                </then>
                                <else/>
                            </IfThenElse>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="FIND_APPROVAL">
            <IfThenElse>
                <if>
                    <findElement by="xpath">//tr[td[1][text()='<valueKB
                            inventoryName="MAIN_REPEAT_1"
                            columnName="Stage"/>'] and td[2][text()='<valueKB
                            inventoryName="MAIN_REPEAT_1" columnName="Participant"/>']]</findElement>
                </if>
                <then>
                    <findElement by="xpath">//tr[td[1][text()='<valueKB
                            inventoryName="MAIN_REPEAT_1"
                            columnName="Stage"/>'] and td[2][text()='<valueKB
                            inventoryName="MAIN_REPEAT_1" columnName="Participant"/>']]//td[1]</findElement>
                    <click waitForPageToFinishRendering="true"/>
                    <executeBlock name="APPROVAL_RULE_EDIT"/>
                </then>
                <else>
                    <error message="The field 'Stage' and 'Participant' doesn't exist."/>
                </else>
            </IfThenElse>
        </block>
        <!-- RULE -->
        <block name="RULES">
            <!-- Rule -->
			<executeBlock name="INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Rule']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Rule"/>
				</parameters>
			</executeBlock>
            <!-- Priority -->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Priority']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Priority"/>
				</parameters>
			</executeBlock>
            <!-- Description -->
			<executeBlock name="INPUT_TEXTAREA">
				<parameters>
					<parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Description']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Description"/>
				</parameters>
			</executeBlock>
            <!-- Rule always applies -->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//div[contains(@class,'Expansion')]/..//label[text()='Rule always applies']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Rule always applies"/>
				</parameters>
			</executeBlock>
        </block>
        <block name="RULE_ENABLE_DISABLE">
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Enable"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <findElement
                            by="xpath">//table[@summary='Rules']//td[1][text()='<valueKB
                            inventoryName="MAIN_REPEAT_2" columnName="Rule"/>']</findElement>
                    <click waitForPageToFinishRendering="true"/>
                    <IfThenElse>
                        <if>
                            <comparisons separator="AND">
                                <comparison operator="EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_2" columnName="Enable"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Yes</valueText>
                                    </rightOperand>
                                </comparison>
                            </comparisons>
                        </if>
                        <then>
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//span[text()='Priority']</findElement>
                                </if>
                                <then>
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    highlightTurnedOff="true"
                                    by="xpath">//table[@summary='Rules']//tr[contains(@class,'Select')]//tr[td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_2" columnName="Rule"/>'] and td[4]//img]</findElement>
                                    </if>
                                    <then/>
                                    <else>
                                    <findElement by="xpath">//*[text()='Rules']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <findElement by="xpath">//td[text()='Enable']</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    </else>
                                    </IfThenElse>
                                </then>
                                <else>
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    highlightTurnedOff="true"
                                    by="xpath">//table[@summary='Rules']//tr[contains(@class,'Select')]//tr[td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_2" columnName="Rule"/>'] and td[3]//img]</findElement>
                                    </if>
                                    <then/>
                                    <else>
                                    <findElement by="xpath">//*[text()='Rules']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <findElement by="xpath">//td[text()='Enable']</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    </else>
                                    </IfThenElse>
                                </else>
                            </IfThenElse>
                        </then>
                        <else>
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//span[text()='Priority']</findElement>
                                </if>
                                <then>
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    highlightTurnedOff="true"
                                    by="xpath">//table[@summary='Rules']//tr[contains(@class,'Select')]//tr[td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_2" columnName="Rule"/>'] and td[4]//img]</findElement>
                                    </if>
                                    <then>
                                    <findElement by="xpath">//*[text()='Rules']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <findElement by="xpath">//td[text()='Disable']</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    </then>
                                    <else/>
                                    </IfThenElse>
                                </then>
                                <else>
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    highlightTurnedOff="true"
                                    by="xpath">//table[@summary='Rules']//tr[contains(@class,'Select')]//tr[td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_2" columnName="Rule"/>'] and td[3]//img]</findElement>
                                    </if>
                                    <then>
                                    <findElement by="xpath">//*[text()='Rules']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <findElement by="xpath">//td[text()='Disable']</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    </then>
                                    <else/>
                                    </IfThenElse>
                                </else>
                            </IfThenElse>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="RULE_OK">
            <IfThenElse>
                <if>
                    <findElement isDisplayed="true" by="xpath">//div[@data-afr-popupid]//div[contains(text(),'Rule')]/../../../../../../..//span[text()='K']/..</findElement>
                </if>
                <then>
                    <findElement by="xpath">//div[@data-afr-popupid]//div[contains(text(),'Rule')]/../../../../../../..//span[text()='K']/..</findElement>
                    <click waitForPageToFinishRendering="true"/>
					<pause durationInSecs="1"/>
                </then>
                <else>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" by="xpath">//div[@data-afr-popupid]//div[contains(text(),'Rule')]/../../../../../../..//button[text()='OK']</findElement>
						</if>
						<then>
							<findElement by="xpath">//div[@data-afr-popupid]//div[contains(text(),'Rule')]/../../../../../../..//button[text()='OK']</findElement>
							<click waitForPageToFinishRendering="true"/>
							<pause durationInSecs="1"/>
						</then>
						<else>
							<findElement by="xpath">//div[@data-afr-popupid]//div[contains(text(),'Rule')]/../../../../../../..//*[text()='OK']</findElement>
							<click waitForPageToFinishRendering="true"/>
							<pause durationInSecs="1"/>
						</else>
					</IfThenElse>
                </else>
            </IfThenElse>
        </block>
        <block name="WAITING_RULE_ACTION_CREATE">
            <IfThenElse>
                <if>
                    <findElement isDisplayed="true" by="xpath">//div[contains(@class,'Popup')]//td[text()='Create']</findElement>
                </if>
                <then>
                    <findElement by="xpath">//div[contains(@class,'Popup')]//td[text()='Create']</findElement>
                    <click waitForPageToFinishRendering="true"/>
                </then>
                <else>
                    <findElement by="xpath">//*[text()='Rules']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
                    <click waitForPageToFinishRendering="true"/>
                    <pause durationInSecs="1"/>
                </else>
            </IfThenElse>
        </block>
        <block name="RULE_ACTION_CREATE">
            <findElement by="xpath">//*[text()='Rules']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//div[contains(@class,'Popup')]//td[text()='Create']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="RULE_ACTION_EDIT">
            <findElement by="xpath">//*[text()='Rules']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//table[@style='position: relative;']//td[text()='Edit']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="CREATE_RULE">
            <IfThenElse>
                <if>
                    <findElement by="xpath">SCROLLBAR_GENERIC_1_NO_DATA</findElement>
                </if>
                <then>
                    <executeBlock name="RULE_ACTION_CREATE"/>
                </then>
                <else>
                    <executeBlock name="SCROLLBAR_GENERIC_TOP"/>
                    <findElement by="xpath">SCROLLBAR_GENERIC_1_FIRST_ROW</findElement>
                    <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                    <executeBlock name="RULE_ACTION_CREATE"/>
                </else>
            </IfThenElse>
        </block>
        <block name="EDIT_RULE">
            <findElement by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW//td[1]</findElement>
            <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
            <executeBlock name="RULE_ACTION_EDIT"/>
        </block>
        <block name="FIND_RULES">
            <executeBlock name="SCROLLBAR_GENERIC_1">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Rules']/../..//div[text()='No data to display.']"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="((//table[@summary='Rules']//tr)[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_COUNT_ROW" value="(count(//table[@summary='Rules']//tr)) > 10"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//*[text()='Rules']/../../../../../../../../../../../..//div[contains(@id,'scroller')]"/>
                    <parameter
                            name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Rules']//tr[td[1][text()='<valueKB
                            inventoryName="MAIN_REPEAT_2" columnName="Rule"/>']]</parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="CREATE_RULE"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="EDIT_RULE"/>
                </parameters>
            </executeBlock>
        </block>
        <!-- CONDITIONS -->
        <block name="ADD_CONDITION">
            <findElement by="xpath">//*[text()='Conditions']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//td[text()='Add Condition']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="AS_PARENT">
            <pause durationInSecs="1"/>
            <findElement by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='As Parent']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="AS_CHILD">
            <pause durationInSecs="1"/>
            <findElement by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='As Child']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="AS_ABOVE">
            <pause durationInSecs="1"/>
            <findElement by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Above']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="AS_BELOW">
            <pause durationInSecs="1"/>
            <findElement by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Below']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="ADD_OPERATOR">
            <findElement by="xpath">//*[text()='Conditions']/../../../../../../..//a[text()='Actions']/../..//div</findElement>
            <click waitForPageToFinishRendering="true"/>
            <findElement by="xpath">//td[text()='Add Operator']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="OK_CONDITION">
            <findElement by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//span[text()='K']/..</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="TEMPLATE_LOV_CONDITION">
            <pause durationInSecs="1"/>
            <findElement by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tbody/tr[not(@style)]/td/label[text()='Value']/../..//a</findElement>
            <click waitForPageToFinishRendering="true"/>
            <pause durationInSecs="1"/>
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true"
                        isDisplayed="true" by="xpath">//table/tbody/tr/td/div/a[text()='Search...']</findElement>
                </if>
                <then>
                    <findElement by="xpath">//table/tbody/tr/td/div/a[text()='Search...']</findElement>
                    <click waitForPageToFinishRendering="true"/>
                    <pause durationInSecs="1"/>
                </then>
                <else/>
            </IfThenElse>
            <!--INPUT-->
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true"
                        isDisplayed="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../..//input</findElement>
                </if>
                <then>
                    <findElement by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../..//input</findElement>
                </then>
                <else>
                    <IfThenElse>
                        <if>
                            <findElement isDisplayed="true" by="xpath">//table/tbody/tr/td/div/div/div//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Attribute']/../..//input</findElement>
                        </if>
                        <then>
                            <findElement isDisplayed="true" by="xpath">//table/tbody/tr/td/div/div/div//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Attribute']/../..//input</findElement>
                        </then>
                        <else>
                            <findElement isDisplayed="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Attribute']/../..//input</findElement>
                        </else>
                    </IfThenElse>
                </else>
            </IfThenElse>
            <sendKeys isClear="true" isENTERKey="true" waitForPageToFinishRendering="true">
                <valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Value1"/>
            </sendKeys>
            <!--SEARCH-->
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true"
                        isDisplayed="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../../../../../../../../../..//button[text()='Search']</findElement>
                </if>
                <then>
                    <findElement by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../../../../../../../../../..//button[text()='Search']</findElement>
                </then>
                <else>
                    <findElement by="xpath">//table[@style='position: relative;']/tbody/tr/td/div/div/table/tbody/tr/td/div/div//label[text()='Attribute']/../../../../../../../../../..//button[text()='Search']</findElement>
                </else>
            </IfThenElse>
            <click waitForPageToFinishRendering="true"/>
            <!--LOOKUP-->
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true"
                        isDisplayed="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../..//input</findElement>
                </if>
                <then>
                    <IfThenElse>
                        <if>
                            <findElement highlightTurnedOff="true"
                                isDisplayed="true"
                                    by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../../../../../../../../../../../../../../../../..//td[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Value1"/>']</findElement>
                        </if>
                        <then>
                            <findElement
                                    by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../../../../../../../../../../../../../../../../..//td[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Value1"/>']</findElement>
                        </then>
                        <else>
                            <error message="This data does not exist"/>
                        </else>
                    </IfThenElse>
                </then>
                <else>
                    <IfThenElse>
                        <if>
                            <findElement highlightTurnedOff="true"
                                isDisplayed="true"
                                    by="xpath">//table[@style='position: relative;']/tbody/tr/td/div/div/table/tbody/tr/td/div/div//label[text()='Attribute']/../../../../../../../../../../../../../../../../..//td[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Value1"/>']</findElement>
                        </if>
                        <then>
                            <findElement
                                    by="xpath">//table[@style='position: relative;']/tbody/tr/td/div/div/table/tbody/tr/td/div/div//label[text()='Attribute']/../../../../../../../../../../../../../../../../..//td[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Value1"/>']</findElement>
                        </then>
                        <else>
                            <error message="This data does not exist"/>
                        </else>
                    </IfThenElse>
                </else>
            </IfThenElse>
            <click waitForPageToFinishRendering="true"/>
            <!--OK-->
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true"
                        isDisplayed="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../../../../../../../../../../../../../../../../../../../..//button[text()='OK']</findElement>
                </if>
                <then>
                    <findElement by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Value']/../../../../../../../../../../../../../../../../../../../..//button[text()='OK']</findElement>
                </then>
                <else>
                    <findElement by="xpath">//table[@style='position: relative;']/tbody/tr/td/div/div/table/tbody/tr/td/div/div//label[text()='Attribute']/../../../../../../../../../../../../../../../../../../../..//button[text()='OK']</findElement>
                </else>
            </IfThenElse>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="CONDITION">
            <!-- Condition - Type -->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
					<parameter name="COL_NAME" value="Condition - Type"/>
				</parameters>
			</executeBlock>	
            
				<!-- Condition - Attribute -->
				<IfThenElse>
					<if>
						<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath">//label[text()='Attribute']/../..//a</findElement>
					</if>
					<then>
						<!--Attribute-->
						<IfThenElse>
							<if>
								<findElement by="xpath">//label[text()='Attribute']/../..//td/input[@value="<valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>"]</findElement>
							</if>
							<then/>
							<else>
								<findElement by="xpath">//label[text()='Attribute']/../..//td/input/..//*[@title='Search: Attribute']</findElement>
								<click waitForPageToFinishRendering="true"/>
								<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//label[text()='Attribute']/../..//input</findElement>
								<sendKeys isClear="true" isENTERKey="true" waitForPageToFinishRendering="true">
									<valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>
								</sendKeys>
								<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//button[text()='Search']</findElement>
								<click waitForPageToFinishRendering="true"/>
								<IfThenElse>
									<if>
										<findElement
                                    by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//td[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>']</findElement>
									</if>
									<then>
										<findElement
                                    by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//td[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>']</findElement>
										<click waitForPageToFinishRendering="true"/>
										<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../../..//button[text()='OK']</findElement>
										<click waitForPageToFinishRendering="true"/>
									</then>
									<else>
										<error message="The field 'Attribute' doesn't exist."/>
									</else>
								</IfThenElse>
							</else>
						</IfThenElse>	
					</then>
					<else>
						<IfThenElse>
							<if>
								<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath">//label[text()='Attribute']/../..//select</findElement>
							</if>
							<then>
								<executeBlock name="SELECT_KB">
									<parameters>
										<parameter name="XPATH" value="//label[text()='Attribute']/../.."/>
										<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
										<parameter name="COL_NAME" value="Condition - Attribute"/>
									</parameters>
								</executeBlock>				
							</then>
							<else>
								<IfThenElse>
									<if>
										<findElement by="xpath">//label[text()='Attribute']/../..//td/input[@value="<valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>"]</findElement>
									</if>
									<then/>
									<else>
										<findElement by="xpath">//label[text()='Attribute']/../..//td/input/..//*[@title='Search: Attribute']</findElement>
										<click waitForPageToFinishRendering="true"/>
										<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//label[text()='Attribute']/../..//input</findElement>
										<sendKeys isClear="true" isENTERKey="true" waitForPageToFinishRendering="true">
											<valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>
										</sendKeys>
										<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//button[text()='Search']</findElement>
										<click waitForPageToFinishRendering="true"/>
										<IfThenElse>
											<if>
												<findElement
											by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//td[text()='<valueKB
											inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>']</findElement>
											</if>
											<then>
												<findElement
											by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//td[text()='<valueKB
											inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>']</findElement>
												<click waitForPageToFinishRendering="true"/>
												<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../../..//button[text()='OK']</findElement>
												<click waitForPageToFinishRendering="true"/>
											</then>
											<else>
												<error message="The field 'Attribute' doesn't exist."/>
											</else>
										</IfThenElse>
									</else>
								</IfThenElse>					
							</else>
						</IfThenElse>
						<!--
						<IfThenElse>
							<if>
								<findElement by="xpath">//label[text()='Attribute']/../..//td/input[@value="<valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>"]</findElement>
							</if>
							<then/>
							<else>
								<findElement by="xpath">//label[text()='Attribute']/../..//td/input/..//a[@title='Search: Attribute']</findElement>
								<click waitForPageToFinishRendering="true"/>
								<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//label[text()='Attribute']/../..//input</findElement>
								<sendKeys isClear="true" isENTERKey="true" waitForPageToFinishRendering="true">
									<valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>
								</sendKeys>
								<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//button[text()='Search']</findElement>
								<click waitForPageToFinishRendering="true"/>
								<IfThenElse>
									<if>
										<findElement
                                    by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//td[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>']</findElement>
									</if>
									<then>
										<findElement
                                    by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../..//td[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>']</findElement>
										<click waitForPageToFinishRendering="true"/>
										<findElement by="xpath">//div[contains(text(),'Search and Select: Attribute')]/../../../../../../../..//button[text()='OK']</findElement>
										<click waitForPageToFinishRendering="true"/>
									</then>
									<else>
										<error message="The field 'Attribute' doesn't exist."/>
									</else>
								</IfThenElse>
							</else>
						</IfThenElse>
						<templateLOV label="Attribute">
                        <popupDialog hasDropDownList="false">
                            <searchLabel label="Attribute" position="1" isMainLabel="true">
                                <valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Attribute"/>
                            </searchLabel>
                        </popupDialog>
                    </templateLOV>-->
					</else>
				</IfThenElse>
				<!--Condition - Operator-->
				<executeBlock name="SELECT_KB">
					<parameters>
						<parameter name="XPATH" value="//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//label[text()='Operator']/../.."/>
						<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
						<parameter name="COL_NAME" value="Condition - Operator"/>
					</parameters>
				</executeBlock>
				<!--Condition - Value Type-->
				<executeBlock name="SELECT_KB">
					<parameters>
						<parameter name="XPATH" value="//label[text()='Value Type']/../.."/>
						<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
						<parameter name="COL_NAME" value="Condition - Value Type"/>
					</parameters>
				</executeBlock>	

				<!--Condition - Value-->
				<IfThenElse>
					<if>
						<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath">//div[contains(text(),'Condition')]/../../../../../../..//tr[not(@style)]/td/label[text()='Minimum Value']/../..//input</findElement>
					</if>
					<then>
						<!--Condition - Value1-->
						<executeBlock name="INPUT">
							<parameters>
								<parameter name="XPATH" value="//div[contains(text(),'Condition')]/../../../../../../..//tr[not(@style)]/td/label[text()='Minimum Value']/../.."/>
								<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
								<parameter name="COL_NAME" value="Condition - Value1"/>
							</parameters>
						</executeBlock>
						<!--	Condition - Value2-->
						<executeBlock name="INPUT">
							<parameters>
								<parameter name="XPATH" value="//div[contains(text(),'Condition')]/../../../../../../..//tr[not(@style)]/td/label[text()='Maximum Value']/../.."/>
								<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
								<parameter name="COL_NAME" value="Condition - Value2"/>
							</parameters>
						</executeBlock>	
					</then>
					<else>
						<IfThenElse>
							<if>
								<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//td//label[text()='Value']</findElement>
							</if>
							<then>
								<IfThenElse>
									<if>

										<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tbody/tr[not(@style)]/td/label[text()='Value']/../..//select</findElement>
									</if>
									<then>
										<!--Condition - Value1-->
										<executeBlock name="SELECT_KB">
											<parameters>
												<parameter name="XPATH" value="//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tbody/tr[not(@style)]/td/label[text()='Value']/../.."/>
												<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
												<parameter name="COL_NAME" value="Condition - Value1"/>
											</parameters>
										</executeBlock>	
									</then>
									<else>
										<IfThenElse>
											<if>

												<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tr[not(@style)][td[label[text()='Value']] and td[input and div and a and img]]//input</findElement>
											</if>
											<then>

												<executeBlock name="TEMPLATE_LOV_CONDITION"/>
											</then>
											<else>
												<IfThenElse>
													<if>

														<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tr[not(@style)][td[label[text()='Value']] and td[input and not(div) and a and img]]//input</findElement>
													</if>
													<then>
														<executeBlock name="TEMPLATE_LOV_CONDITION"/>
													</then>
													<else>
														<IfThenElse>
															<if>

																<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tr[not(@style)][td[label[text()='Value']] and td[not(input) and div and not(a) and not(img) and span ]]//input</findElement>
															</if>
															<then>

																<executeBlock name="TEMPLATE_LOV_CONDITION"/>
															</then>
															<else>
																<IfThenElse>
																	<if>

																		<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tr[not(@style)][td[label[text()='Maximum Value']] and td[input and not(div) and not(a) and not(img) and not(span) ]]//input</findElement>
																	</if>
																	<then>
																		<findElement by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tr[td[label[text()='Maximum Value']] and td[input and not(div) and not(a) and not(img) and not(span) ]]//input</findElement>
																		<sendKeys isClear="true" waitForPageToFinishRendering="true">
																			<valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Value1"/>
																		</sendKeys>
																	</then>
																	<else>
																		<IfThenElse>
																			<if>
																				<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tr[not(@style)][td[label[text()='Value']] and td[input and not(div) and not(a) and not(img) and not(span) ]]//input</findElement>
																			</if>
																			<then>
																				<findElement by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//tr[not(@style)][td[label[text()='Value']] and td[input and not(div) and not(a) and not(img) and not(span) ]]//input</findElement>
																				<sendKeys isClear="true" waitForPageToFinishRendering="true">
																					<valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Value1"/>
																				</sendKeys>
																			</then>
																			<else/>
																		</IfThenElse>
																	</else>
																</IfThenElse>
															</else>
														</IfThenElse>
													</else>
												</IfThenElse>
											</else>
										</IfThenElse>
									</else>
								</IfThenElse>
							</then>
							<else/>
						</IfThenElse>
					</else>
				</IfThenElse>
        </block>
        <block name="MATCH_CONDITION_VALUE"/>
        <block name="ADD_CONDITION_VALUE">
            <findElement by="xpath">//div[contains(@id,'window')]//div[not(@style)]/table/tbody/tr/td/table//a[text()='Actions']</findElement>
            <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
            <findElement by="xpath">//td[text()='Add']</findElement>
            <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
            <findElement by="xpath">//div[text()='Search and Select: Value']/../../../../../../..//label[text()='Value']/../..//input</findElement>
            <sendKeys isClear="true" isENTERKey="true" waitForPageToFinishRendering="true">
                <valueKB inventoryName="MAIN_REPEAT_4" columnName="Value"/>
            </sendKeys>
            <findElement by="xpath">//div[text()='Search and Select: Value']/../../../../../../..//button[text()='Search']</findElement>
            <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true"
                            by="xpath">//div[text()='Search and Select: Value']/../../../../../../..//td[text()='<valueKB
                            inventoryName="MAIN_REPEAT_4" columnName="Value"/>']</findElement>
                </if>
                <then>
                    <findElement
                            by="xpath">//div[text()='Search and Select: Value']/../../../../../../..//td[text()='<valueKB
                            inventoryName="MAIN_REPEAT_4" columnName="Value"/>']</findElement>
                    <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                </then>
                <else>
                    <error message="This 'Value' does not exist"/>
                </else>
            </IfThenElse>
            <findElement by="xpath">//div[text()='Search and Select: Value']/../../../../../../..//button[text()='OK']</findElement>
            <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
        </block>
        <block name="SCROLLBAR_GENERIC_2">
            <!-- check if there is no data found returned after the search, if so then we create a new record if applicable -->
            <IfThenElse>
                <if>
                    <findElement by="xpath">SCROLLBAR_GENERIC_1_NO_DATA</findElement>
                </if>
                <then>
                    <executeBlock name="SCROLLBAR_GENERIC_1_CREATE_BLOCK"/>
                </then>
                <else>
                    <IfThenElse>
                        <if>
                            <findElement by="xpath">SCROLLBAR_GENERIC_1_SCROLLER</findElement>
                        </if>
                        <then>
                            <!-- resetting the scollbar back to the Top because the form remembers where it was even when searching a new record -->
                            <executeBlock name="SCROLLBAR_GENERIC_TOP" isRepeatUntilBreak="true"/>
                            <findElement highlightTurnedOff="true" by="xpath">SCROLLBAR_GENERIC_1_SCROLLER</findElement>
                            <scroll direction="TOP"/>
                            <findElement by="xpath">SCROLLBAR_GENERIC_1_FIRST_ROW</findElement>
                            <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                            <executeBlock name="SCROLLBAR_GENERIC_DOWN" isRepeatUntilBreak="true"/>
                        </then>
                        <else>
                            <IfThenElse>
                                <if>
                                    <findElement isDisplayed="true" by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW</findElement>
                                </if>
                                <then>
                                    <executeBlock name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK"/>
                                </then>
                                <else>
                                    <executeBlock name="SCROLLBAR_GENERIC_1_CREATE_BLOCK"/>
                                </else>
                            </IfThenElse>
                            <break/>
                        </else>
                    </IfThenElse>
                </else>
            </IfThenElse>
        </block>
        <block name="FIND_CONDITION_VALUE">
            <executeBlock name="SCROLLBAR_GENERIC_2">
                <parameters>
                    <parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//div[contains(@id,'window')]//div[not(@style)]/table/tbody/tr/td/table//div[text()='No data to display.']"/>
                    <parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="((//div[contains(@id,'window')]//div[not(@style)]/table/tbody/tr/td/table//table[@summary='Value']//tr)[1]//td)[1]"/>
                    <parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//div[contains(@id,'window')]//div[not(@style)]/table/tbody/tr/td/table//div[contains(@id,'scroller')]"/>
                    <parameter
                            name="SCROLLBAR_GENERIC_1_FIND_ROW">//div[contains(@id,'window')]//div[not(@style)]/table/tbody/tr/td/table//table[@summary='Value']//tr[td[1][text()='<valueKB
                            inventoryName="MAIN_REPEAT_4" columnName="Value"/>']]</parameter>
                    <parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="ADD_CONDITION_VALUE"/>
                    <parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="MATCH_CONDITION_VALUE"/>
                </parameters>
            </executeBlock>
        </block>
        
		<block name="FIND_CONDITION">
            <IfThenElse>
                <if>
                    <!-- column 'Condition - Type' and 'Operator'  prepare data only one column -->
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_3" columnName="Condition - Type"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_3" columnName="Operator"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <error message="Please prepare data only one column for this setup"/>
                </then>
                <else>
                    <IfThenElse>
                        <if>
                            <findElement highlightTurnedOff="true" by="xpath">//*[text()='Conditions']/../../../../../../..//div[text()='No data to display.']</findElement>
                        </if>
                        <then>
                            <executeBlock name="ADD_CONDITION"/>
                        </then>
                        <else>
                            <IfThenElse>
                                <if>
                                    <!-- column 'Condition - Type' not blank -->
                                    <comparisons separator="AND">
                                    <comparison operator="NOT_EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Type"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    <comparison operator="EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                </if>
                                <then>
                                    <!--Add Condition -->
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">
                                    <comparison operator="NOT_EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition1"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    <comparison operator="NOT_EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition2"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <!-- Lookup 2 Value -->
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    isDisplayed="true"
                                    by="xpath" highlightTurnedOff="true">//table[@summary='Conditions']/../..//div[contains(@id,'scroller')]</findElement>
                                    </if>
                                    <then>
                                    <executeBlock
                                    name="SCROLLBAR_DOWN" isRepeatUntilBreak="true"/>
                                    </then>
                                    <else/>
                                    </IfThenElse>
                                    <findElement
                                    by="xpath">//table[@summary='Conditions']//tr//span[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3"
                                    columnName="Parent - Condition2"/>']/preceding::tr[1]//span[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition1"/>']</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <executeBlock name="ADD_CONDITION"/>
                                    <pause durationInSecs="2"/>
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">
                                    <comparison operator="EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Condition"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Below</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Below']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_BELOW"/>
                                    </then>
                                    <else>
                                    <error message="Cannot as Below this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Condition"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Above</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Above']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_ABOVE"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Above this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='As Child']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_CHILD"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Child this data"/>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <!-- Lookup 1 Value -->
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">
                                    <comparison operator="NOT_EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition1"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    <comparison operator="EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition2"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <!-- Lookup 1 Value -->
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    isDisplayed="true"
                                    by="xpath" highlightTurnedOff="true">//table[@summary='Conditions']/../..//div[contains(@id,'scroller')]</findElement>
                                    </if>
                                    <then>

                                    <executeBlock
                                    name="SCROLLBAR_DOWN" isRepeatUntilBreak="true"/>
                                    </then>
                                    <else/>
                                    </IfThenElse>
                                    <findElement
                                    by="xpath">//table[@summary='Conditions']//tr[td//span[2][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition1"/>']  and td//span[1]/span]//td[1]</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <executeBlock name="ADD_CONDITION"/>
                                    <pause durationInSecs="2"/>
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Condition"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Below</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Below']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_BELOW"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Below this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Condition"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Above</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Above']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_ABOVE"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Above this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='As Child']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_CHILD"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Child this data"/>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <error message="Please prepare data 'Parent - Condition' navigate cannot choose Line,            If input first line don't need to input column 'Parent - Condition'"/>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                </then>
                                <else>
                                    <!-- Add Operator -->
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">
                                    <comparison operator="EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Condition - Type"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    <comparison operator="NOT_EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">
                                    <comparison operator="NOT_EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition1"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    <comparison operator="NOT_EQUAL">
                                    <leftOperand>
                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition2"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <!-- Lookup 2 Value -->
                                    <IfThenElse>
                                    <if>
                                    <findElement
                                    isDisplayed="true"
                                    by="xpath" highlightTurnedOff="true">//table[@summary='Conditions']/../..//div[contains(@id,'scroller')]</findElement>
                                    </if>
                                    <then>

                                    <executeBlock
                                    name="SCROLLBAR_DOWN" isRepeatUntilBreak="true"/>
                                    </then>
                                    <else/>
                                    </IfThenElse>
                                    <findElement
                                    by="xpath">//table[@summary='Conditions']//tr//span[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3"
                                    columnName="Parent - Condition2"/>']/preceding::tr[1]//span[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition1"/>']</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    <executeBlock name="ADD_OPERATOR"/>
                                    <pause durationInSecs="2"/>
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>As Parent</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='As Parent']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_PARENT"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as parent this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>As Child</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='As Child']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_CHILD"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Child this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Above</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Above']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_ABOVE"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Above this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Below</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Below']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_BELOW"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Below this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else/>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>AND</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then/>
                                    <else>
										<executeBlock name="SELECT_KB">
											<parameters>
												<parameter name="XPATH" value="//div[text()='Add Operator']/../../../../../../..//label[text()='Operator']/../.."/>
												<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
												<parameter name="COL_NAME" value="Operator"/>
											</parameters>
										</executeBlock>	
                                    </else>
                                    </IfThenElse>
                                    <findElement by="xpath">//div[text()='Add Operator']/../../../../../../..//span[text()='K']/..</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    </then>
                                    <else>
                                    <!-- Lookup 1 Value -->
                                    <IfThenElse>
                                    <if>
                                    <comparisons separator="AND">

                                    <comparison operator="NOT_EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition1"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition2"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText/>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    isDisplayed="true"
                                    by="xpath" highlightTurnedOff="true">//table[@summary='Conditions']/../..//div[contains(@id,'scroller')]</findElement>
                                    </if>
                                    <then>

                                    <executeBlock
                                    name="SCROLLBAR_DOWN" isRepeatUntilBreak="true"/>
                                    </then>
                                    <else/>
                                    </IfThenElse>
                                    <findElement
                                    by="xpath">//table[@summary='Conditions']//tr[td//span[2][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Parent - Condition1"/>']  and td//span[1]/span]//td[1]</findElement>
                                    <click waitForPageToFinishRendering="true"/>

                                    <executeBlock name="ADD_OPERATOR"/>
                                    <pause durationInSecs="2"/>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>As Parent</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='As Parent']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_PARENT"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as parent this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>As Child</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='As Child']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_CHILD"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Child this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Above</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Above']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_ABOVE"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Above this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Add - Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>Below</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then>
                                    <IfThenElse>
                                    <if>

                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//div[contains(@id,'window')]/div/div/div/table/tbody/tr/td/table/tbody/tr/td/div/table/tbody/tr/td[text()='Below']</findElement>
                                    </if>
                                    <then>

                                    <executeBlock name="AS_BELOW"/>
                                    </then>
                                    <else>

                                    <error message="Cannot as Below this data"/>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else/>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    <IfThenElse>
                                    <if>

                                    <comparisons separator="AND">

                                    <comparison operator="EQUAL">
                                    <leftOperand>

                                    <valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Operator"/>
                                    </leftOperand>
                                    <rightOperand>
                                    <valueText>AND</valueText>
                                    </rightOperand>
                                    </comparison>
                                    </comparisons>
                                    </if>
                                    <then/>
                                    <else>
										<executeBlock name="SELECT_KB">
											<parameters>
												<parameter name="XPATH" value="//div[text()='Add Operator']/../../../../../../..//label[text()='Operator']/../.."/>
												<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
												<parameter name="COL_NAME" value="Operator"/>
											</parameters>
										</executeBlock>	
                                 
                                    </else>
                                    </IfThenElse>
                                    <findElement by="xpath">//div[text()='Add Operator']/../../../../../../..//span[text()='K']/..</findElement>
                                    <click waitForPageToFinishRendering="true"/>
                                    </then>
                                    <else>
                                    <!--<error message="Please prepare data 'Parent - Condition' navigate cannot choose Line,              If input first line don't need to input column 'Parent - Condition'"/>-->
                                    </else>
                                    </IfThenElse>
                                    </else>
                                    </IfThenElse>
                                    </then>
                                    <else>
                                    <error message="Please prepare data order by sequence in application"/>
                                    </else>
                                    </IfThenElse>
                                </else>
                            </IfThenElse>
                        </else>
                    </IfThenElse>
                </else>
            </IfThenElse>
        </block>
        <!-- ACTION -->
        <block name="WORKER_LOV_ACTION">
            <pause durationInSecs="1"/>
            <findElement by="xpath">//div[contains(text(),'Action')]/../../../../../../..//label[text()='Worker']/../..//a[@title='Search: Worker']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <pause durationInSecs="1"/>
            <!--INPUT-->
            <findElement by="xpath">//div[text()='Search and Select: Worker']/../../../../../../..//label[text()='Name']/../..//input</findElement>
            <sendKeys isClear="true" isENTERKey="true" waitForPageToFinishRendering="true">
                <valueKB inventoryName="MAIN_REPEAT_5" columnName="Worker"/>
            </sendKeys>
            <!--SEARCH-->
            <findElement by="xpath">//div[text()='Search and Select: Worker']/../../../../../../..//label[text()='Name']/../../../../../../../../../..//button[text()='Search']</findElement>
            <click waitForPageToFinishRendering="true"/>
            <!--LOOKUP-->
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true"
                        isDisplayed="true"
                            by="xpath">//div[text()='Search and Select: Worker']/../../../../../../..//td[text()='<valueKB
                            inventoryName="MAIN_REPEAT_5" columnName="Worker"/>']</findElement>
                </if>
                <then>
                    <findElement
                            by="xpath">//div[text()='Search and Select: Worker']/../../../../../../..//td[text()='<valueKB
                            inventoryName="MAIN_REPEAT_5" columnName="Worker"/>']</findElement>
                </then>
                <else>
                    <error message="This data does not exist"/>
                </else>
            </IfThenElse>
            <click waitForPageToFinishRendering="true"/>
            <!--OK-->
            <findElement by="xpath">//div[text()='Search and Select: Worker']/../../../../../../..//label[text()='Name']/../../../../../../../../../../../../../../../../../../../..//button[text()='OK']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="ADD_ACTION">
            <findElement by="xpath">//button[text()='Add Action']</findElement>
            <click waitForPageToFinishRendering="true"/>
        </block>
        <block name="ACTION_OK">
            <IfThenElse>
                <if>
                    <findElement isDisplayed="true" by="xpath">//div[contains(text(),'Action')]/../../../../../../..//span[text()='K']/..</findElement>
                </if>
                <then>
                    <findElement by="xpath">//div[contains(text(),'Action')]/../../../../../../..//span[text()='K']/..</findElement>
                    <click waitForPageToFinishRendering="true"/>
					<pause durationInSecs="1"/>
                </then>
                <else>
					<IfThenElse>
						<if>
							<findElement isDisplayed="true" by="xpath">//div[contains(text(),'Action')]/../../../../../../..//button[text()='OK']</findElement>
						</if>
						<then>
							<findElement by="xpath">//div[contains(text(),'Action')]/../../../../../../..//button[text()='OK']</findElement>
							<click waitForPageToFinishRendering="true"/>
							<pause durationInSecs="1"/>
						</then>
						<else>
							<findElement by="xpath">//div[contains(text(),'Action')]/../../../../../../..//*[text()='OK']</findElement>
							<click waitForPageToFinishRendering="true"/>
							<pause durationInSecs="1"/>
						</else>
					</IfThenElse>
                </else>
            </IfThenElse>
        </block>
        <block name="ACTION">
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//div[contains(text(),'Action')]/../../../../../../..//label[text()='Action Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="Action Type"/>
				</parameters>
			</executeBlock>	
          
            <!--Set Outcome To-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//div[contains(text(),'Action')]/../../../../../../..//label[text()='Set Outcome To']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="Set Outcome To"/>
				</parameters>
			</executeBlock>
            <!--Route Using-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//div[contains(text(),'Action')]/../../../../../../..//label[text()='Route Using']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="Route Using"/>
				</parameters>
			</executeBlock>
            <!--Approval Group-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//div[contains(text(),'Action')]/../../../../../../..//label[text()='Approval Group']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="Approval Group"/>
				</parameters>
			</executeBlock>
            <!--Automatically approve if group returns no approvers-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//div[contains(text(),'Action')]/../../../../../../..//label[text()='Automatically approve if group returns no approvers']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="Automatically approve if group returns no approvers"/>
				</parameters>
			</executeBlock>
            <!--User Type-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//div[contains(text(),'Action')]/../../../../../../..//label[text()='User Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="User Type"/>
				</parameters>
			</executeBlock>
            <!--Worker-->
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_5" columnName="Worker"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <IfThenElse>
                        <if>
                            <findElement highlightTurnedOff="true"
                                isDisplayed="true" by="xpath">//div[contains(text(),'Action')]/../../../../../../..//label[text()='Worker']</findElement>
                        </if>
                        <then>
                            <executeBlock name="WORKER_LOV_ACTION"/>
                        </then>
                        <else>
                            <error message="The field 'Worker' doesn't exist."/>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="FIND_ACTION">
            <executeBlock name="ADD_ACTION"/>
        </block>
        <block name="COLLAPSE_PANE">
            <IfThenElse>
                <if>
                    <findElement highlightTurnedOff="true" by="xpath">//a//img[@title='Collapse Pane']</findElement>
                </if>
                <then>
                    <findElement by="xpath">//a//img[@title='Collapse Pane']</findElement>
                    <click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <block name="INFORMATION">
            <!-- Information -->
            <IfThenElse>
                <if>
                    <findElement isDisplayed="true" by="xpath">//div[text()='Information']</findElement>
                </if>
                <then>
                    <findElement by="xpath">//div[text()='Information']/../../../../../../..//span[text()='Y']/..</findElement>
                    <click waitForPageToFinishRendering="true"/>
                </then>
                <else/>
            </IfThenElse>
            <!-- Confirmation -->
            <IfThenElse>
                <if>
                    <findElement isDisplayed="true" by="xpath">//div[text()='Confirmation']</findElement>
                </if>
                <then>
                    <findElement by="xpath">//div[text()='Confirmation']/../../../../../../../../..//span[text()='K']/..</findElement>
                    <click waitForPageToFinishRendering="true"/>
                </then>
                <else/>
            </IfThenElse>
        </block>
        <executeBlock name="GLOBAL_GO_TO_TASK"/>
        <executeBlock name="INFORMATION"/>
        <executeBlock name="COLLAPSE_PANE"/>
        <repeat inventoryName="MAIN_REPEAT_1">
            <executeBlock name="FIND_APPROVAL"/>
            <repeat inventoryName="MAIN_REPEAT_2">
                <executeBlock name="FIND_RULES"/>
                <executeBlock name="RULES"/>
                <executeBlock name="RULE_OK"/>
                <IfThenElse>
                    <if>
                        <findElement isDisplayed="true" by="xpath">//*[text()='Conditions']/../../../../../../..//div[text()='Rule always applies']</findElement>
                    </if>
                    <then/>
                    <else>
                        <repeat inventoryName="MAIN_REPEAT_3">
                            <executeBlock name="FIND_CONDITION"/>
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true"
                                    isDisplayed="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..</findElement>
                                </if>
                                <then>
                                    <executeBlock name="CONDITION"/>
                                    <repeat inventoryName="MAIN_REPEAT_4">
                                    <executeBlock name="FIND_CONDITION_VALUE"/>
                                    </repeat>
                                </then>
                                <else/>
                            </IfThenElse>
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true"
                                    isDisplayed="true" by="xpath">//div[contains(text(),'Condition')]/../..//div[@style='display:none']/../../../../../../..//span[text()='K']/..</findElement>
                                </if>
                                <then>
                                    <executeBlock name="OK_CONDITION"/>
                                </then>
                                <else/>
                            </IfThenElse>
                        </repeat>
                    </else>
                </IfThenElse>
                <repeat inventoryName="MAIN_REPEAT_5">
                    <executeBlock name="FIND_ACTION"/>
                    <executeBlock name="ACTION"/>
                    <executeBlock name="ACTION_OK"/>
                </repeat>
                <executeBlock name="RULE_ENABLE_DISABLE"/>
                <executeBlock name="SAVE"/>
            </repeat>
            <executeBlock name="SAVE_AND_CLOSE"/>
            <executeBlock name="ERROR_AFTER_SAVE"/>
            <executeBlock name="APPROVAL_RULE_ENABLE_DISABLE"/>
        </repeat>
    </fusionNavigation>
</navigation>
