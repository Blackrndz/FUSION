<?xml version="1.0"?>
<navigation xmlns="http://navigation0005.configurator.erapidsuite.com" xmlns:xsd="http://xsdutility.configurator.erapidsuite.com">
	<name>Manage Legal Entity Contacts (Contact Points)</name>
	<svn>
		<revision xmlns="http://xsdutility.configurator.erapidsuite.com">$Revision: $:</revision>
		<author xmlns="http://xsdutility.configurator.erapidsuite.com">$Author: $:</author>
		<date xmlns="http://xsdutility.configurator.erapidsuite.com">$Date: $:</date>
		<headURL xmlns="http://xsdutility.configurator.erapidsuite.com">$HeadURL: $:</headURL>
		<id xmlns="http://xsdutility.configurator.erapidsuite.com">$Id: $:</id>
	</svn>
	<description/>
	<type>FUSION</type>
	<engine_type>SELENIUM</engine_type>
	<modules/>
	<mapper_use_type>UNDEFINED</mapper_use_type>
	<validate_parent_child_relationships_for_mapped_data>true</validate_parent_child_relationships_for_mapped_data>
	<fusionNavigation hasScope="false" isIgnoreTaskSearchNavigation="true" isBatchingBasedOnRootInventoryUniqueRecords="true" taskName="Manage Legal Entity" isBatchingAllowed="true" applicationKey="APPLICATION_HOME_PAGE">
		<dependencies>
			<navigation name="Manage Administrator Profile Values"/>
			<navigation name="Manage Legal Entity Contacts"/>
		</dependencies>
		<parameters>
			<parameter name="MAIN_REPEAT_1" value="Manage Legal Entity Contacts - Contacts"/>
			<parameter name="MAIN_REPEAT_2" value="Manage Legal Entity Contacts - Contact Points"/>
			<parameter name="MAIN_REPEAT_3" value="Manage Legal Entity Contacts - Contact Point Preferences"/>
		</parameters>	
		<block name="MAPPER_POINT">
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_REPEAT_1" columnName="Legal Entity Name"/>']</findElement>	
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_REPEAT_2" columnName="Legal Entity Name"/>']</findElement>
			<findElement by="xpath">//label[text()='<valueKB inventoryName="MAIN_REPEAT_3" columnName="Legal Entity Name"/>']</findElement>
		</block>		
		<block name="MANUAL_SEARCH_TASK">
			<IfThenElse>
				<if>
					<findElement isSkipCheckDomError="true" highlightTurnedOff="true" by="xpath" setFocus="true">//*[text()='Functional Areas']</findElement>
				</if>
				<then>			
					<pause durationInSecs="1"/>
				</then>
				<else>
					<findElement by="xpath" isSkipCheckDomError="true">//a[contains(text(),'Setup and Maintenance')]</findElement>
					<click waitForPageToFinishRendering="false" isSkipCheckDomError="true" isSkipBrowserTitleChange="true" />
					<pause durationInSecs="1"/>
				</else>
			</IfThenElse>	

			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//*[text()='Setup: Financials']/..</findElement>
				</if>
				<then>
					
				</then>
				<else>
					<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath" setFocus="true">(//*[contains(text(),'Setup:')]/../../..//a)[1]</findElement>
					<click waitForPageToFinishRendering="true" isJavaScript="true" isSkipCheckDomError="true"/>	
					<pause durationInSecs="2"/>						
					<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//*[text()="Financials"]</findElement>
					<click waitForPageToFinishRendering="true" isJavaScript="true" isSkipCheckDomError="true"/>		
					<pause durationInSecs="2"/>			
				</else>
			</IfThenElse>			

			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//*[text()='###TASK_NAME###']/../../td[(string(//span[text()='Scope']/../../@_d_index))+1]/a</findElement>
				</if>
				<then>
				</then>
				<else>
					<findElement by="xpath" isSkipCheckDomError="true">//*[text()='Search Tasks']/../..//input</findElement>
					<sendKeys isClear="true" waitForPageToFinishRendering="true" isSkipCheckDomError="true">
						<valueText>###TASK_NAME###</valueText>
					</sendKeys>		
					<pause durationInSecs="2"/>			
					<findElement by="xpath" isSkipCheckDomError="true">//*[text()='Search Tasks']/../../../../../..//a</findElement>
					<click waitForPageToFinishRendering="false" isSkipCheckDomError="true" isSkipBrowserTitleChange="true" />				
					<pause durationInSecs="2"/>		
					<findElement by="xpath">//*[text()='Search Task Results']/../../../../../../..//a[text()='###TASK_NAME###']</findElement>
					<click waitForPageToFinishRendering="true"/>	
					<pause durationInSecs="2"/>										
				</else>
			</IfThenElse>
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//a[text()='###TASK_NAME###']</findElement>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//*[text()='###TASK_NAME###']/../../td[(string(//span[text()='Scope']/../../@_d_index))+1]/a</findElement>
						</if>
						<then>
							<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//*[text()='###TASK_NAME###']/../../td[(string(//span[text()='Scope']/../../@_d_index))+1]/a</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>				
						</then>
						<else>
						</else>
					</IfThenElse>			
				</then>
				<else>
					<error message="The task doesn't exist."/>
				</else>
			</IfThenElse>
			<IfThenElse>
				<if>
					<findElement by="xpath">//div[text()='Select Scope']</findElement>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement by="xpath">//label[text()='Legal Entity']/../..//select</findElement>
						</if>
						<then>
							<findElement by="xpath">//label[text()='Legal Entity']/../..//select</findElement>
							<select by="selectByVisibleText" isPageLoadingOnSelectValue="true">
								<valueText>Select and Add</valueText>
							</select>								
						</then>
						<else>
							<findElement by="xpath">//label[text()='Legal Entity']/../..//input/..//div//li[text()='Select and Add']</findElement>
							<click waitForPageToFinishRendering="true" isJavaScript="true" />
						</else>
					</IfThenElse>
					<findElement by="xpath">//div[text()='Select Scope']/../../../../../../..//button[text()='Apply and Go to Task']</findElement>
					<click waitForPageToFinishRendering="true"/>								
				</then>
				<else>
				</else>
			</IfThenElse>				
		</block>		
		<block name="SEARCH_LE_NAME">
			<!-- Search Name -->
			<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_EXPAND">
				<parameters>
					<parameter name="XPATH" value="//*[text()='Search']/../../.."/>
				</parameters>
			</executeBlock>			
			<!-- Name -->
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Name']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
					<parameter name="COL_NAME" value="Legal Entity Name"/>
				</parameters>
			</executeBlock>	
			<IfThenElse>
				<if>
					<findElement by="xpath">//label[text()='Legal Entity Identifier']/../..//input</findElement>
				</if>
				<then>
					<!-- Legal Entity Identifier -->
					<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Legal Entity Identifier']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
							<parameter name="COL_NAME" value="Legal Entity Identifier"/>
						</parameters>
					</executeBlock>	
				</then>
				<else>
					<findElement by="xpath">//*[text()='Search']/../../..//*[text()='d']/..</findElement>
					<click waitForPageToFinishRendering="true"/>				
					<!-- Legal Entity Identifier -->
					<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Legal Entity Identifier']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
							<parameter name="COL_NAME" value="Legal Entity Identifier"/>
						</parameters>
					</executeBlock>	
				</else>
			</IfThenElse>

			<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_EXPAND">
				<parameters>
					<parameter name="XPATH" value="//*[text()='Search']/../../.."/>
				</parameters>
			</executeBlock>		
			<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_BUTTON">
				<parameters>
					<parameter name="XPATH" value="//*[text()='Search']/../../.."/>
					<parameter name="BUTTON_NAME" value="Search"/>
				</parameters>
			</executeBlock>				

			<IfThenElse>
				<if>
					<findElement by="xpath">//tr[td//a[text()='<valueKB inventoryName="MAIN_REPEAT_1" columnName="Legal Entity Name"/>'] and td[text()='<valueKB inventoryName="MAIN_REPEAT_1" columnName="Legal Entity Identifier"/>']]</findElement>
				</if>
				<then>
					<findElement by="xpath">//tr[td//a[text()='<valueKB inventoryName="MAIN_REPEAT_1" columnName="Legal Entity Name"/>'] and td[text()='<valueKB inventoryName="MAIN_REPEAT_1" columnName="Legal Entity Identifier"/>']]//a</findElement>
					<click waitForPageToFinishRendering="true"/>
					<pause durationInSecs="3"/>
					<findElement by="xpath">//table[@summary='Search Results']/../../../..//*[@title='Manage Contact']</findElement>
					<click waitForPageToFinishRendering="true"/>	
					<pause durationInSecs="3"/>					
				</then>
				<else>
					<error message= "Please Define Data Manage Legal Entity Before Define Contacts"/>
				</else>
			</IfThenElse>
		</block>		

		<block name="SKIP_LEGAL_CONTACT"/>
		<block name="SELECT_LEGAL_CONTACT">
			<findElement by="xpath" isSkipCheckDomError="true">TEMPLATE_1_FIND_ROW</findElement>
			<click waitForPageToFinishRendering="false" isSkipCheckDomError="true" isSkipBrowserTitleChange="true" />	
			<pause durationInSecs="3"/>			
		</block>	
		<block name="CONFIRMATION_CONTACT">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//div[text()='Confirmation']/../../../../../../..//*[text()='OK']</findElement>
				</if>
				<then>
					<findElement by="xpath" isSkipCheckDomError="true">//div[text()='Confirmation']/../../../../../../..//*[text()='OK']</findElement>
					<click waitForPageToFinishRendering="false" isSkipCheckDomError="true" isSkipBrowserTitleChange="true" />				
					<pause durationInSecs="2"/>					
				</then>
				<else>									
				</else>
			</IfThenElse>		
		</block>		
		<block name="STEP_FIRST_CONTACT">
			<executeBlock name="SEARCH_LE_NAME"/>
		</block>	
		<block name="STEP_END_CONTACT">		
			<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_SAVE"/>
			<executeBlock name="CONFIRMATION_CONTACT"/>
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//*[contains(text(),'<valueKB inventoryName="MAIN_REPEAT_1" columnName="Legal Entity Name"/>')]/..</findElement>
				</if>
				<then>			
					<pause durationInSecs="2"/>					
				</then>
				<else>	
					<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_SAVE_AND_CLOSE"/>
					<executeBlock name="CONFIRMATION_CONTACT"/>
				</else>
			</IfThenElse>		
		</block>
        <block name="SEARCH_CONTACT_POINTS">
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Contact Point Type"/>
				</parameters>
			</executeBlock>	            
			<IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Value"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText></valueText>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="MAIN_REPEAT_2" columnName="Contact Point Type"/>
									</leftOperand>
									<rightOperand>
										<valueText>Phone</valueText>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="Concat_Phone"/>
						</then>
						<else/>
					</IfThenElse>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="MAIN_REPEAT_2" columnName="Contact Point Type"/>
									</leftOperand>
									<rightOperand>
										<valueText>E-mail</valueText>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="Concat_E-mail"/>
						</then>
						<else/>
					</IfThenElse>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="MAIN_REPEAT_2" columnName="Contact Point Type"/>
									</leftOperand>
									<rightOperand>
										<valueText>Social network</valueText>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="Concat_Social_network"/>
						</then>
						<else/>
					</IfThenElse>
					<IfThenElse>
						<if>
							<comparisons separator="AND">
								<comparison operator="EQUAL">
									<leftOperand>
										<valueKB inventoryName="MAIN_REPEAT_2" columnName="Contact Point Type"/>
									</leftOperand>
									<rightOperand>
										<valueText>Web</valueText>
									</rightOperand>
								</comparison>
							</comparisons>
						</if>
						<then>
							<executeBlock name="Concat_Web"/>
						</then>
						<else/>
					</IfThenElse>                    
                </then>
                <else>
					<executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
						<parameters>
							<parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
							<parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
							<parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
							<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Contact Points']//*[text()='<valueKB inventoryName="MAIN_REPEAT_2" columnName="Value"/>']</parameter>
							<parameter name="TEMPLATE_CREATE" value="CREATE_POINTS"/>
							<parameter name="TEMPLATE_UPDATE" value="EDIT_POINTS"/>
						</parameters>
					</executeBlock>					
				</else>
            </IfThenElse>		
        </block>		
        <block name="Concat_Phone">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
				<valueKB inventoryName="MAIN_REPEAT_2" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
				<valueKB inventoryName="MAIN_REPEAT_2" columnName="Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>			
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="MAIN_REPEAT_2" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Phone Country Code"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='+</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="MAIN_REPEAT_2" columnName="Phone Country Code"/>
                    </setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='</setVariable>
                </else>
            </IfThenElse>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Area Code"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <IfThenElse>
                        <if>
                            <comparisons separator="AND">
                                <comparison operator="NOT_EQUAL">
                                    <leftOperand>
										<valueKB inventoryName="MAIN_REPEAT_2" columnName="Phone Country Code"/>
                                    </leftOperand>
                                    <rightOperand>
										<valueText/>
                                    </rightOperand>
                                </comparison>
                            </comparisons>
                        </if>
                        <then>
                            <setVariable name="VALUE_CONTACT" append="true"> (</setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Area Code"/>
                            </setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">)</setVariable>
                        </then>
                        <else>
                            <setVariable name="VALUE_CONTACT" append="true">(</setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Area Code"/>
                            </setVariable>
                            <setVariable name="VALUE_CONTACT" append="true">)</setVariable>
                        </else>
                    </IfThenElse>
                </then>
                <else/>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Phone"/>
            </setVariable>
		
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Extension"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> x</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="MAIN_REPEAT_2" columnName="Extension"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
                </else>
            </IfThenElse>
            <executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
                <parameters>
                    <parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="TEMPLATE_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="TEMPLATE_CREATE" value="CREATE_POINTS"/>
                    <parameter name="TEMPLATE_UPDATE" value="EDIT_POINTS"/>
                </parameters>
            </executeBlock>
        </block>

        <block name="Concat_E-mail">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
			<setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr</setVariable>
			<setVariable name="VALUE_CONTACT" append="true">//td[7]//a[text()='</setVariable>
			<setVariable name="VALUE_CONTACT" append="true">
				<valueKB inventoryName="MAIN_REPEAT_2" columnName="E-Mail"/>
			</setVariable>
			<setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
                <parameters>
                    <parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="TEMPLATE_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="TEMPLATE_CREATE" value="CREATE_POINTS"/>
                    <parameter name="TEMPLATE_UPDATE" value="EDIT_POINTS"/>
                </parameters>
            </executeBlock>
        </block>

        <block name="Concat_Social_network">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Social Network"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="MAIN_REPEAT_2" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true"> and td[7][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="MAIN_REPEAT_2" columnName="User ID"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true"> - </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Social Network"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']]</setVariable>
            <executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
                <parameters>
                    <parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="TEMPLATE_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="TEMPLATE_CREATE" value="CREATE_POINTS"/>
                    <parameter name="TEMPLATE_UPDATE" value="EDIT_POINTS"/>
                </parameters>
            </executeBlock>
        </block>

        <block name="Concat_Web">
            <defineVariable name="VALUE_CONTACT" type="text"/>
            <setVariable name="VALUE_CONTACT" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">//table[@summary='Contact Points']//tr[td[5][text()='</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Contact Point Type"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_2" columnName="Purpose"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[text()='</setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">
                        <valueKB inventoryName="MAIN_REPEAT_2" columnName="Purpose"/>
                    </setVariable>
                    <setVariable name="VALUE_CONTACT" append="true">']</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_CONTACT" append="true"> and td[6]//span[not(string())]</setVariable>
                </else>
            </IfThenElse>
            <setVariable name="VALUE_CONTACT" append="true"> and td[7][contains(text(),'</setVariable>
            <setVariable name="VALUE_CONTACT" append="true">
                <valueKB inventoryName="MAIN_REPEAT_2" columnName="URL"/>
            </setVariable>
            <setVariable name="VALUE_CONTACT" append="true">')]]</setVariable>
            <executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
                <parameters>
                    <parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Contact Points']/../..//div[contains(text(),'No data to display.')]"/>
                    <parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Contact Points'][@_rowcount]//tr[1]//td)[1]"/>
                    <parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Contact Points']/../..//div[contains(@id,'scroller')]"/>
                    <parameter name="TEMPLATE_1_FIND_ROW">
                        <valueVariable name="VALUE_CONTACT"/>
                    </parameter>
                    <parameter name="TEMPLATE_CREATE" value="CREATE_POINTS"/>
                    <parameter name="TEMPLATE_UPDATE" value="EDIT_POINTS"/>
                </parameters>
            </executeBlock>
        </block>

		<block name="CONTACT_POINT_DETAILS">
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Contact Point Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Contact Point Type"/>
				</parameters>
			</executeBlock>	
			<pause durationInSecs="2"/>	
			
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Phone']/../..</findElement>
				</if>
				<then>
					<executeBlock name="TYPE_PHONE"/>
				</then>
				<else/>
			</IfThenElse>			
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Email']/../..</findElement>
				</if>
				<then>
					<executeBlock name="TYPE_EMAIL"/>
				</then>
				<else/>
			</IfThenElse>
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Social Network']/../..</findElement>
				</if>
				<then>
					<executeBlock name="TYPE_SOCIAL_NETWORK"/>
				</then>
				<else/>
			</IfThenElse>
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" by="xpath">//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='URL']/../..</findElement>
				</if>
				<then>
					<executeBlock name="TYPE_WEB"/>
				</then>
				<else/>
			</IfThenElse>			
			
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='From Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="From Date"/>
				</parameters>
			</executeBlock>	
			
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='To Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="To Date"/>
				</parameters>
			</executeBlock>						

			<findElement by="xpath">//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//*[text()='K']/..</findElement>
			<click waitForPageToFinishRendering="true"/>
			<pause durationInSecs="2"/>	
		</block>
		<block name="TYPE_PHONE">
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Type"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Purpose']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Purpose"/>
				</parameters>
			</executeBlock>			
			<executeBlock navigationName="TemplateLOV" name="TEMPLATE_LOV">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Phone Country Code']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Phone Country Code"/>
					<parameter name="SEARCH_1" value="Phone Country Code"/>
				</parameters>
			</executeBlock>		
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Area Code']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Area Code"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Phone']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Phone"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Extension']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Extension"/>
				</parameters>
			</executeBlock>				
		</block>
		<block name="TYPE_EMAIL">
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Purpose']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Purpose"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Email Format']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="E-Mail Format"/>
				</parameters>
			</executeBlock>			
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Email']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="E-Mail"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="TYPE_SOCIAL_NETWORK">
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Purpose']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Purpose"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Social Network']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Social Network"/>
				</parameters>
			</executeBlock>			
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='User ID']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="User ID"/>
				</parameters>
			</executeBlock>
		</block>
		<block name="TYPE_WEB">
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Purpose']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Purpose"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='Protocol']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="Protocol"/>
				</parameters>
			</executeBlock>			
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//div[text()='Create Contact Point' or text()='Edit Contact Point']/../../../../../../..//label[text()='URL']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
					<parameter name="COL_NAME" value="URL"/>
				</parameters>
			</executeBlock>
		</block>		
		<block name="CREATE_POINTS">
			<executeBlock navigationName="TemplateCREATE_UPDATE" name="TEMPLATE_SPECIFY_CREATE">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Contact Points']/../../../.."/>
				</parameters>
			</executeBlock>
		</block>
		<block name="EDIT_POINTS">
			<findElement by="xpath" isSkipCheckDomError="true">TEMPLATE_1_FIND_ROW</findElement>
			<click waitForPageToFinishRendering="false" isSkipCheckDomError="true" isSkipBrowserTitleChange="true" />
			<pause durationInSecs="2"/>	
			<executeBlock navigationName="TemplateCREATE_UPDATE" name="TEMPLATE_SPECIFY_UPDATE">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Contact Points']/../../../.."/>
				</parameters>
			</executeBlock>
		</block>
		<block name="MANAGE_PREFERENCE">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isDisplayed="true" isSkipCheckDomError="true" by="xpath">//table[@summary='Contact Points']/../../../..//a[text()='Actions']</findElement>
				</if>
				<then>
					<findElement isSkipCheckDomError="true" by="xpath">//table[@summary='Contact Points']/../../../..//a[text()='Actions']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>  
					<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//td[text()='Manage Contact Preferences']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>     					
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" isDisplayed="true" isSkipCheckDomError="true" by="xpath">//table[@summary='Contact Points']/../../../..//a[text()='Actions']/../../../../../../../../../../../..</findElement>
						</if>
						<then>
							<findElement isSkipCheckDomError="true" by="xpath">//table[@summary='Contact Points']/../../../..//a[text()='Actions']/../../../../../../../../../../../..</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>  
							<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//a[text()='Actions']</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>														
							<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//td[text()='Manage Contact Preferences']</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>				
						</then>
						<else>
						</else>
					</IfThenElse>						
				</else>
			</IfThenElse>			
		</block>		
		<block name="SEARCH_PREFERENCE">
            <defineVariable name="VALUE_PREFERENCE" type="text"/>
            <setVariable name="VALUE_PREFERENCE" append="false">
                <valueText/>
            </setVariable>
            <setVariable name="VALUE_PREFERENCE" append="true">//table[@summary='Manage Contact Preferences']//tr[td[1]//*[@value='</setVariable>
            <setVariable name="VALUE_PREFERENCE" append="true">
                <valueKB inventoryName="MAIN_REPEAT_3" columnName="From Date"/>
            </setVariable>
            <setVariable name="VALUE_PREFERENCE" append="true">']</setVariable>
            <IfThenElse>
                <if>
                    <comparisons separator="AND">
                        <comparison operator="NOT_EQUAL">
                            <leftOperand>
                                <valueKB inventoryName="MAIN_REPEAT_3" columnName="To Date"/>
                            </leftOperand>
                            <rightOperand>
                                <valueText/>
                            </rightOperand>
                        </comparison>
                    </comparisons>
                </if>
                <then>
                    <setVariable name="VALUE_PREFERENCE" append="true"> and td[2]//*[@value='</setVariable>
                    <setVariable name="VALUE_PREFERENCE" append="true">
                        <valueKB inventoryName="MAIN_REPEAT_3" columnName="To Date"/>
                    </setVariable>
                    <setVariable name="VALUE_PREFERENCE" append="true">'] ]</setVariable>
                </then>
                <else>
                    <setVariable name="VALUE_PREFERENCE" append="true">and td[2]//*[not(@value)] ]</setVariable>
                </else>
            </IfThenElse>
            <setVariable name="VALUE_PREFERENCE" append="true">/../../../../../td[1]</setVariable>		
			
			<executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
				<parameters>
					<parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Manage Contact Preferences']/../..//div[contains(text(),'No data to display.')]"/>
					<parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Manage Contact Preferences'][@_rowcount]//tr[1]//td)[1]"/>
					<parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Manage Contact Preferences']/../..//div[contains(@id,'scroller')]"/>
					<parameter name="TEMPLATE_1_FIND_ROW"><valueVariable name="VALUE_PREFERENCE"/></parameter>
					<parameter name="TEMPLATE_CREATE" value="CREATE_PREFERENCE"/>
					<parameter name="TEMPLATE_UPDATE" value="EDIT_PREFERENCE"/>
				</parameters>
			</executeBlock>			
		</block>		

		<block name="CREATE_PREFERENCE">
			<executeBlock navigationName="TemplateCREATE_UPDATE" name="TEMPLATE_SPECIFY_ADD_ROW">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Manage Contact Preferences']/../../../.."/>
				</parameters>
			</executeBlock>
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Manage Contact Preferences']//tr[contains(@class,'Select')]//label[text()='From Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
					<parameter name="COL_NAME" value="From Date"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateINPUT" name="TEMPLATE_INPUT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Manage Contact Preferences']//tr[contains(@class,'Select')]//label[text()='To Date']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
					<parameter name="COL_NAME" value="To Date"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Manage Contact Preferences']//tr[contains(@class,'Select')]//label[text()='Preference']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
					<parameter name="COL_NAME" value="Preference"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Manage Contact Preferences']//tr[contains(@class,'Select')]//label[text()='Reason']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
					<parameter name="COL_NAME" value="Reason"/>
				</parameters>
			</executeBlock>				
		</block>
		<block name="EDIT_PREFERENCE">
			<findElement by="xpath" isSkipCheckDomError="true">TEMPLATE_1_FIND_ROW</findElement>
			<click waitForPageToFinishRendering="false" isSkipCheckDomError="true" isSkipBrowserTitleChange="true" />
			<pause durationInSecs="2"/>	
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Manage Contact Preferences']//tr[contains(@class,'Select')]//label[text()='Preference']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
					<parameter name="COL_NAME" value="Preference"/>
				</parameters>
			</executeBlock>	
			<executeBlock navigationName="TemplateSELECT" name="TEMPATE_SELECT">
				<parameters>
					<parameter name="XPATH" value="//table[@summary='Manage Contact Preferences']//tr[contains(@class,'Select')]//label[text()='Reason']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_3"/>
					<parameter name="COL_NAME" value="Reason"/>
				</parameters>
			</executeBlock>				
		</block>
				
		<executeBlock name="MANUAL_SEARCH_TASK"/>		
		<repeat inventoryName="MAIN_REPEAT_1">
			<executeBlock name="STEP_FIRST_CONTACT"/>	
			
			<executeBlock navigationName="TemplateSCROLLBAR" name="TEMPLATE_SCROLLBAR">
				<parameters>
					<parameter name="TEMPLATE_NO_DATA" value="//table[@summary='Contacts']/../..//div[contains(text(),'No data to display.')]"/>
					<parameter name="TEMPLATE_FIRST_ROW" value="(//table[@summary='Contacts'][@_rowcount]//tr[1]//td)[1]"/>
					<parameter name="TEMPLATE_SCROLLER" value="//table[@summary='Contacts']/../..//div[contains(@id,'scroller')]"/>
					<parameter name="TEMPLATE_1_FIND_ROW">//table[@summary='Contacts']//*[text()='<valueKB inventoryName="MAIN_REPEAT_1" columnName="Contact Number"/>']</parameter>
					<parameter name="TEMPLATE_CREATE" value="SKIP_LEGAL_CONTACT"/>
					<parameter name="TEMPLATE_UPDATE" value="SELECT_LEGAL_CONTACT"/>
				</parameters>
			</executeBlock>	
			<repeat inventoryName="MAIN_REPEAT_2">
				<IfThenElse>
					<if>
						<findElement highlightTurnedOff="true" isDisplayed="true" isSkipCheckDomError="true" by="xpath">//*[text()='Contact Information']/../../../../../../..//div[contains(@class,'Select')]//a[text()='Contact Points']</findElement>
					</if>
					<then/>
					<else>
						<findElement isSkipCheckDomError="true" by="xpath">//*[text()='Contact Information']/../../../../../../..//a[text()='Contact Points']</findElement>
						<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>  
   						<pause durationInSecs="3"/>	
					</else>
				</IfThenElse>			

				<executeBlock name="SEARCH_CONTACT_POINTS"/>
				<executeBlock name="CONTACT_POINT_DETAILS"/>
				<repeat inventoryName="MAIN_REPEAT_3">
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" isDisplayed="true" isSkipCheckDomError="true" by="xpath">//*[text()='Contact Information']/../../../../../../..//div[contains(@class,'Select')]//a[text()='Contact Points']</findElement>
						</if>
						<then/>
						<else>
							<findElement isSkipCheckDomError="true" by="xpath">//*[text()='Contact Information']/../../../../../../..//a[text()='Contact Points']</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>  
							<pause durationInSecs="3"/>	
						</else>
					</IfThenElse>
					<executeBlock name="MANAGE_PREFERENCE"/>
					<executeBlock name="SEARCH_PREFERENCE"/>	
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//div[text()='Manage Contact Preferences']/../../../../../../..//span[text()='K']/..</findElement>
						</if>
						<then>
							<findElement isSkipCheckDomError="true" by="xpath">//div[text()='Manage Contact Preferences']/../../../../../../..//span[text()='K']/..</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>  
							<pause durationInSecs="3"/>							
						</then>
						<else>

						</else>
					</IfThenElse>					
				</repeat>
				<executeBlock navigationName="TemplateUTILITY" name="TEMPLATE_SAVE"/>
				<executeBlock name="CONFIRMATION_CONTACT"/>					
			</repeat>
			<executeBlock name="STEP_END_CONTACT"/>				
		</repeat>
	</fusionNavigation>
</navigation>