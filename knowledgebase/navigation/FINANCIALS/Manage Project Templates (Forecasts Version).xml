<?xml version="1.0"?>
<navigation xmlns="http://navigation0005.configurator.erapidsuite.com" xmlns:xsd="http://xsdutility.configurator.erapidsuite.com">
	<name>Manage Project Templates (Forecasts Version)</name>
	<svn>
		<xsd:revision>$Revision: $:</xsd:revision>
		<xsd:author>$Author: $:</xsd:author>
		<xsd:date>$Date: $:</xsd:date>
		<xsd:headURL>$HeadURL: $:</xsd:headURL>
		<xsd:id>$Id:  $:</xsd:id>
	</svn>
	<description/>
	<type>FUSION</type>
	<engine_type>SELENIUM</engine_type>
	<modules/>
	<mapper_use_type>UNDEFINED</mapper_use_type>
	<validate_parent_child_relationships_for_mapped_data>true</validate_parent_child_relationships_for_mapped_data>
	<fusionNavigation hasScope="false"
        isBatchingBasedOnRootInventoryUniqueRecords="true"
        taskName="Manage Project Templates" isBatchingAllowed="true" applicationKey="APPLICATION_HOME_PAGE">
		<dependencies>
			<navigation name="Manage Financial Plan Types"/>
			<navigation name="Manage Financial Plan Types (Set Assignments)"/>
			<navigation name="Manage Project Templates"/>
		</dependencies>
		<parameters>
			<parameter name="MAIN_REPEAT_0" value="Manage Project Templates - Template Information"/>
			<parameter name="MAIN_REPEAT_1" value="Manage Project Templates - Forecasts Versions"/>
			<parameter name="MAIN_REPEAT_PLAN" value="Manage Project Templates - Forecasts Plan Settings"/>
			<parameter name="MAIN_REPEAT_2" value="Manage Project Templates - Forecasts Currency Settings"/>
			<parameter name="MAIN_REPEAT_3" value="Manage Project Templates - Forecasts Planning Currencies"/>
			<parameter name="MAIN_REPEAT_4" value="Manage Project Templates - Forecasts Rate Settings"/>
			<parameter name="MAIN_REPEAT_5" value="Manage Project Templates - Forecasts Generation Options"/>
			<parameter name="MAIN_REPEAT_6" value="Manage Project Templates - Forecasts Reporting Options"/>
			<parameter name="MAIN_REPEAT_7" value="Manage Project Templates - Forecasts Export Options"/>
			<parameter name="MAIN_REPEAT_8" value="Manage Project Templates - Forecasts - DFF"/>
		</parameters>

		<block name="FAKE_INV">
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_0" columnName="Template Name"/>
			</sendKeys>
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_2" columnName="Template Name"/>
			</sendKeys>
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_PLAN" columnName="Template Name"/>
			</sendKeys>
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_3" columnName="Template Name"/>
			</sendKeys>
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_4" columnName="Template Name"/>
			</sendKeys>
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_5" columnName="Template Name"/>
			</sendKeys>
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_6" columnName="Template Name"/>
			</sendKeys>
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_7" columnName="Template Name"/>
			</sendKeys>
			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true"
                isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_8" columnName="Template Name"/>
			</sendKeys>
		</block>
		<block name="BT_DONE">
			<findElement by="xpath">//a//span[text()='o']/../..</findElement>
			<click waitForPageToFinishRendering="true"/>
		</block>
		<block name="BT_SAVE_AND_CLOSE">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath" isSkipCheckDomError="true">//a[@title='Save']</findElement>
				</if>
				<then>
					<executeBlock name="GLOBAL_SAVE"/>	
					<findElement by="xpath" isSkipCheckDomError="true">//a[@title='Save']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>		
					<findElement by="xpath" isSkipCheckDomError="true">//span[text()='S']/..</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>							
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath" isSkipCheckDomError="true">//span[text()='Save']/../../..//a[not(@onclick)]</findElement>
						</if>
						<then>
							<executeBlock name="GLOBAL_SAVE"/>	
							<findElement by="xpath" isSkipCheckDomError="true">//span[text()='Save']/../../..//a[not(@onclick)]</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>			
							<findElement by="xpath" isSkipCheckDomError="true">//span[text()='S']/..</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>							
						</then>
						<else>
				
						</else>
					</IfThenElse> 		
				</else>
			</IfThenElse>
		</block>
		<block name="Expand_Search_home">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" by="xpath">//a[@title='Expand Search']</findElement>
				</if>
				<then>
					<findElement by="xpath" isSkipCheckDomError="true">//a[@title='Expand Search']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="Project_Templates">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true"
                            by="xpath">//label[text()='Name']/../..//input[@value='<valueKB
                            inventoryName="MAIN_REPEAT_0" columnName="Template Name"/>']</findElement>
				</if>
				<then/>
				<else>
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath" isSkipCheckDomError="true">//a[@title='Save']</findElement>
				</if>
				<then>
					<executeBlock name="GLOBAL_SAVE"/>	
					<findElement by="xpath" isSkipCheckDomError="true">//a[@title='Save']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>		
					<findElement by="xpath" isSkipCheckDomError="true">//span[text()='S']/..</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>							
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath" isSkipCheckDomError="true">//span[text()='Save']/../../..//a[not(@onclick)]</findElement>
						</if>
						<then>
							<executeBlock name="GLOBAL_SAVE"/>	
							<findElement by="xpath" isSkipCheckDomError="true">//span[text()='Save']/../../..//a[not(@onclick)]</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>			
							<findElement by="xpath" isSkipCheckDomError="true">//span[text()='S']/..</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>							
						</then>
						<else>
				
						</else>
					</IfThenElse> 		
				</else>
			</IfThenElse>
					<executeBlock name="Expand_Search_home"/>
					<findElement by="xpath" isSkipCheckDomError="true">//button[text()='Reset']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
					<pause durationInSecs="1"/>
					<executeBlock name="INPUT">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Template Name']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_0"/>
							<parameter name="COL_NAME" value="Template Name"/>
						</parameters>
					</executeBlock>
					<findElement by="xpath" isSkipCheckDomError="true">//button[text()='Search']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
					<pause durationInSecs="1"/>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true"
                                    by="xpath">//table[@summary='Search Results']//*[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_0" columnName="Template Name"/>']</findElement>
						</if>
						<then>
							<findElement by="xpath"
                                    isSkipCheckDomError="true">//table[@summary='Search Results']//*[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_0" columnName="Template Name"/>']/..//a</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
							<pause durationInSecs="1"/>
						</then>
						<else>
							<error message="Please create Project Template before."/>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
		</block>
		<block name="BT_GO_TO_FINANCIAL">
			<findElement by="xpath">//img[@title='Go to Financial Setup Options']</findElement>
			<click waitForPageToFinishRendering="true"/>
		</block>
		<block name="BT_SAVE_CLOSE">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath" isSkipCheckDomError="true">//a[@title='Save']</findElement>
				</if>
				<then>
					<executeBlock name="GLOBAL_SAVE"/>	
					<findElement by="xpath" isSkipCheckDomError="true">//a[@title='Save']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>		
					<findElement by="xpath" isSkipCheckDomError="true">//div[contains(@class,'Popup')]//td///span[text()='S']/..</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>							
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true" isDisplayed="true" by="xpath" isSkipCheckDomError="true">//span[text()='Save']/../../..//a[not(@onclick)]</findElement>
						</if>
						<then>
							<executeBlock name="GLOBAL_SAVE"/>	
							<findElement by="xpath" isSkipCheckDomError="true">//span[text()='Save']/../../..//a[not(@onclick)]</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>			
							<findElement by="xpath" isSkipCheckDomError="true">//div[contains(@class,'Popup')]//td///span[text()='S']/..</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>							
						</then>
						<else>
				
						</else>
					</IfThenElse> 		
				</else>
			</IfThenElse>			
		</block>
		<block name="TAB_FINANCIAL">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Financial'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//div[@class='x1ga']/../..//a[text()='Financial']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>
		<block name="TAB_FORECASTS">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Forecasts'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//div[@class='x1ga']/../..//a[text()='Forecasts']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>
		<block name="TAB_PLAN_SETTING">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Plan Settings'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//a[text()='Plan Settings']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>
		<block name="BT_COLLAPSE_ALL">
			<findElement isSkipCheckDomError="true" by="xpath">//button[text()='Collapse All']</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
		</block>
		<block name="BT_EDIT_FORECASTS">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true"
                        isSkipCheckDomError="true" by="xpath">//*[text()='Manage Forecast Versions']</findElement>
				</if>
				<then>
					<break/>
				</then>
				<else>
					<findElement isSkipCheckDomError="true" by="xpath">//*[text()='Manage Project Forecasts']/../../..//button[text()='Edit']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</else>
			</IfThenElse>
		</block>
		<block name="BT_CREATE_FORECASTS_VERSION">
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true"
                        isDisplayed="true" isSkipCheckDomError="true" by="xpath">//a[text()='Actions']</findElement>
				</if>
				<then>
					<findElement isSkipCheckDomError="true" by="xpath">//a[text()='Actions']/../..//div</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
					<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//td[text()='Create Forecast Version']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true"
                                isDisplayed="true"
                                isSkipCheckDomError="true" by="xpath">//a[text()='Actions']/../../../../../../../../../../../..</findElement>
						</if>
						<then>
							<findElement isSkipCheckDomError="true" by="xpath">//a[text()='Actions']/../../../../../../../../../../../..</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
							<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//a[text()='Actions']</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
							<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//td[text()='Create Forecast Version']</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else>
							<IfThenElse>
								<if>
									<findElement
                                    highlightTurnedOff="true"
                                    isDisplayed="true"
                                    isSkipCheckDomError="true" by="xpath">//span[normalize-space(text())='Create Forecast Version']</findElement>
								</if>
								<then>
									<findElement
                                    isSkipCheckDomError="true" by="xpath">//span[normalize-space(text())='Create Forecast Version']</findElement>
									<click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
								</then>
								<else>
									<IfThenElse>
										<if>
											<findElement
                                    highlightTurnedOff="true"
                                    isDisplayed="true"
                                    isSkipCheckDomError="true" by="xpath">//span[normalize-space(text())='Create Forecast Version']/../../../../../../../../../../../..</findElement>
										</if>
										<then>
											<findElement
                                    isSkipCheckDomError="true" by="xpath">//span[normalize-space(text())='Create Forecast Version']/../../../../../../../../../../../..</findElement>
											<click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
											<findElement
                                    isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//span[normalize-space(text())='Create Forecast Version']</findElement>
											<click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
										</then>
										<else>
											<IfThenElse>
												<if>
													<findElement
                                    highlightTurnedOff="true"
                                    isDisplayed="true"
                                    isSkipCheckDomError="true" by="xpath">//a/img[@title='Create Forecast Version']</findElement>
												</if>
												<then>
													<findElement
                                    isSkipCheckDomError="true" by="xpath">//a/img[@title='Create Forecast Version']</findElement>
													<click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
												</then>
												<else>
													<IfThenElse>
														<if>
															<findElement
                                    highlightTurnedOff="true"
                                    isDisplayed="true"
                                    isSkipCheckDomError="true" by="xpath">//a/img[@title='Create Forecast Version']/../../../../../../../..</findElement>
														</if>
														<then>
															<findElement
                                    isSkipCheckDomError="true" by="xpath">//a/img[@title='Create']/../../../../../../../..</findElement>
															<click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
															<findElement
                                    isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//a/img[@title='Create Forecast Version']</findElement>
															<click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
														</then>
														<else/>
													</IfThenElse>
												</else>
											</IfThenElse>
										</else>
									</IfThenElse>
								</else>
							</IfThenElse>
						</else>
					</IfThenElse>
				</else>
			</IfThenElse>
		</block>
		<block name="FORECASTS">
			<!--Financial Plan Type-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Financial Plan Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
					<parameter name="COL_NAME" value="Financial Plan Type"/>
				</parameters>
			</executeBlock>
			<pause durationInSecs="1"/>
			<IfThenElse>
				<if>
					<findElement by="xpath" isDisplayed="true"
                        highlightTurnedOff="true" isSkipCheckDomError="true">//label[text()='Cost']</findElement>
				</if>
				<then>
					<!--Planning Amounts-->
					<executeBlock name="RADIO_INPUT">
						<parameters>
							<parameter name="LEGEND" value="Planning Amounts"/>
							<parameter name="LABEL_RADIO" value="Planning Amounts"/>
							<parameter name="XPATH" value=""/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
							<parameter name="COL_NAME" value="Planning Amounts"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>

			<!--Forecast Creation Method-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Forecast Creation Method']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
					<parameter name="COL_NAME" value="Forecast Creation Method"/>
				</parameters>
			</executeBlock>
			<pause durationInSecs="1"/>
			<!--Name-->
			<executeBlock name="INPUT">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Name']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
					<parameter name="COL_NAME" value="Name"/>
				</parameters>
			</executeBlock>
			<!--Description-->
			<executeBlock name="INPUT">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Description']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
					<parameter name="COL_NAME" value="Description"/>
				</parameters>
			</executeBlock>
			<!--Source Details-->
			<!--Plan Type-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//label[text()='Plan Type']/../..//select</findElement>
				</if>
				<then>
					<!--Plan Type-->
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Plan Type']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
							<parameter name="COL_NAME" value="Plan Type"/>
						</parameters>
					</executeBlock>	
					<pause durationInSecs="1"/>
					<!--Plan Version-->
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Plan Version']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
							<parameter name="COL_NAME" value="Plan Version"/>
						</parameters>
					</executeBlock>	
					<!--Adjustment Percentage-->
					<executeBlock name="INPUT">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Adjustment Percentage']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
							<parameter name="COL_NAME" value="Adjustment Percentage"/>
						</parameters>
					</executeBlock>	
				</then>
				<else/>
			</IfThenElse>
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true" by="xpath">//label[text()='Source Plan Type']/../..//select</findElement>
				</if>
				<then>
					<!--Source Plan Type-->
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Source Plan Type']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
							<parameter name="COL_NAME" value="Source Plan Type"/>
						</parameters>
					</executeBlock>	
					<pause durationInSecs="1"/>
					<!--Source Plan Version-->
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Source Plan Version']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_1"/>
							<parameter name="COL_NAME" value="Source Plan Version"/>
						</parameters>
					</executeBlock>	

				</then>
				<else/>
			</IfThenElse>	
		</block>
		<block name="CREATE_FORECASTS">
			<executeBlock name="BT_CREATE_FORECASTS_VERSION"/>
			<executeBlock name="FORECASTS"/>
			<executeBlock name="GLOBAL_SAVE"/>
		</block>
		<block name="UPDATE_FORECASTS">
			<findElement highlightTurnedOff="true" by="xpath">SCROLLBAR_GENERIC_1_FIND_ROW/../../../td[1]</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<pause durationInSecs="1"/>
			<IfThenElse>
				<if>
					<findElement highlightTurnedOff="true"
                        isSkipCheckDomError="true" by="xpath">//a[text()='Actions']</findElement>
				</if>
				<then>
					<findElement isSkipCheckDomError="true" by="xpath">//a[text()='Actions']/../..//div</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
					<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//td[text()='Edit Version Planning Options']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true"
                                isSkipCheckDomError="true" by="xpath">//a[text()='Actions']/../../../../../../../../../../../..</findElement>
						</if>
						<then>
							<findElement isSkipCheckDomError="true" by="xpath">//a[text()='Actions']/../../../../../../../../../../../..</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
							<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//a[text()='Actions']</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
							<findElement isSkipCheckDomError="true" by="xpath">//table[@style='position: relative;']//td[text()='Edit Version Planning Options']</findElement>
							<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
						</then>
						<else/>
					</IfThenElse>
				</else>
			</IfThenElse>
			<findElement isSkipCheckDomError="true" by="xpath">//span[text()='B']/..</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement isSkipCheckDomError="true" by="xpath">//span[text()='Y']/..</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<executeBlock name="FORECASTS"/>
			<executeBlock name="GLOBAL_SAVE"/>
		</block>
		<block name="SEARCH_FORECASTS_VERSION">
			<executeBlock name="SPECIFY_QUERY_BY_EXAMPLE">
				<parameters>
					<parameter name="XPATH" value="//*[contains(@summary,'Manage Budget Versions')]/../../../.."/>
				</parameters>
			</executeBlock>

			<findElement by="xpath">(//th//input)[1]</findElement>
			<sendKeys isClear="true" isENTERKey="true" isReplaceAnd="true" waitForPageToFinishRendering="true">
				<valueKB inventoryName="MAIN_REPEAT_1" columnName="Name"/>
			</sendKeys>
			<executeBlock name="SCROLLBAR">
				<parameters>
					<parameter name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[@summary='Manage Budget Versions']/../..//div[contains(text(),'No data to display.')]"/>
					<parameter name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[@summary='Manage Budget Versions'][@_rowcount]//tr[1]//td)[1]"/>
					<parameter name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[@summary='Manage Budget Versions']/../..//div[contains(@id,'scroller')]"/>
					<parameter name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[@summary='Manage Budget Versions']//a[text()='<valueKB
                            inventoryName="MAIN_REPEAT_1" columnName="Name"/>']</parameter>
					<parameter name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="CREATE_FORECASTS"/>
					<parameter name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="UPDATE_FORECASTS"/>
				</parameters>
			</executeBlock>
		</block>
		<!--Plan Settings-->
		<block name="BT_SHOE_MORE">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Show More']</findElement>
				</if>
				<then>
					<findElement by="xpath">//a[text()='Show More']</findElement>
					<click waitForPageToFinishRendering="true"/>
					<pause durationInSecs="1"/>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="TAB_PLAN_SETTINGS">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Plan Settings'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//a[text()='Plan Settings']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>

	
	<block name="PLAN_SETTINGS">
			<!--Cost quantity-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Cost quantity']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Cost quantity"/>
				</parameters>
			</executeBlock>
			<!--Quantity-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Quantity']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Quantity"/>
				</parameters>
			</executeBlock>
			<!--Raw cost-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Raw cost']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Raw cost"/>
				</parameters>
			</executeBlock>
			<!--Raw cost rate-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Raw cost rate']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Raw cost rate"/>
				</parameters>
			</executeBlock>
			<!--Revenue-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Revenue']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Revenue"/>
				</parameters>
			</executeBlock>
			<!--Revenue quantity-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Revenue quantity']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Revenue quantity"/>
				</parameters>
			</executeBlock>
			<!--Burdened cost-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Burdened cost']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Burdened cost"/>
				</parameters>
			</executeBlock>
			<!--Burdened cost rate-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Burdened cost rate']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Burdened cost rate"/>
				</parameters>
			</executeBlock>
			<!--Bill rate-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Bill rate']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Bill rate"/>
				</parameters>
			</executeBlock>
			<!--Planning Level-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Planning Level']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Planning Level"/>
				</parameters>
			</executeBlock>

			<!--Planning Resource Breakdown Structure-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Planning Resource Breakdown Structure']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Planning Resource Breakdown Structure"/>
				</parameters>
			</executeBlock>
			<!--Calendar Type-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Calendar Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
					<parameter name="COL_NAME" value="Calendar Type"/>
				</parameters>
			</executeBlock>
			<!--Bill Rate Derivation Date Type-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Bill Rate Derivation Date Type']</findElement>
				</if>
				<then>
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Bill Rate Derivation Date Type']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
							<parameter name="COL_NAME" value="Bill Rate Derivation Date Type"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Bill Rate Derivation Date-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Bill Rate Derivation Date']</findElement>
				</if>
				<then>
					<executeBlock name="INPUT">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Bill Rate Derivation Date']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
							<parameter name="COL_NAME" value="Bill Rate Derivation Date"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Cost Rate Derivation Date Type-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Cost Rate Derivation Date Type']</findElement>
				</if>
				<then>
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Cost Rate Derivation Date Type']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
							<parameter name="COL_NAME" value="Cost Rate Derivation Date Type"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Cost Rate Derivation Date-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Cost Rate Derivation Date']</findElement>
				</if>
				<then>
					<executeBlock name="INPUT">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Cost Rate Derivation Date']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
							<parameter name="COL_NAME" value="Cost Rate Derivation Date"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Rate Derivation Date Type-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Rate Derivation Date Type']</findElement>
				</if>
				<then>
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Rate Derivation Date Type']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
							<parameter name="COL_NAME" value="Rate Derivation Date Type"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Rate Derivation Date-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Rate Derivation Date']</findElement>
				</if>
				<then>
					<executeBlock name="INPUT">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Rate Derivation Date']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
							<parameter name="COL_NAME" value="Rate Derivation Date"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Period Profile-->		
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Period Profile']</findElement>
				</if>
				<then>
					<!--Period Profile-->
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Period Profile']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
							<parameter name="COL_NAME" value="Period Profile"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Current Planning Period-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Current Planning Period']</findElement>
				</if>
				<then>
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Current Planning Period']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_PLAN"/>
							<parameter name="COL_NAME" value="Current Planning Period"/>
							<parameter name="SEARCH_1" value="Period Name"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<!--Currency Settings-->
		<block name="TAB_CURRENCY_SETTING">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Currency Settings'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//a[text()='Currency Settings']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>
		<block name="BT_OK_PLAN_CURRENCY_SETTINGS">
			<IfThenElse>
				<if>
					<findElement by="xpath">//table[contains(@summary,'Transaction Currencies')]/../../../../../../../..//span[text()='K']</findElement>
				</if>
				<then>
					<findElement by="xpath">//table[contains(@summary,'Transaction Currencies')]/../../../../../../../..//span[text()='K']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<block name="CURRENCY_SETTING">
			 <IfThenElse>
                        <if>
                            <findElement highlightTurnedOff="true" by="xpath">//label[text()='Use same conversion attribute for all currency conversions']/../..//input[@disabled]</findElement>
                        </if>
                        <then>
                            <break/>
                        </then>
                        <else>
                            <!--Use same conversion attribute for all currency conversions-->
                            <executeBlock name="CHECKBOX">
                                <parameters>
                                    <parameter name="XPATH" value="//label[text()='Use same conversion attribute for all currency conversions']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Use same conversion attribute for all currency conversions"/>
                                </parameters>
                            </executeBlock>
                        </else>
                    </IfThenElse>
                    <IfThenElse>
                        <if>
                            <findElement highlightTurnedOff="true" by="xpath">//*[text()='Cost Options']</findElement>
                        </if>
                        <then>
                            <!--Rate Type-->
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type']</findElement>
                                </if>
                                <then>
                                    <!--Rate Type-->
                                    <executeBlock name="LOV">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Rate Type"/>
                                    <parameter name="SEARCH_1" value="Name"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Date Type-->
                                    <executeBlock name="SELECT_KB">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Date Type']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Date Type"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Fixed Date-->
                                    <executeBlock name="INPUT">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Fixed Date']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Fixed Date"/>
                                    </parameters>
                                    </executeBlock>
                                </then>
                                <else/>
                            </IfThenElse>
                            <!--Rate Type for Project Currency-->
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type for Project Currency']</findElement>
                                </if>
                                <then>
                                    <!--Rate Type for Project Currency-->
                                    <executeBlock name="LOV">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type for Project Currency']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Rate Type for Project Currency"/>
                                    <parameter name="SEARCH_1" value="Name"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Date Type for Project Currency-->
                                    <executeBlock name="SELECT_KB">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type for Project Currency']/../../../../../../../../../../..//label[text()='Date Type']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Date Type for Project Currency"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Fixed Date for Project Currency-->
                                    <executeBlock name="INPUT">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type for Project Currency']/../../../../../../../../../../..//label[text()='Fixed Date']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Fixed Date for Project Currency"/>
                                    </parameters>
                                    </executeBlock>
                                </then>
                                <else/>
                            </IfThenElse>
                            <!--Rate Type for Planning Currency-->
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type for Planning Currency']</findElement>
                                </if>
                                <then>
                                    <!--Rate Type for Planning Currency-->
                                    <executeBlock name="LOV">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type for Planning Currency']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Rate Type for Planning Currency"/>
                                    <parameter name="SEARCH_1" value="Name"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Cost - Date Type for Planning Currency-->
                                    <executeBlock name="SELECT_KB">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type for Planning Currency']/../../../../../../../../../../..//label[text()='Date Type']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Date Type for Planning Currency"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Cost - Fixed Date for Planning Currency-->
                                    <executeBlock name="INPUT">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Rate Type for Planning Currency']/../../../../../../../../../../..//label[text()='Fixed Date']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Fixed Date for Planning Currency"/>
                                    </parameters>
                                    </executeBlock>
                                </then>
                                <else/>
                            </IfThenElse>
                        </then>
                        <else/>
                    </IfThenElse>
                    <IfThenElse>
                        <if>
                            <findElement highlightTurnedOff="true" by="xpath">//*[text()='Revenue Options']</findElement>
                        </if>
                        <then>
                            <!--Revenue - Rate Type-->
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type']</findElement>
                                </if>
                                <then>
                                    <!--Revenue - Rate Type-->
                                    <executeBlock name="LOV">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Rate Type"/>
                                    <parameter name="SEARCH_1" value="Name"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Revenue - Date Type-->
                                    <executeBlock name="SELECT_KB">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type']/../../../../../../../../../../..//label[text()='Date Type']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Date Type"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Revenue - Fixed Date-->
                                    <executeBlock name="INPUT">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type']/../../../../../../../../../../..//label[text()='Fixed Date']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Fixed Date"/>
                                    </parameters>
                                    </executeBlock>
                                </then>
                                <else/>
                            </IfThenElse>
                            <!--Rate Type for Project Currency-->
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type for Project Currency']</findElement>
                                </if>
                                <then>
                                    <!--Revenue - Rate Type for Project Currency-->
                                    <executeBlock name="LOV">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type for Project Currency']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Rate Type for Project Currency"/>
                                    <parameter name="SEARCH_1" value="Name"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Revenue - Date Type for Project Currency-->
                                    <executeBlock name="SELECT_KB">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type for Project Currency']/../../../../../../../../../../..//label[text()='Date Type']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Date Type for Project Currency"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Revenue - Fixed Date for Project Currency-->
                                    <executeBlock name="INPUT">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type for Project Currency']/../../../../../../../../../../..//label[text()='Fixed Date']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Fixed Date for Project Currency"/>
                                    </parameters>
                                    </executeBlock>
                                </then>
                                <else/>
                            </IfThenElse>
                            <!--Rate Type for Planning Currency-->
                            <IfThenElse>
                                <if>
                                    <findElement
                                    highlightTurnedOff="true" by="xpath">//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type for Planning Currency']</findElement>
                                </if>
                                <then>
                                    <!--Revenue - Rate Type for Planning Currency-->
                                    <executeBlock name="LOV">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type for Planning Currency']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Rate Type for Planning Currency"/>
                                    <parameter name="SEARCH_1" value="Name"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Revenue - Date Type for Planning Currency-->
                                    <executeBlock name="SELECT_KB">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type for Planning Currency']/../../../../../../../../../../..//label[text()='Date Type']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Date Type for Planning Currency"/>
                                    </parameters>
                                    </executeBlock>
                                    <!--Revenue - Fixed Date for Planning Currency-->
                                    <executeBlock name="INPUT">
                                    <parameters>
                                    <parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Rate Type for Planning Currency']/../../../../../../../../../../..//label[text()='Fixed Date']/../.."/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_2"/>
                                    <parameter name="COL_NAME" value="Revenue - Fixed Date for Planning Currency"/>
                                    </parameters>
                                    </executeBlock>
                                </then>
                                <else/>
                            </IfThenElse>
                        </then>
                        <else/>
                    </IfThenElse>
		</block>
		<!--Rate Settings-->
		<block name="TAB_RATE_SETTING">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Rate Settings'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//a[text()='Rate Settings']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>
		
		<block name="RATE_SETTING">
			<!--Use planning rates-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Use planning rates']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
					<parameter name="COL_NAME" value="Use planning rates"/>
				</parameters>
			</executeBlock>
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true"
                                by="xpath" isSkipCheckDomError="true">//label[text()='Resource Class Raw Cost Rate']</findElement>
				</if>
				<then>
					<!--Rate Schedule Name-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Resource Class Raw Cost Rate']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Resource Class Raw Cost Rate"/>
							<parameter name="SEARCH_1" value="Rate Schedule Name"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" highlightTurnedOff="true"
                                by="xpath" isSkipCheckDomError="true">//label[text()='Resource Class Bill Rate']</findElement>
				</if>
				<then>
					<!--Resource Class Bill Rate-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Resource Class Bill Rate']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Resource Class Bill Rate"/>
							<parameter name="SEARCH_1" value="Rate Schedule Name"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" isSkipCheckDomError="true"
                                highlightTurnedOff="true" by="xpath">//*[text()='Cost Options']/../../../../../../..</findElement>
				</if>
				<then>
					<!--Burden Schedule-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Burden Schedule']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Burden Schedule"/>
							<parameter name="SEARCH_1" value="Burden Schedule"/>
						</parameters>
					</executeBlock>
					<!--Person-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Person']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Person"/>
							<parameter name="SEARCH_1" value="Name"/>
						</parameters>
					</executeBlock>
					<!--Nonlabor Resource-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Nonlabor Resource']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Nonlabor Resource"/>
							<parameter name="SEARCH_1" value="Name"/>
						</parameters>
					</executeBlock>
					<!--Job-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Job']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Job"/>
							<parameter name="SEARCH_1" value="Name"/>
						</parameters>
					</executeBlock>
					<!--Resource Class-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Cost Options']/../../../../../../..//label[text()='Resource Class']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Resource Class"/>
							<parameter name="SEARCH_1" value="Name"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" isSkipCheckDomError="true"
                                highlightTurnedOff="true" by="xpath">//*[text()='Revenue Options']/../../../../../../..</findElement>
				</if>
				<then>
					<!--Revenue - Person-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Person']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Revenue - Person"/>
							<parameter name="SEARCH_1" value="Name"/>
						</parameters>
					</executeBlock>
					<!--Revenue - Nonlabor Resource-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Nonlabor Resource']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Revenue - Nonlabor Resource"/>
							<parameter name="SEARCH_1" value="Name"/>
						</parameters>
					</executeBlock>
					<!--Revenue - Job-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Job']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Revenue - Job"/>
							<parameter name="SEARCH_1" value="Name"/>
						</parameters>
					</executeBlock>
					<!--Revenue - Resource Class-->
					<executeBlock name="LOV">
						<parameters>
							<parameter name="XPATH" value="//*[text()='Revenue Options']/../../../../../../..//label[text()='Resource Class']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_4"/>
							<parameter name="COL_NAME" value="Revenue - Resource Class"/>
							<parameter name="SEARCH_1" value="Name"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<!--Planning Currencies-->
		<block name="GLOBAL_SearchCurrency...">
			<IfThenElse>
				<if>
					<findElement isSkipCheckDomError="true" by="xpath">//table/tbody/tr/td/div/a[text()='Search...']</findElement>
				</if>
				<then>
					<pause durationInSecs="2"/>
					<break/>
				</then>
				<else>
					<pause durationInSecs="2"/>
					<findElement by="xpath" isSkipCheckDomError="true">//tr[contains(@class,'Selected')]/../..//span/a[@title='Search']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
					<pause durationInSecs="1"/>
				</else>
			</IfThenElse>
		</block>
		
		<block name="LOV_Currency">
			<IfThenElse>
				<if>
					<comparisons separator="AND">
						<comparison operator="NOT_EQUAL">
							<leftOperand>
								<valueKB inventoryName="MAIN_REPEAT_3" columnName="Currency"/>
							</leftOperand>
							<rightOperand>
								<valueText/>
							</rightOperand>
						</comparison>
						<comparison operator="NOT_EQUAL">
							<leftOperand>
								<valueKB inventoryName="MAIN_REPEAT_3" columnName="Currency"/>
							</leftOperand>
							<rightOperand>
								<valueText>""</valueText>
							</rightOperand>
						</comparison>
					</comparisons>
				</if>
				<then>
					<IfThenElse>
						<if>
							<findElement highlightTurnedOff="true"
                                    by="xpath">//tr[contains(@class,'Selected')]/../..//input[@value='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</findElement>
						</if>
						<then/>
						<else>
							<IfThenElse>
								<if>
									<findElement isSkipCheckDomError="true" by="xpath">//tr[contains(@class,'Selected')]/../..//input[not(@disabled)]</findElement>
								</if>
								<then>
									<executeBlock name="GLOBAL_SearchCurrency..." isRepeatUntilBreak="true"/>
									<IfThenElse>
										<if>
											<findElement isSkipCheckDomError="true"
                                    by="xpath">//table/tbody/tr/td/div/a[text()='Search...']/..//a[text()='Search...']/..//tr//td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</findElement>
										</if>
										<then>
											<findElement isSkipCheckDomError="true" by="xpath">//table/tbody/tr/td/div/a[text()='Search...']/..//a[text()='Search...']/..//tr//td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</findElement>
											<click
                                    waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
										</then>
										<else>
											<findElement isSkipCheckDomError="true" by="xpath">//table/tbody/tr/td/div/a[text()='Search...']/..//a[text()='Search...']</findElement>
											<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
											<IfThenElse>
												<if>
													<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//*[text()='Search']/../..//div/../..//a[contains(@title,'Expand')]</findElement>
												</if>
												<then>
													<findElement by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//*[text()='Search']/../..//div/../..//a[contains(@title,'Expand')]</findElement>
													<click waitForPageToFinishRendering="true"/>
												</then>
												<else/>
											</IfThenElse>
											<findElement by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Currency']/../..//input</findElement>
											<sendKeys isClear="true" isENTERKey="true" waitForPageToFinishRendering="true">
												<valueKB inventoryName="MAIN_REPEAT_3" columnName="Currency"/>
											</sendKeys>
											<IfThenElse>
												<if>
													<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//*[text()='Search']/../..//div/../..//a[contains(@title,'Expand')]</findElement>
												</if>
												<then>
													<findElement by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//*[text()='Search']/../..//div/../..//a[contains(@title,'Expand')]</findElement>
													<click waitForPageToFinishRendering="true"/>
												</then>
												<else/>
											</IfThenElse>
											<IfThenElse>
												<if>
													<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Currency']/../..//input[not(@title)]</findElement>
												</if>
												<then>
													<findElement by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//label[text()='Currency']/../..//input</findElement>
													<sendKeys isClear="true" isENTERKey="true" waitForPageToFinishRendering="true">
														<valueKB inventoryName="MAIN_REPEAT_3" columnName="Currency"/>
													</sendKeys>
												</then>
												<else/>
											</IfThenElse>
											<IfThenElse>
												<if>
													<findElement highlightTurnedOff="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//*[text()='Search']/../..//div/../..//a[contains(@title,'Expand')]</findElement>
												</if>
												<then>
													<findElement by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//*[text()='Search']/../..//div/../..//a[contains(@title,'Expand')]</findElement>
													<click waitForPageToFinishRendering="true"/>
												</then>
												<else/>
											</IfThenElse>
											<findElement isSkipCheckDomError="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//button[text()='Search']</findElement>
											<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
											<IfThenElse>
												<if>
													<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//table[@_rowcount]/tbody//td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</findElement>
												</if>
												<then>
													<findElement highlightTurnedOff="true" isSkipCheckDomError="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//table[@_rowcount]/tbody//td[1][text()='<valueKB
                                    inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</findElement>
													<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
												</then>
												<else>
													<error message="No results found."/>
												</else>
											</IfThenElse>
											<findElement isSkipCheckDomError="true" by="xpath">//div[contains(text(),'Search and Select')]/../../../../../../..//button[text()='OK']</findElement>
											<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
										</else>
									</IfThenElse>
								</then>
								<else/>
							</IfThenElse>
						</else>
					</IfThenElse>
				</then>
				<else/>
			</IfThenElse>
		</block>
		
		<block name="Frist_Row_currency">			
			<IfThenElse>
				<if>
					<findElement isDisplayed="true" setFocus="true" highlightTurnedOff="true" by="xpath">SCROLLBAR_GENERIC_1_FIRST_ROW</findElement>
				</if>
				<then>
					<break/>
				</then>
				<else>
					<findElement highlightTurnedOff="true" setFocus="true" isSkipCheckDomError="true" by="xpath">SCROLLBAR_GENERIC_1_SCROLLER</findElement>
					<scroll direction="TOP"/>
				</else>
			</IfThenElse>
		</block>
		<block name="CREATE_PLAN_CURRENCY_SETTINGS">
			<IfThenElse>
				<if>
					<findElement isSkipCheckDomError="true" setFocus="true" by="xpath">//table[contains(@summary,'Transaction Currencies')]/../../..//input[@value='']</findElement>
				</if>
				<then>
					<findElement isSkipCheckDomError="true" setFocus="true" by="xpath">//table[contains(@summary,'Transaction Currencies')]/../../..//input[@value='']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</then>
				<else>
					<findElement isSkipCheckDomError="true" setFocus="true" by="xpath">//tr[contains(@class,'Selected')]//img[@title='Add']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
					<executeBlock name="Frist_Row_currency" isRepeatUntilBreak="true" />
					<findElement isSkipCheckDomError="true" setFocus="true" by="xpath">//table[contains(@summary,'Transaction Currencies')]/../../..//input[@value='']</findElement>
					<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
				</else>
			</IfThenElse>
			<executeBlock name="LOV_Currency"/>
		</block>
		<block name="UPDATE_PLAN_CURRENCY_SETTINGS"/>	
		
		<block name="PLAN_CURRENCY_SETTING">
								<IfThenElse>
										<if>
											<comparisons separator="AND">
												<comparison operator="EQUAL">
													<leftOperand>
														<valueKB inventoryName="MAIN_REPEAT_1" columnName="Forecast Creation Method"/>
													</leftOperand>
													<rightOperand>
														<valueText>Copy from another source</valueText>
													</rightOperand>
												</comparison>
											</comparisons>
										</if>
										<then/>
										<else>
											<IfThenElse>
													<if>
														<findElement by="xpath">//div[contains(@class,'Expansion')]/..//*[text()='Transaction Currencies']</findElement>
													</if>
													<then>
														<executeBlock name="SCROLLBAR">
															<parameters>
																<parameter
																	name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[contains(@summary,'Transaction Currencies')]/../..//div[contains(text(),'No data to display.')]"/>
																<parameter
																	name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[contains(@summary,'Transaction Currencies')][@_startrow='0']//tr[1]//td)[1]"/>
																<parameter
																	name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[contains(@summary,'Transaction Currencies')]/../..//div[contains(@id,'scroller')]"/>
																<parameter
																		name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[contains(@summary,'Transaction Currencies')]/../../..//input[@value='<valueKB
																		inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</parameter>
																<parameter
																		name="SCROLLBAR_GENERIC_2_FIND_ROW">//table[contains(@summary,'Transaction Currencies')]/../../..//span[text()='<valueKB
																		inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</parameter>		
																<parameter
																	name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="CREATE_PLAN_CURRENCY_SETTINGS"/>
																<parameter
																	name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="UPDATE_PLAN_CURRENCY_SETTINGS"/>
															</parameters>
														</executeBlock>
													</then>
													<else>
														<IfThenElse>
															<if>
																<findElement highlightTurnedOff="true" by="xpath">//img[@title='Edit']</findElement>
															</if>
															<then>
																<executeBlock name="TAB_CURRENCY_SETTING"/>
																<findElement highlightTurnedOff="true" by="xpath">//img[@title='Edit']</findElement>
																<click waitForPageToFinishRendering="true"/>
																<executeBlock name="SCROLLBAR">
																	<parameters>
																		<parameter
																		name="SCROLLBAR_GENERIC_1_NO_DATA" value="//table[contains(@summary,'Transaction Currencies')]/../..//div[contains(text(),'No data to display.')]"/>
																		<parameter
																		name="SCROLLBAR_GENERIC_1_FIRST_ROW" value="(//table[contains(@summary,'Transaction Currencies')][@_startrow='0']//tr[1]//td)[1]"/>
																		<parameter
																		name="SCROLLBAR_GENERIC_1_SCROLLER" value="//table[contains(@summary,'Transaction Currencies')]/../..//div[contains(@id,'scroller')]"/>
																		<parameter
																		name="SCROLLBAR_GENERIC_1_FIND_ROW">//table[contains(@summary,'Transaction Currencies')]/../../..//input[@value='<valueKB
																		inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</parameter>
																		<parameter
																		name="SCROLLBAR_GENERIC_2_FIND_ROW">//table[contains(@summary,'Transaction Currencies')]/../../..//span[text()='<valueKB
																		inventoryName="MAIN_REPEAT_3" columnName="Currency"/>']</parameter>
																		<parameter
																		name="SCROLLBAR_GENERIC_1_CREATE_BLOCK" value="CREATE_PLAN_CURRENCY_SETTINGS"/>
																		<parameter
																		name="SCROLLBAR_GENERIC_1_UPDATE_BLOCK" value="UPDATE_PLAN_CURRENCY_SETTINGS"/>
																	</parameters>
																</executeBlock>
															</then>
															<else/>
														</IfThenElse>
													</else>
												</IfThenElse>
										</else>
									</IfThenElse>
			
		</block>
		<!--Generation Options-->
		<block name="TAB_GENERATION_OPTION">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Generation Options'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//a[text()='Generation Options']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>

		<block name="GENERATION_OPTION">
			<!--Forecast ETC Method-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Forecast ETC Method']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="Forecast ETC Method"/>
				</parameters>
			</executeBlock>
			<!--Carry forward unused amounts from past periods-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Carry forward unused amounts from past periods']</findElement>
				</if>
				<then>
					<executeBlock name="CHECKBOX">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Carry forward unused amounts from past periods']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
							<parameter name="COL_NAME" value="Carry forward unused amounts from past periods"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>


			<!--Actual Amounts Through Period-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Actual Amounts Through Period']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="Actual Amounts Through Period"/>
				</parameters>
			</executeBlock>
			<!--ETC Generation Source-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='ETC Generation Source']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
					<parameter name="COL_NAME" value="ETC Generation Source"/>
				</parameters>
			</executeBlock>

			<!--Source Plan Type-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Source Plan Type']</findElement>
				</if>
				<then>
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Source Plan Type']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
							<parameter name="COL_NAME" value="Source Plan Type"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>

			<!--Source Plan Version-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Source Plan Version']</findElement>
				</if>
				<then>
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Source Plan Version']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
							<parameter name="COL_NAME" value="Source Plan Version"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>

			<!--Revenue Generation Method-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Revenue Generation Method']</findElement>
				</if>
				<then>
					<executeBlock name="SELECT_KB">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Revenue Generation Method']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
							<parameter name="COL_NAME" value="Revenue Generation Method"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>

			<!--Allow negative ETC calculation-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Allow negative ETC calculation']</findElement>
				</if>
				<then>
					<executeBlock name="CHECKBOX">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Allow negative ETC calculation']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
							<parameter name="COL_NAME" value="Allow negative ETC calculation"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>

			<!--Open Commitments-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Allow negative ETC calculation']</findElement>
				</if>
				<then>
					<executeBlock name="CHECKBOX">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Allow negative ETC calculation']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
							<parameter name="COL_NAME" value="Allow negative ETC calculation"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Retain Manually Added Forecast Lines-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Retain Manually Added Forecast Lines']</findElement>
				</if>
				<then>
					<executeBlock name="CHECKBOX">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Retain Manually Added Forecast Lines']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
							<parameter name="COL_NAME" value="Retain Manually Added Forecast Lines"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<!--Retain override rates from source-->
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath">//label[text()='Retain override rates from source']</findElement>
				</if>
				<then>
					<executeBlock name="CHECKBOX">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Retain override rates from source']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_5"/>
							<parameter name="COL_NAME" value="Retain override rates from source"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
		</block>
		<!--Reporting Options-->
		<block name="TAB_REPORTING_OPTION">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Reporting Options'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//a[text()='Reporting Options']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>
	
	<block name="REPORTING_OPTION">
				<!--Report Quantity Using-->
				<IfThenElse>
                        <if>
                            <findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath" isSkipCheckDomError="true">//*[text()='Report Quantity Using']/../..//input[@type='radio']</findElement>
                        </if>
                        <then>
                            <!--Report Quantity Using-->
                            <executeBlock name="RADIO_INPUT">
                                <parameters>
                                    <parameter name="LEGEND" value="Report Quantity Using"/>
                                    <parameter name="LABEL_RADIO" value=""/>
                                    <parameter name="XPATH" value=""/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_6"/>
                                    <parameter name="COL_NAME" value="Report Quantity Using"/>
                                </parameters>
                            </executeBlock>
                        </then>
                        <else/>
                    </IfThenElse>
					<!--Report Cost-->
                    <IfThenElse>
                        <if>
                            <findElement isDisplayed="true"
                                highlightTurnedOff="true" by="xpath" isSkipCheckDomError="true">//*[text()='Report Cost']/../..//input[@type='radio']</findElement>
                        </if>
                        <then>
                            <!--Report Cost-->
                            <executeBlock name="RADIO_INPUT">
                                <parameters>
                                    <parameter name="LEGEND" value="Report Cost"/>
                                    <parameter name="LABEL_RADIO" value=""/>
                                    <parameter name="XPATH" value=""/>
                                    <parameter name="INV_NAME" value="MAIN_REPEAT_6"/>
                                    <parameter name="COL_NAME" value="Report Cost"/>
                                </parameters>
                            </executeBlock>
                        </then>
                        <else/>
                    </IfThenElse>
			
			<!--Amount Scale-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Amount Scale']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_6"/>
					<parameter name="COL_NAME" value="Amount Scale"/>
				</parameters>
			</executeBlock>
			<!--Currency Type-->
			<executeBlock name="SELECT_KB">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Currency Type']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_6"/>
					<parameter name="COL_NAME" value="Currency Type"/>
				</parameters>
			</executeBlock>
		</block>
		<!--Export Options-->
		
		<block name="TAB_EXPORT_OPTION">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Export Options'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//a[text()='Export Options']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>
	
	<block name="EXPORT_OPTION">
			<!--Display currency conversion attributes and amounts in multiple transaction currencies-->
			<executeBlock name="CHECKBOX">
				<parameters>
					<parameter name="XPATH" value="//label[text()='Display currency conversion attributes and amounts in multiple transaction currencies']/../.."/>
					<parameter name="INV_NAME" value="MAIN_REPEAT_7"/>
					<parameter name="COL_NAME" value="Display currency conversion attributes and amounts in multiple transaction currencies"/>
				</parameters>
			</executeBlock>
			<IfThenElse>
				<if>
					<findElement isDisplayed="true"
                        highlightTurnedOff="true" by="xpath">//label[text()='Display commitments']</findElement>
				</if>
				<then>
					<!--Display commitments-->
					<executeBlock name="CHECKBOX">
						<parameters>
							<parameter name="XPATH" value="//label[text()='Display commitments']/../.."/>
							<parameter name="INV_NAME" value="MAIN_REPEAT_7"/>
							<parameter name="COL_NAME" value="Display commitments"/>
						</parameters>
					</executeBlock>
				</then>
				<else/>
			</IfThenElse>
			<pause durationInSecs="2"/>
			<IfThenElse>
				<if>
					<findElement setFocus="true"
                            by="xpath">//*[text()='Selected Measures']/../../../../..//li/label[text()='<valueKB
                            inventoryName="MAIN_REPEAT_7" columnName="Selected Measures"/>']</findElement>
				</if>
				<then/>
				<else>
					<IfThenElse>
						<if>
							<findElement setFocus="true"
                                    by="xpath">//*[text()='Available Measures']/../../../../..//li/label[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_7" columnName="Selected Measures"/>']</findElement>
						</if>
						<then>
							<IfThenElse>
								<if>
									<findElement setFocus="true"
                                    by="xpath">//*[text()='Available Measures']/../../../../..//li[contains(@class,'Disabled')]/label[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_7" columnName="Selected Measures"/>']</findElement>
								</if>
								<then>
									<error message="Cannot Move to Selected Entities"/>
								</then>
								<else>
									<findElement setFocus="true"
                                    by="xpath">//*[text()='Available Measures']/../../../../..//li/label[text()='<valueKB
                                    inventoryName="MAIN_REPEAT_7" columnName="Selected Measures"/>']</findElement>
									<click waitForPageToFinishRendering="true"/>
									<findElement isDisplayed="true" by="xpath">//a[@title='Move selected items to: Selected Measures']</findElement>
									<click waitForPageToFinishRendering="true"/>
								</else>
							</IfThenElse>
						</then>
						<else/>
					</IfThenElse>
				</else>
			</IfThenElse>
		</block>
		<!--DFF-->
		<block name="TAB_DFF">
			<IfThenElse>
				<if>
					<findElement by="xpath">//a[text()='Additional Information'][contains(@class,'Selected')]</findElement>
				</if>
				<then/>
				<else>
					<findElement by="xpath">//a[text()='Additional Information']</findElement>
					<click waitForPageToFinishRendering="true"/>
				</else>
			</IfThenElse>
		</block>
		<block name="BT_SAVE_AND_CONTINUE">
			<findElement by="xpath" isSkipCheckDomError="true">//span[text()='Save']/../../..//div</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement by="xpath" isSkipCheckDomError="true">//div[contains(@class,'Popup')]//span[text()='S']/..</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement by="xpath" isSkipCheckDomError="true">//a//span[text()='o']/../..</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
			<findElement by="xpath" isSkipCheckDomError="true">//a//span[text()='o']/../..</findElement>
			<click waitForPageToFinishRendering="true" isSkipCheckDomError="true"/>
		</block>
		<executeBlock name="GLOBAL_GO_TO_TASK"/>
		<repeat inventoryName="MAIN_REPEAT_0">
			<repeat inventoryName="MAIN_REPEAT_1">
			<executeBlock name="Project_Templates"/>
			<executeBlock name="BT_GO_TO_FINANCIAL"/>
			<executeBlock name="TAB_FINANCIAL"/>
			<executeBlock name="TAB_FORECASTS"/>
			<executeBlock name="BT_EDIT_FORECASTS" isRepeatUntilBreak="true"/>
			<executeBlock name="SEARCH_FORECASTS_VERSION"/>
			<repeat inventoryName="MAIN_REPEAT_PLAN">
				<executeBlock name="BT_SHOE_MORE"/>
				<executeBlock name="TAB_PLAN_SETTINGS"/>
				<executeBlock name="PLAN_SETTINGS"/>
				<executeBlock name="GLOBAL_SAVE"/>
			</repeat>
			<repeat inventoryName="MAIN_REPEAT_2">
				<executeBlock name="TAB_CURRENCY_SETTING"/>
				<executeBlock name="CURRENCY_SETTING"/>
				<executeBlock name="GLOBAL_SAVE"/>
			</repeat>
			<repeat inventoryName="MAIN_REPEAT_3">
				<executeBlock name="PLAN_CURRENCY_SETTING"/>
			</repeat>
			<executeBlock name="BT_OK_PLAN_CURRENCY_SETTINGS"/>
			<repeat inventoryName="MAIN_REPEAT_4">
				<executeBlock name="TAB_RATE_SETTING"/>
				<executeBlock name="RATE_SETTING"/>
				<executeBlock name="GLOBAL_SAVE"/>
			</repeat>
			<repeat inventoryName="MAIN_REPEAT_5">
				<executeBlock name="TAB_GENERATION_OPTION"/>
				<executeBlock name="GENERATION_OPTION"/>
				<executeBlock name="GLOBAL_SAVE"/>
			</repeat>
			<repeat inventoryName="MAIN_REPEAT_6">
				<executeBlock name="TAB_REPORTING_OPTION"/>
				<executeBlock name="REPORTING_OPTION"/>
				<executeBlock name="GLOBAL_SAVE"/>
			</repeat>
			<repeat inventoryName="MAIN_REPEAT_7">
				<executeBlock name="TAB_EXPORT_OPTION"/>
				<executeBlock name="EXPORT_OPTION"/>
				<executeBlock name="GLOBAL_SAVE"/>
			</repeat>
			<repeat inventoryName="MAIN_REPEAT_8">
				<executeBlock name="TAB_DFF"/>
				<executeBlock name="GLOBAL_ALL_DFF">
					<parameters>
						<parameter name="INV_NAME" value="Manage Project Templates - Forecasts - DFF"/>
					</parameters>
				</executeBlock>
				<executeBlock name="GLOBAL_SAVE"/>
			</repeat>
			<executeBlock name="BT_SAVE_AND_CONTINUE"/>
		</repeat>
		</repeat>
	</fusionNavigation>
</navigation>
